<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 2 Structural equation models | Structural Equation Models</title>
  <meta name="description" content="Chapter 2 Structural equation models | Structural Equation Models" />
  <meta name="generator" content="bookdown 0.43 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 2 Structural equation models | Structural Equation Models" />
  <meta property="og:type" content="book" />
  
  
  <meta name="github-repo" content="sarasouther/DataAnalysis" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 2 Structural equation models | Structural Equation Models" />
  
  
  

<meta name="author" content="Dr.Â Sara Souther" />


<meta name="date" content="2025-05-31" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="libs/viz-1.8.2/viz.js"></script>
<link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="libs/grViz-binding-1.0.11/grViz.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Statistics for Ecology</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#student-learning-objectives"><i class="fa fa-check"></i><b>1.1</b> Student Learning Objectives</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#downloads"><i class="fa fa-check"></i><b>1.2</b> Downloads</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#description"><i class="fa fa-check"></i><b>1.3</b> Description</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#grading"><i class="fa fa-check"></i><b>1.4</b> Grading</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#overview"><i class="fa fa-check"></i><b>1.5</b> Overview</a></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#r"><i class="fa fa-check"></i><b>1.6</b> R</a></li>
<li class="chapter" data-level="1.7" data-path="index.html"><a href="index.html#what-can-statistics-tell-us"><i class="fa fa-check"></i><b>1.7</b> What can statistics tell us?</a></li>
<li class="chapter" data-level="1.8" data-path="index.html"><a href="index.html#sampling-populations"><i class="fa fa-check"></i><b>1.8</b> Sampling populations</a></li>
<li class="chapter" data-level="1.9" data-path="index.html"><a href="index.html#data-types"><i class="fa fa-check"></i><b>1.9</b> Data types</a></li>
<li class="chapter" data-level="1.10" data-path="index.html"><a href="index.html#describing-data"><i class="fa fa-check"></i><b>1.10</b> Describing data</a></li>
<li class="chapter" data-level="1.11" data-path="index.html"><a href="index.html#prework"><i class="fa fa-check"></i><b>1.11</b> Prework</a></li>
<li class="chapter" data-level="1.12" data-path="index.html"><a href="index.html#randomness"><i class="fa fa-check"></i><b>1.12</b> Randomness</a></li>
<li class="chapter" data-level="1.13" data-path="index.html"><a href="index.html#the-sample-point-method"><i class="fa fa-check"></i><b>1.13</b> The sample point method</a></li>
<li class="chapter" data-level="1.14" data-path="index.html"><a href="index.html#combinatorials"><i class="fa fa-check"></i><b>1.14</b> Combinatorials</a></li>
<li class="chapter" data-level="1.15" data-path="index.html"><a href="index.html#union-and-intersection-of-events"><i class="fa fa-check"></i><b>1.15</b> Union and intersection of events</a></li>
<li class="chapter" data-level="1.16" data-path="index.html"><a href="index.html#conditional-probability"><i class="fa fa-check"></i><b>1.16</b> Conditional probability</a></li>
<li class="chapter" data-level="1.17" data-path="index.html"><a href="index.html#multiplicative-law-of-probability-of-independent-events"><i class="fa fa-check"></i><b>1.17</b> Multiplicative Law of Probability of Independent Events</a></li>
<li class="chapter" data-level="1.18" data-path="index.html"><a href="index.html#additive-law-of-probability-of-mutually-exclusive-events"><i class="fa fa-check"></i><b>1.18</b> Additive Law of Probability of Mutually Exclusive Events</a></li>
<li class="chapter" data-level="1.19" data-path="index.html"><a href="index.html#general-additive-law-of-probability"><i class="fa fa-check"></i><b>1.19</b> General Additive Law of Probability</a></li>
<li class="chapter" data-level="1.20" data-path="index.html"><a href="index.html#key-concepts"><i class="fa fa-check"></i><b>1.20</b> Key concepts</a></li>
<li class="chapter" data-level="1.21" data-path="index.html"><a href="index.html#practice-problems"><i class="fa fa-check"></i><b>1.21</b> Practice problems</a></li>
<li class="chapter" data-level="1.22" data-path="index.html"><a href="index.html#basic-hypothesis-testing-review"><i class="fa fa-check"></i><b>1.22</b> Basic hypothesis testing review</a></li>
<li class="chapter" data-level="1.23" data-path="index.html"><a href="index.html#tailed-tests"><i class="fa fa-check"></i><b>1.23</b> Tailed tests</a></li>
<li class="chapter" data-level="1.24" data-path="index.html"><a href="index.html#drawing-conclusions-from-statistics"><i class="fa fa-check"></i><b>1.24</b> Drawing conclusions from statistics</a></li>
<li class="chapter" data-level="1.25" data-path="index.html"><a href="index.html#reporting-results"><i class="fa fa-check"></i><b>1.25</b> Reporting results</a></li>
<li class="chapter" data-level="1.26" data-path="index.html"><a href="index.html#review-problems"><i class="fa fa-check"></i><b>1.26</b> Review problems</a></li>
<li class="chapter" data-level="1.27" data-path="index.html"><a href="index.html#a-foray-into-statistics"><i class="fa fa-check"></i><b>1.27</b> A foray into statistics</a></li>
<li class="chapter" data-level="1.28" data-path="index.html"><a href="index.html#selecting-statistical-analyses"><i class="fa fa-check"></i><b>1.28</b> Selecting statistical analyses</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="structural-equation-models.html"><a href="structural-equation-models.html"><i class="fa fa-check"></i><b>2</b> Structural equation models</a>
<ul>
<li class="chapter" data-level="2.1" data-path="structural-equation-models.html"><a href="structural-equation-models.html#what-are-structural-equation-models"><i class="fa fa-check"></i><b>2.1</b> What are structural equation models?</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="structural-equation-models.html"><a href="structural-equation-models.html#when-should-you-use-sem"><i class="fa fa-check"></i><b>2.1.1</b> When Should You Use SEM?</a></li>
<li class="chapter" data-level="2.1.2" data-path="structural-equation-models.html"><a href="structural-equation-models.html#how-is-sem-different-from-multiple-regression"><i class="fa fa-check"></i><b>2.1.2</b> How is SEM Different from Multiple Regression?</a></li>
<li class="chapter" data-level="2.1.3" data-path="structural-equation-models.html"><a href="structural-equation-models.html#summary"><i class="fa fa-check"></i><b>2.1.3</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="structural-equation-models.html"><a href="structural-equation-models.html#anatomy-of-a-structural-equation-model"><i class="fa fa-check"></i><b>2.2</b> Anatomy of a Structural Equation Model</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="structural-equation-models.html"><a href="structural-equation-models.html#types-of-variables"><i class="fa fa-check"></i><b>2.2.1</b> Types of Variables</a></li>
<li class="chapter" data-level="2.2.2" data-path="structural-equation-models.html"><a href="structural-equation-models.html#path-diagrams"><i class="fa fa-check"></i><b>2.2.2</b> Path Diagrams</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="structural-equation-models.html"><a href="structural-equation-models.html#building-multivariate-models"><i class="fa fa-check"></i><b>2.3</b> Building Multivariate Models</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="structural-equation-models.html"><a href="structural-equation-models.html#what-is-causality"><i class="fa fa-check"></i><b>2.3.1</b> What is Causality?</a></li>
<li class="chapter" data-level="2.3.2" data-path="structural-equation-models.html"><a href="structural-equation-models.html#why-move-beyond-multiple-regression"><i class="fa fa-check"></i><b>2.3.2</b> Why move beyond Multiple Regression?</a></li>
<li class="chapter" data-level="2.3.3" data-path="structural-equation-models.html"><a href="structural-equation-models.html#meta-modeling-your-system"><i class="fa fa-check"></i><b>2.3.3</b> Meta-Modeling Your System</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="structural-equation-models.html"><a href="structural-equation-models.html#from-concept-to-model"><i class="fa fa-check"></i><b>2.4</b> From Concept to Model</a></li>
<li class="chapter" data-level="2.5" data-path="structural-equation-models.html"><a href="structural-equation-models.html#common-structures-in-causal-diagrams"><i class="fa fa-check"></i><b>2.5</b> Common Structures in Causal Diagrams</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="structural-equation-models.html"><a href="structural-equation-models.html#chains-mediation-paths"><i class="fa fa-check"></i><b>2.5.1</b> Chains (Mediation Paths)</a></li>
<li class="chapter" data-level="2.5.2" data-path="structural-equation-models.html"><a href="structural-equation-models.html#colliders"><i class="fa fa-check"></i><b>2.5.2</b> Colliders</a></li>
<li class="chapter" data-level="2.5.3" data-path="structural-equation-models.html"><a href="structural-equation-models.html#forks-confounding-paths"><i class="fa fa-check"></i><b>2.5.3</b> Forks (Confounding Paths)</a></li>
<li class="chapter" data-level="2.5.4" data-path="structural-equation-models.html"><a href="structural-equation-models.html#descendants-of-colliders"><i class="fa fa-check"></i><b>2.5.4</b> Descendants of Colliders</a></li>
<li class="chapter" data-level="2.5.5" data-path="structural-equation-models.html"><a href="structural-equation-models.html#summary-of-strcutures"><i class="fa fa-check"></i><b>2.5.5</b> Summary of strcutures</a></li>
<li class="chapter" data-level="2.5.6" data-path="structural-equation-models.html"><a href="structural-equation-models.html#identifying-causality"><i class="fa fa-check"></i><b>2.5.6</b> Identifying Causality</a></li>
<li class="chapter" data-level="2.5.7" data-path="structural-equation-models.html"><a href="structural-equation-models.html#backdoor-criterion"><i class="fa fa-check"></i><b>2.5.7</b> Backdoor Criterion</a></li>
<li class="chapter" data-level="2.5.8" data-path="structural-equation-models.html"><a href="structural-equation-models.html#frontdoor-criterion"><i class="fa fa-check"></i><b>2.5.8</b> Frontdoor Criterion</a></li>
<li class="chapter" data-level="2.5.9" data-path="structural-equation-models.html"><a href="structural-equation-models.html#build-your-own-dag-sem-case-study-on-pollinator-impacts-of-vegetation-management"><i class="fa fa-check"></i><b>2.5.9</b> Build your own DAG: SEM Case Study on Pollinator Impacts of Vegetation Management</a></li>
<li class="chapter" data-level="2.5.10" data-path="structural-equation-models.html"><a href="structural-equation-models.html#adjustment-sets"><i class="fa fa-check"></i><b>2.5.10</b> Adjustment Sets</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="structural-equation-models.html"><a href="structural-equation-models.html#chapter-5-covariance-based-estimation-in-sem"><i class="fa fa-check"></i><b>2.6</b> Chapter 5: Covariance-Based Estimation in SEM</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="structural-equation-models.html"><a href="structural-equation-models.html#what-is-covariance-based-sem"><i class="fa fa-check"></i><b>2.6.1</b> What is Covariance-Based SEM?</a></li>
<li class="chapter" data-level="2.6.2" data-path="structural-equation-models.html"><a href="structural-equation-models.html#maximum-likelihood-estimation"><i class="fa fa-check"></i><b>2.6.2</b> Maximum Likelihood Estimation</a></li>
<li class="chapter" data-level="2.6.3" data-path="structural-equation-models.html"><a href="structural-equation-models.html#assumptions-behind-ml-estimation"><i class="fa fa-check"></i><b>2.6.3</b> Assumptions Behind ML Estimation</a></li>
<li class="chapter" data-level="2.6.4" data-path="structural-equation-models.html"><a href="structural-equation-models.html#identifiability"><i class="fa fa-check"></i><b>2.6.4</b> Identifiability</a></li>
<li class="chapter" data-level="2.6.5" data-path="structural-equation-models.html"><a href="structural-equation-models.html#degrees-of-freedom"><i class="fa fa-check"></i><b>2.6.5</b> Degrees of Freedom</a></li>
<li class="chapter" data-level="2.6.6" data-path="structural-equation-models.html"><a href="structural-equation-models.html#sample-size-considerations"><i class="fa fa-check"></i><b>2.6.6</b> Sample Size Considerations</a></li>
<li class="chapter" data-level="2.6.7" data-path="structural-equation-models.html"><a href="structural-equation-models.html#summary-1"><i class="fa fa-check"></i><b>2.6.7</b> Summary</a></li>
<li class="chapter" data-level="2.6.8" data-path="structural-equation-models.html"><a href="structural-equation-models.html#chapter-6-structural-equation-modeling-in-r-with-lavaan"><i class="fa fa-check"></i><b>2.6.8</b> Chapter 6: Structural Equation Modeling in R with lavaan</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="structural-equation-models.html"><a href="structural-equation-models.html#getting-started-with-lavaan-model-specification-estimation-and-interpretation"><i class="fa fa-check"></i><b>2.7</b> Getting Started with lavaan â Model Specification, Estimation, and Interpretation</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="structural-equation-models.html"><a href="structural-equation-models.html#chapter-7assessing-fit-and-normality"><i class="fa fa-check"></i><b>2.7.1</b> Chapter 7:Assessing Fit and Normality</a></li>
<li class="chapter" data-level="2.7.2" data-path="structural-equation-models.html"><a href="structural-equation-models.html#chapter-8-comparing-models-and-testing-mediation"><i class="fa fa-check"></i><b>2.7.2</b> Chapter 8: Comparing Models and Testing Mediation</a></li>
<li class="chapter" data-level="2.7.3" data-path="structural-equation-models.html"><a href="structural-equation-models.html#chapter-8-latent-variables-as-drivers"><i class="fa fa-check"></i><b>2.7.3</b> Chapter 8: Latent Variables as Drivers</a></li>
<li class="chapter" data-level="2.7.4" data-path="structural-equation-models.html"><a href="structural-equation-models.html#chapter-10-latent-responses-and-measurement-error"><i class="fa fa-check"></i><b>2.7.4</b> Chapter 10: Latent Responses and Measurement Error</a></li>
<li class="chapter" data-level="2.7.5" data-path="structural-equation-models.html"><a href="structural-equation-models.html#chapter-11-local-estimation-and-d-separation"><i class="fa fa-check"></i><b>2.7.5</b> Chapter 11: Local Estimation and D-Separation</a></li>
<li class="chapter" data-level="2.7.6" data-path="structural-equation-models.html"><a href="structural-equation-models.html#chapter-12-introduction-to-piecewise-sem-in-r"><i class="fa fa-check"></i><b>2.7.6</b> Chapter 12: Introduction to Piecewise SEM in R</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="structural-equation-models.html"><a href="structural-equation-models.html#part-1-what-is-piecewise-sem"><i class="fa fa-check"></i><b>2.8</b> Part 1: What is Piecewise SEM?</a>
<ul>
<li class="chapter" data-level="2.8.1" data-path="structural-equation-models.html"><a href="structural-equation-models.html#chapter-13-nonlinearity-and-interaction-in-sem"><i class="fa fa-check"></i><b>2.8.1</b> Chapter 13: Nonlinearity and Interaction in SEM</a></li>
<li class="chapter" data-level="2.8.2" data-path="structural-equation-models.html"><a href="structural-equation-models.html#chapter-14-glms-with-sem-using-piecewisesem"><i class="fa fa-check"></i><b>2.8.2</b> Chapter 14: GLMs with SEM using PiecewiseSEM</a></li>
</ul></li>
<li class="chapter" data-level="2.9" data-path="structural-equation-models.html"><a href="structural-equation-models.html#overview-1"><i class="fa fa-check"></i><b>2.9</b> Overview</a>
<ul>
<li class="chapter" data-level="2.9.1" data-path="structural-equation-models.html"><a href="structural-equation-models.html#chapter-15-categorical-predictors-multigroup-sem"><i class="fa fa-check"></i><b>2.9.1</b> Chapter 15: Categorical Predictors &amp; Multigroup SEM</a></li>
<li class="chapter" data-level="2.9.2" data-path="structural-equation-models.html"><a href="structural-equation-models.html#chapter-16-multigroup-sem-in-r"><i class="fa fa-check"></i><b>2.9.2</b> Chapter 16: Multigroup SEM in R</a></li>
<li class="chapter" data-level="2.9.3" data-path="structural-equation-models.html"><a href="structural-equation-models.html#chapter-17"><i class="fa fa-check"></i><b>2.9.3</b> Chapter 17:</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/sarasouther/DataAnalysis" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Structural Equation Models</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="structural-equation-models" class="section level1 hasAnchor" number="2">
<h1><span class="header-section-number">Chapter 2</span> Structural equation models<a href="structural-equation-models.html#structural-equation-models" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="what-are-structural-equation-models" class="section level2 hasAnchor" number="2.1">
<h2><span class="header-section-number">2.1</span> What are structural equation models?<a href="structural-equation-models.html#what-are-structural-equation-models" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Structural Equation Modeling (SEM) is a statistical technique that enables the modeling of complex causal relationships among variables. It extends regression by allowing:</p>
<ul>
<li>Simultaneous estimation of multiple equations</li>
<li>Inclusion of both observed and <strong>latent</strong> (unmeasured) variables</li>
<li>Specification of indirect effects and feedback loops</li>
<li>Assessment of model fit against observed data</li>
</ul>
<p>SEM is often visualized as a path diagram, where arrows represent hypothesized relationships between variables.</p>
<div id="when-should-you-use-sem" class="section level3 hasAnchor" number="2.1.1">
<h3><span class="header-section-number">2.1.1</span> When Should You Use SEM?<a href="structural-equation-models.html#when-should-you-use-sem" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Use SEM when:</p>
<ul>
<li>You have <strong>multiple dependent variables</strong> that may influence one another</li>
<li>You want to estimate <strong>direct and indirect effects</strong> between variables</li>
<li>You need to account for <strong>measurement error</strong> in survey or ecological constructs</li>
<li>You are testing a <strong>theory</strong> or conceptual model with multiple pathways</li>
<li>Your system includes <strong>latent constructs</strong> like âhabitat qualityâ or âdisturbance pressureâ inferred from several indicators</li>
</ul>
<blockquote>
<p>SEM is ideal when a single regression model is too simplistic to capture the interdependent relationships in your system.</p>
</blockquote>
</div>
<div id="how-is-sem-different-from-multiple-regression" class="section level3 hasAnchor" number="2.1.2">
<h3><span class="header-section-number">2.1.2</span> How is SEM Different from Multiple Regression?<a href="structural-equation-models.html#how-is-sem-different-from-multiple-regression" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<table>
<colgroup>
<col width="31%" />
<col width="29%" />
<col width="38%" />
</colgroup>
<thead>
<tr class="header">
<th>Feature</th>
<th>Multiple Regression</th>
<th>SEM</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Number of equations</td>
<td>One</td>
<td>Many simultaneously</td>
</tr>
<tr class="even">
<td>Latent variables</td>
<td>â Not allowed</td>
<td>â Allowed</td>
</tr>
<tr class="odd">
<td>Indirect effects</td>
<td>â Manual calculation</td>
<td>â Modeled explicitly</td>
</tr>
<tr class="even">
<td>Measurement error (in predictors)</td>
<td>â Ignored</td>
<td>â Can be modeled</td>
</tr>
<tr class="odd">
<td>Model fit assessment</td>
<td>RÂ², AIC, etc.</td>
<td>Chi-square test, RMSEA, CFI, TLI, etc.</td>
</tr>
</tbody>
</table>
<p>In multiple regression, you can only estimate <strong>one equation at a time</strong>, with no ability to model feedback loops or measurement error. In contrast, <strong>SEM treats your whole system as a network</strong>, testing how well your full model fits the data.</p>
</div>
<div id="summary" class="section level3 hasAnchor" number="2.1.3">
<h3><span class="header-section-number">2.1.3</span> Summary<a href="structural-equation-models.html#summary" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>SEM is a flexible and powerful framework for:</p>
<ul>
<li>Exploring and testing theoretical models</li>
<li>Modeling complex causal chains</li>
<li>Incorporating unobservable constructs</li>
</ul>
<p>It provides more rigorous insights into systems where variables are interdependent, influenced by hidden factors, and subject to error.</p>
</div>
</div>
<div id="anatomy-of-a-structural-equation-model" class="section level2 hasAnchor" number="2.2">
<h2><span class="header-section-number">2.2</span> Anatomy of a Structural Equation Model<a href="structural-equation-models.html#anatomy-of-a-structural-equation-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Structural Equation Modeling (SEM) provides a flexible framework for representing complex causal relationships between variables. In this chapter, we break down the structure of an SEM into its key components.</p>
<div id="types-of-variables" class="section level3 hasAnchor" number="2.2.1">
<h3><span class="header-section-number">2.2.1</span> Types of Variables<a href="structural-equation-models.html#types-of-variables" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>SEM uses two main types of variables:</p>
<ul>
<li><strong>Observed variables</strong>: Directly measured values (e.g., soil nitrogen, species richness).</li>
<li><strong>Latent variables</strong>: Not directly observed, but inferred from multiple observed indicators<br />
(e.g., a latent âDisturbance Pressureâ factor inferred from road density, fire frequency, and grazing).</li>
</ul>
<p>Each variable also plays one of two roles in the model:</p>
<table>
<colgroup>
<col width="18%" />
<col width="81%" />
</colgroup>
<thead>
<tr class="header">
<th>Variable Role</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Exogenous</strong></td>
<td>Predictor variables not explained by any other variables in the model.</td>
</tr>
<tr class="even">
<td><strong>Endogenous</strong></td>
<td>Response variables influenced by one or more other variables in the model.</td>
</tr>
</tbody>
</table>
<blockquote>
<p>Note: Endogenous variables can act as both outcomes and predictors of other endogenous variables.</p>
</blockquote>
</div>
<div id="path-diagrams" class="section level3 hasAnchor" number="2.2.2">
<h3><span class="header-section-number">2.2.2</span> Path Diagrams<a href="structural-equation-models.html#path-diagrams" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Path diagrams are a central feature of SEM. They visually represent the hypothesized relationships between variables using arrows:</p>
<ul>
<li><strong>Single-headed arrows (â)</strong> represent <strong>causal/predictive paths</strong></li>
<li><strong>Double-headed arrows (âï¸)</strong> represent <strong>covariances</strong> (associations not assumed to be causal)</li>
</ul>
</div>
</div>
<div id="building-multivariate-models" class="section level2 hasAnchor" number="2.3">
<h2><span class="header-section-number">2.3</span> Building Multivariate Models<a href="structural-equation-models.html#building-multivariate-models" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="what-is-causality" class="section level3 hasAnchor" number="2.3.1">
<h3><span class="header-section-number">2.3.1</span> What is Causality?<a href="structural-equation-models.html#what-is-causality" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Causality refers to understanding the directional effect one variable has on another. In SEM, causal relationships are explicitly modeled, unlike in multiple regression where they may be implied but not specified.</p>
<p>Judea Pearlâs Ladder of Causation is a framework for understanding levels of causal reasoning:</p>
<pre><code>1.  Observation â associational reasoning (âwhat isâ)
2.  Intervention â action-based reasoning (âwhat if I doâ)
3.  Counterfactuals â imagining alternate realities (âwhat if I had doneâ)</code></pre>
<p>We ascend the ladder by incorporating more assumptions and a model of the system.</p>
</div>
<div id="why-move-beyond-multiple-regression" class="section level3 hasAnchor" number="2.3.2">
<h3><span class="header-section-number">2.3.2</span> Why move beyond Multiple Regression?<a href="structural-equation-models.html#why-move-beyond-multiple-regression" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Multiple regression models:</p>
<pre><code>â¢   Estimate associations while âcontrolling forâ other variables
â¢   Assume independence among predictors
â¢   Do not explicitly encode causal structure</code></pre>
<p>Causal models (via SEM):</p>
<pre><code>â¢   Represent direction and strength of causal pathways
â¢   Account for mediators, confounders, and latent variables
â¢   Enable testing of hypotheses about mechanisms</code></pre>
</div>
<div id="meta-modeling-your-system" class="section level3 hasAnchor" number="2.3.3">
<h3><span class="header-section-number">2.3.3</span> Meta-Modeling Your System<a href="structural-equation-models.html#meta-modeling-your-system" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Before diving into data, build a conceptual model:</p>
<pre><code>1.  Define your research Purpose:

â¢   Discovery: Are you exploring patterns or relationships for the first time?
â¢   Hypothesis Testing: Are you evaluating a specific theoretical prediction?
â¢   Prediction: Are you aiming to forecast outcomes under new conditions?</code></pre>
<p>ð Tip: Discovery-based models might be more flexible or exploratory, while hypothesis testing demands tighter causal logic and pre-specified relationships.</p>
<pre><code>2.  Identify the Focus:</code></pre>
<p>What role do your variables play in the system?:</p>
<pre><code>â¢   Drivers: Variables that initiate causal change (e.g., treatments, environmental context).
â¢   Responses: Outcome variables (e.g., pollinator abundance).
â¢   Mediators: Variables that transmit effects from causes to outcomes (e.g., plant cover).
â¢   Theory Testing: Are you evaluating a known causal pathway or testing a novel ecological hypothesis?</code></pre>
<p>ð§  Make sure the pieces of your model are causal! Avoid throwing in all your variables just because you measured them â each should have a theorized role.</p>
<pre><code>3.  Determine Span of Inference:</code></pre>
<p>Are your findings meant to be context-specific or to inform broader generalizations?:</p>
<pre><code>â¢   Local/System-Specific: Targeted insights for a particular site or management action.
â¢   Generalizable Process: Testing broad ecological principles or multi-site patterns.</code></pre>
<p>ð This choice influences how you frame your model structure and what covariates (like âsiteâ) you might treat as fixed or random.</p>
</div>
</div>
<div id="from-concept-to-model" class="section level2 hasAnchor" number="2.4">
<h2><span class="header-section-number">2.4</span> From Concept to Model<a href="structural-equation-models.html#from-concept-to-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Once your meta-model is constructed:</p>
<pre><code>â¢   Reify with data availability in mind
â¢   Ensure your DAG closes appropriate backdoors
â¢   Align structure with your research purpose</code></pre>
<p>âMake sure the pieces of your model are causal!â</p>
</div>
<div id="common-structures-in-causal-diagrams" class="section level2 hasAnchor" number="2.5">
<h2><span class="header-section-number">2.5</span> Common Structures in Causal Diagrams<a href="structural-equation-models.html#common-structures-in-causal-diagrams" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In structural equation modeling (SEM) and causal inference, understanding the basic building blocks of causal diagrams is crucial. These structures form the foundation for determining what to control for and what to avoid controlling for. Below are the most common structures youâll encounter in Directed Acyclic Graphs (DAGs), with brief explanations and examples.</p>
<div id="chains-mediation-paths" class="section level3 hasAnchor" number="2.5.1">
<h3><span class="header-section-number">2.5.1</span> Chains (Mediation Paths)<a href="structural-equation-models.html#chains-mediation-paths" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Structure:</p>
<p>Cause â Mediator â Effect</p>
<p>Interpretation:</p>
<pre><code>â¢   The mediator is an intermediate variable through which the cause affects the effect.
â¢   If you control for the mediator, you block the indirect path, potentially underestimating the total effect of the cause.</code></pre>
<p>Example:</p>
<p>Fire frequency â Canopy cover â Soil moisture
â¢ If you control for canopy cover, you might miss the full effect that fire frequency has on soil moisture via changes in canopy cover.</p>
<p>Visual:</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="structural-equation-models.html#cb92-1" tabindex="-1"></a><span class="fu">library</span>(dagitty)</span>
<span id="cb92-2"><a href="structural-equation-models.html#cb92-2" tabindex="-1"></a><span class="fu">library</span>(ggdag)</span>
<span id="cb92-3"><a href="structural-equation-models.html#cb92-3" tabindex="-1"></a></span>
<span id="cb92-4"><a href="structural-equation-models.html#cb92-4" tabindex="-1"></a>dag <span class="ot">&lt;-</span> <span class="fu">dagify</span>(</span>
<span id="cb92-5"><a href="structural-equation-models.html#cb92-5" tabindex="-1"></a>  SoilMoisture <span class="sc">~</span> CanopyCover,</span>
<span id="cb92-6"><a href="structural-equation-models.html#cb92-6" tabindex="-1"></a>  CanopyCover <span class="sc">~</span> Fire,</span>
<span id="cb92-7"><a href="structural-equation-models.html#cb92-7" tabindex="-1"></a>  <span class="at">labels =</span> <span class="fu">c</span>(<span class="at">Fire =</span> <span class="st">&quot;Fire Frequency&quot;</span>, <span class="at">CanopyCover =</span> <span class="st">&quot;Canopy Cover&quot;</span>, <span class="at">SoilMoisture =</span> <span class="st">&quot;Soil Moisture&quot;</span>),</span>
<span id="cb92-8"><a href="structural-equation-models.html#cb92-8" tabindex="-1"></a>  <span class="at">exposure =</span> <span class="st">&quot;Fire&quot;</span>, <span class="at">outcome =</span> <span class="st">&quot;SoilMoisture&quot;</span></span>
<span id="cb92-9"><a href="structural-equation-models.html#cb92-9" tabindex="-1"></a>)</span>
<span id="cb92-10"><a href="structural-equation-models.html#cb92-10" tabindex="-1"></a><span class="fu">ggdag</span>(dag, <span class="at">text =</span> <span class="cn">FALSE</span>, <span class="at">use_labels =</span> <span class="st">&quot;label&quot;</span>) <span class="sc">+</span> <span class="fu">theme_dag</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-29-1.png" width="672" /></p>
</div>
<div id="colliders" class="section level3 hasAnchor" number="2.5.2">
<h3><span class="header-section-number">2.5.2</span> Colliders<a href="structural-equation-models.html#colliders" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Structure:</p>
<p>Cause1 â Collider â Cause2</p>
<p>Interpretation:</p>
<pre><code>â¢   A collider is a variable that is influenced by two (or more) variables.
â¢   Controlling for the collider opens a path between the two causes, creating spurious associations where none may exist.</code></pre>
<p>Example:</p>
<p>Soil nitrogen â Plant growth â Pathogen load
â¢ Both soil nitrogen and pathogen load affect plant growth. If you control for plant growth (the collider), it might look like soil nitrogen and pathogens are correlatedâeven if theyâre not.</p>
<p>Visual:</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="structural-equation-models.html#cb94-1" tabindex="-1"></a>dag <span class="ot">&lt;-</span> <span class="fu">dagify</span>(</span>
<span id="cb94-2"><a href="structural-equation-models.html#cb94-2" tabindex="-1"></a>  PlantGrowth <span class="sc">~</span> SoilNitrogen <span class="sc">+</span> PathogenLoad,</span>
<span id="cb94-3"><a href="structural-equation-models.html#cb94-3" tabindex="-1"></a>  <span class="at">labels =</span> <span class="fu">c</span>(<span class="at">SoilNitrogen =</span> <span class="st">&quot;Soil N&quot;</span>, <span class="at">PathogenLoad =</span> <span class="st">&quot;Pathogens&quot;</span>, <span class="at">PlantGrowth =</span> <span class="st">&quot;Plant Growth&quot;</span>),</span>
<span id="cb94-4"><a href="structural-equation-models.html#cb94-4" tabindex="-1"></a>  <span class="at">exposure =</span> <span class="st">&quot;SoilNitrogen&quot;</span>, <span class="at">outcome =</span> <span class="st">&quot;PathogenLoad&quot;</span></span>
<span id="cb94-5"><a href="structural-equation-models.html#cb94-5" tabindex="-1"></a>)</span>
<span id="cb94-6"><a href="structural-equation-models.html#cb94-6" tabindex="-1"></a><span class="fu">ggdag</span>(dag, <span class="at">text =</span> <span class="cn">FALSE</span>, <span class="at">use_labels =</span> <span class="st">&quot;label&quot;</span>) <span class="sc">+</span> <span class="fu">theme_dag</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-30-1.png" width="672" /></p>
</div>
<div id="forks-confounding-paths" class="section level3 hasAnchor" number="2.5.3">
<h3><span class="header-section-number">2.5.3</span> Forks (Confounding Paths)<a href="structural-equation-models.html#forks-confounding-paths" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Structure:</p>
<p>CommonCause â Cause, CommonCause â Effect</p>
<p>Interpretation:</p>
<pre><code>â¢   This is a confounding structure, where the common cause explains the observed correlation between two variables.
â¢   Controlling for the common cause blocks the backdoor path, helping isolate the causal effect.</code></pre>
<p>Example:</p>
<p>Soil type â Invasive species cover
Soil type â Native species richness
â¢ If you donât control for soil type, you may falsely conclude that invasive cover affects native richness, when both are simply driven by the soil.</p>
<p>Visual:</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="structural-equation-models.html#cb96-1" tabindex="-1"></a>dag <span class="ot">&lt;-</span> <span class="fu">dagify</span>(</span>
<span id="cb96-2"><a href="structural-equation-models.html#cb96-2" tabindex="-1"></a>  InvasiveCover <span class="sc">~</span> SoilType,</span>
<span id="cb96-3"><a href="structural-equation-models.html#cb96-3" tabindex="-1"></a>  NativeRichness <span class="sc">~</span> SoilType,</span>
<span id="cb96-4"><a href="structural-equation-models.html#cb96-4" tabindex="-1"></a>  <span class="at">labels =</span> <span class="fu">c</span>(<span class="at">SoilType =</span> <span class="st">&quot;Soil Type&quot;</span>, <span class="at">InvasiveCover =</span> <span class="st">&quot;Invasive Cover&quot;</span>, <span class="at">NativeRichness =</span> <span class="st">&quot;Native Richness&quot;</span>),</span>
<span id="cb96-5"><a href="structural-equation-models.html#cb96-5" tabindex="-1"></a>  <span class="at">exposure =</span> <span class="st">&quot;InvasiveCover&quot;</span>, <span class="at">outcome =</span> <span class="st">&quot;NativeRichness&quot;</span></span>
<span id="cb96-6"><a href="structural-equation-models.html#cb96-6" tabindex="-1"></a>)</span>
<span id="cb96-7"><a href="structural-equation-models.html#cb96-7" tabindex="-1"></a><span class="fu">ggdag</span>(dag, <span class="at">text =</span> <span class="cn">FALSE</span>, <span class="at">use_labels =</span> <span class="st">&quot;label&quot;</span>) <span class="sc">+</span> <span class="fu">theme_dag</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-31-1.png" width="672" /></p>
</div>
<div id="descendants-of-colliders" class="section level3 hasAnchor" number="2.5.4">
<h3><span class="header-section-number">2.5.4</span> Descendants of Colliders<a href="structural-equation-models.html#descendants-of-colliders" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Key Point:</p>
<pre><code>â¢   Controlling for descendants of colliders can also open spurious paths.</code></pre>
<p>Example:</p>
<p>Imagine you control for a variable like Plant biomass, which is a descendant of a collider (e.g., Herbivory â Plant defense â Biomass). This can reintroduce bias just like controlling for the collider itself.</p>
</div>
<div id="summary-of-strcutures" class="section level3 hasAnchor" number="2.5.5">
<h3><span class="header-section-number">2.5.5</span> Summary of strcutures<a href="structural-equation-models.html#summary-of-strcutures" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Structure Do You Control For It? Why?
Chain (mediator) â (if estimating total effect) Controls block indirect paths
Collider â Conditioning opens spurious paths
Fork (common cause) â Controls block confounding
Descendant of Collider â Opens collider paths indirectly</p>
<p>Understanding these structures helps you build better SEMs, choose correct adjustment sets, and avoid introducing bias into your models.</p>
</div>
<div id="identifying-causality" class="section level3 hasAnchor" number="2.5.6">
<h3><span class="header-section-number">2.5.6</span> Identifying Causality<a href="structural-equation-models.html#identifying-causality" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You donât need to know all mechanisms to make causal claims. But you do need to:</p>
<pre><code>â¢   Map the system (e.g., using DAGs)
â¢   Identify and control for confounders
â¢   Avoid controlling for mediators</code></pre>
</div>
<div id="backdoor-criterion" class="section level3 hasAnchor" number="2.5.7">
<h3><span class="header-section-number">2.5.7</span> Backdoor Criterion<a href="structural-equation-models.html#backdoor-criterion" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To estimate a causal effect of X â Y, block all backdoor paths (those that flow into X) by conditioning on appropriate variables not affected by X.</p>
</div>
<div id="frontdoor-criterion" class="section level3 hasAnchor" number="2.5.8">
<h3><span class="header-section-number">2.5.8</span> Frontdoor Criterion<a href="structural-equation-models.html#frontdoor-criterion" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Useful when you canât block all backdoor paths. Identify a mediator that:</p>
<pre><code>â¢   Is affected by X
â¢   Affects Y
â¢   Is not affected by any confounders of X and Y</code></pre>
</div>
<div id="build-your-own-dag-sem-case-study-on-pollinator-impacts-of-vegetation-management" class="section level3 hasAnchor" number="2.5.9">
<h3><span class="header-section-number">2.5.9</span> Build your own DAG: SEM Case Study on Pollinator Impacts of Vegetation Management<a href="structural-equation-models.html#build-your-own-dag-sem-case-study-on-pollinator-impacts-of-vegetation-management" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This research project explores how different Integrated Vegetation Management (IVM) treatments conducted by Arizona Public Service (APS) on powerline rights-of-way (ROWs) affect pollinator communities, using Structural Equation Modeling (SEM) to untangle direct and indirect effects.</p>
<div id="study-context" class="section level4 hasAnchor" number="2.5.9.1">
<h4><span class="header-section-number">2.5.9.1</span> Study Context<a href="structural-equation-models.html#study-context" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>APS manages vegetation beneath powerlines for safety and access, using a mix of:</p>
<pre><code>â¢   Mechanical removal
â¢   Herbicide application
â¢   Combined Mechanical + Herbicide
â¢   Untreated (Control) plots</code></pre>
<p>Understanding how these treatments influence floral resources is key to predicting changes in pollinator abundance and diversity.</p>
</div>
<div id="data-collection" class="section level4 hasAnchor" number="2.5.9.2">
<h4><span class="header-section-number">2.5.9.2</span> Data Collection<a href="structural-equation-models.html#data-collection" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>At 3 sites, treatments were applied in a randomized block design across plots categorized as:</p>
<pre><code>â¢   Control
â¢   Herbicide
â¢   Mechanical
â¢   Mechanical + Herbicide</code></pre>
<p>Researchers want to test whether management effects on pollinators are mediated through floral resources, or whether there are residual (direct) effects of treatment type beyond vegetation structure.</p>
</div>
<div id="key-variables-and-their-roles" class="section level4 hasAnchor" number="2.5.9.3">
<h4><span class="header-section-number">2.5.9.3</span> Key Variables and Their Roles<a href="structural-equation-models.html#key-variables-and-their-roles" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Exogenous (Independent) Variables:</p>
<pre><code>â¢   Treatment (main predictorâe.g., herbicide, mowing)
â¢   Soil substrate (moderator/stratifier of treatment effects)
â¢   Cattle presence (a confounderânot caused by treatment)</code></pre>
<p>Plant Community Mediators:</p>
<pre><code>â¢   Plant richness
â¢   Plant cover
â¢   Plant height
â¢   Ceanothus presence/abundance
â¢   Woody debris</code></pre>
<p>Pollinator Response Variables:</p>
<pre><code>â¢   Pollinator abundance
â¢   Pollinator richness</code></pre>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="structural-equation-models.html#cb105-1" tabindex="-1"></a><span class="fu">library</span>(dagitty)</span>
<span id="cb105-2"><a href="structural-equation-models.html#cb105-2" tabindex="-1"></a><span class="fu">library</span>(ggdag)</span>
<span id="cb105-3"><a href="structural-equation-models.html#cb105-3" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb105-4"><a href="structural-equation-models.html#cb105-4" tabindex="-1"></a></span>
<span id="cb105-5"><a href="structural-equation-models.html#cb105-5" tabindex="-1"></a></span>
<span id="cb105-6"><a href="structural-equation-models.html#cb105-6" tabindex="-1"></a><span class="co"># Define the DAG</span></span>
<span id="cb105-7"><a href="structural-equation-models.html#cb105-7" tabindex="-1"></a>ivm_dag <span class="ot">&lt;-</span> <span class="fu">dagitty</span>(<span class="st">&quot;</span></span>
<span id="cb105-8"><a href="structural-equation-models.html#cb105-8" tabindex="-1"></a><span class="st">dag {</span></span>
<span id="cb105-9"><a href="structural-equation-models.html#cb105-9" tabindex="-1"></a><span class="st">  Treatment</span></span>
<span id="cb105-10"><a href="structural-equation-models.html#cb105-10" tabindex="-1"></a><span class="st">  Soil_Substrate</span></span>
<span id="cb105-11"><a href="structural-equation-models.html#cb105-11" tabindex="-1"></a><span class="st">  Cattle</span></span>
<span id="cb105-12"><a href="structural-equation-models.html#cb105-12" tabindex="-1"></a><span class="st">  Plant_Richness</span></span>
<span id="cb105-13"><a href="structural-equation-models.html#cb105-13" tabindex="-1"></a><span class="st">  Plant_Cover</span></span>
<span id="cb105-14"><a href="structural-equation-models.html#cb105-14" tabindex="-1"></a><span class="st">  Plant_Height</span></span>
<span id="cb105-15"><a href="structural-equation-models.html#cb105-15" tabindex="-1"></a><span class="st">  Ceanothus</span></span>
<span id="cb105-16"><a href="structural-equation-models.html#cb105-16" tabindex="-1"></a><span class="st">  Woody_Debris</span></span>
<span id="cb105-17"><a href="structural-equation-models.html#cb105-17" tabindex="-1"></a><span class="st">  Pollinator_Richness</span></span>
<span id="cb105-18"><a href="structural-equation-models.html#cb105-18" tabindex="-1"></a><span class="st">  Pollinator_Abundance</span></span>
<span id="cb105-19"><a href="structural-equation-models.html#cb105-19" tabindex="-1"></a></span>
<span id="cb105-20"><a href="structural-equation-models.html#cb105-20" tabindex="-1"></a><span class="st">  Treatment -&gt; Plant_Richness</span></span>
<span id="cb105-21"><a href="structural-equation-models.html#cb105-21" tabindex="-1"></a><span class="st">  Treatment -&gt; Plant_Cover</span></span>
<span id="cb105-22"><a href="structural-equation-models.html#cb105-22" tabindex="-1"></a><span class="st">  Treatment -&gt; Plant_Height</span></span>
<span id="cb105-23"><a href="structural-equation-models.html#cb105-23" tabindex="-1"></a><span class="st">  Treatment -&gt; Ceanothus</span></span>
<span id="cb105-24"><a href="structural-equation-models.html#cb105-24" tabindex="-1"></a><span class="st">  Treatment -&gt; Woody_Debris</span></span>
<span id="cb105-25"><a href="structural-equation-models.html#cb105-25" tabindex="-1"></a></span>
<span id="cb105-26"><a href="structural-equation-models.html#cb105-26" tabindex="-1"></a><span class="st">  Soil_Substrate -&gt; Treatment</span></span>
<span id="cb105-27"><a href="structural-equation-models.html#cb105-27" tabindex="-1"></a><span class="st">  Soil_Substrate -&gt; Plant_Richness</span></span>
<span id="cb105-28"><a href="structural-equation-models.html#cb105-28" tabindex="-1"></a><span class="st">  Soil_Substrate -&gt; Plant_Cover</span></span>
<span id="cb105-29"><a href="structural-equation-models.html#cb105-29" tabindex="-1"></a><span class="st">  Soil_Substrate -&gt; Woody_Debris</span></span>
<span id="cb105-30"><a href="structural-equation-models.html#cb105-30" tabindex="-1"></a></span>
<span id="cb105-31"><a href="structural-equation-models.html#cb105-31" tabindex="-1"></a><span class="st">  Cattle -&gt; Plant_Richness</span></span>
<span id="cb105-32"><a href="structural-equation-models.html#cb105-32" tabindex="-1"></a><span class="st">  Cattle -&gt; Plant_Cover</span></span>
<span id="cb105-33"><a href="structural-equation-models.html#cb105-33" tabindex="-1"></a><span class="st">  Cattle -&gt; Pollinator_Abundance</span></span>
<span id="cb105-34"><a href="structural-equation-models.html#cb105-34" tabindex="-1"></a><span class="st">  Cattle -&gt; Pollinator_Richness</span></span>
<span id="cb105-35"><a href="structural-equation-models.html#cb105-35" tabindex="-1"></a></span>
<span id="cb105-36"><a href="structural-equation-models.html#cb105-36" tabindex="-1"></a><span class="st">  Plant_Richness -&gt; Pollinator_Richness</span></span>
<span id="cb105-37"><a href="structural-equation-models.html#cb105-37" tabindex="-1"></a><span class="st">  Plant_Richness -&gt; Pollinator_Abundance</span></span>
<span id="cb105-38"><a href="structural-equation-models.html#cb105-38" tabindex="-1"></a><span class="st">  Plant_Cover -&gt; Pollinator_Richness</span></span>
<span id="cb105-39"><a href="structural-equation-models.html#cb105-39" tabindex="-1"></a><span class="st">  Plant_Cover -&gt; Pollinator_Abundance</span></span>
<span id="cb105-40"><a href="structural-equation-models.html#cb105-40" tabindex="-1"></a><span class="st">  Plant_Height -&gt; Pollinator_Richness</span></span>
<span id="cb105-41"><a href="structural-equation-models.html#cb105-41" tabindex="-1"></a><span class="st">  Plant_Height -&gt; Pollinator_Abundance</span></span>
<span id="cb105-42"><a href="structural-equation-models.html#cb105-42" tabindex="-1"></a><span class="st">  Ceanothus -&gt; Pollinator_Richness</span></span>
<span id="cb105-43"><a href="structural-equation-models.html#cb105-43" tabindex="-1"></a><span class="st">  Ceanothus -&gt; Pollinator_Abundance</span></span>
<span id="cb105-44"><a href="structural-equation-models.html#cb105-44" tabindex="-1"></a><span class="st">  Woody_Debris -&gt; Pollinator_Richness</span></span>
<span id="cb105-45"><a href="structural-equation-models.html#cb105-45" tabindex="-1"></a><span class="st">  Woody_Debris -&gt; Pollinator_Abundance</span></span>
<span id="cb105-46"><a href="structural-equation-models.html#cb105-46" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb105-47"><a href="structural-equation-models.html#cb105-47" tabindex="-1"></a><span class="st">&quot;</span>)</span>
<span id="cb105-48"><a href="structural-equation-models.html#cb105-48" tabindex="-1"></a></span>
<span id="cb105-49"><a href="structural-equation-models.html#cb105-49" tabindex="-1"></a>node_roles <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb105-50"><a href="structural-equation-models.html#cb105-50" tabindex="-1"></a>  <span class="at">name =</span> <span class="fu">c</span>(</span>
<span id="cb105-51"><a href="structural-equation-models.html#cb105-51" tabindex="-1"></a>    <span class="st">&quot;Treatment&quot;</span>,</span>
<span id="cb105-52"><a href="structural-equation-models.html#cb105-52" tabindex="-1"></a>    <span class="st">&quot;Soil_Substrate&quot;</span>,</span>
<span id="cb105-53"><a href="structural-equation-models.html#cb105-53" tabindex="-1"></a>    <span class="st">&quot;Cattle&quot;</span>,</span>
<span id="cb105-54"><a href="structural-equation-models.html#cb105-54" tabindex="-1"></a>    <span class="st">&quot;Plant_Richness&quot;</span>,</span>
<span id="cb105-55"><a href="structural-equation-models.html#cb105-55" tabindex="-1"></a>    <span class="st">&quot;Plant_Cover&quot;</span>,</span>
<span id="cb105-56"><a href="structural-equation-models.html#cb105-56" tabindex="-1"></a>    <span class="st">&quot;Plant_Height&quot;</span>,</span>
<span id="cb105-57"><a href="structural-equation-models.html#cb105-57" tabindex="-1"></a>    <span class="st">&quot;Ceanothus&quot;</span>,</span>
<span id="cb105-58"><a href="structural-equation-models.html#cb105-58" tabindex="-1"></a>    <span class="st">&quot;Woody_Debris&quot;</span>,</span>
<span id="cb105-59"><a href="structural-equation-models.html#cb105-59" tabindex="-1"></a>    <span class="st">&quot;Pollinator_Richness&quot;</span>,</span>
<span id="cb105-60"><a href="structural-equation-models.html#cb105-60" tabindex="-1"></a>    <span class="st">&quot;Pollinator_Abundance&quot;</span></span>
<span id="cb105-61"><a href="structural-equation-models.html#cb105-61" tabindex="-1"></a>  ),</span>
<span id="cb105-62"><a href="structural-equation-models.html#cb105-62" tabindex="-1"></a>  <span class="at">role =</span> <span class="fu">c</span>(</span>
<span id="cb105-63"><a href="structural-equation-models.html#cb105-63" tabindex="-1"></a>    <span class="st">&quot;Treatment&quot;</span>,</span>
<span id="cb105-64"><a href="structural-equation-models.html#cb105-64" tabindex="-1"></a>    <span class="st">&quot;Context&quot;</span>,</span>
<span id="cb105-65"><a href="structural-equation-models.html#cb105-65" tabindex="-1"></a>    <span class="st">&quot;Context&quot;</span>,</span>
<span id="cb105-66"><a href="structural-equation-models.html#cb105-66" tabindex="-1"></a>    <span class="st">&quot;Plant&quot;</span>,</span>
<span id="cb105-67"><a href="structural-equation-models.html#cb105-67" tabindex="-1"></a>    <span class="st">&quot;Plant&quot;</span>,</span>
<span id="cb105-68"><a href="structural-equation-models.html#cb105-68" tabindex="-1"></a>    <span class="st">&quot;Plant&quot;</span>,</span>
<span id="cb105-69"><a href="structural-equation-models.html#cb105-69" tabindex="-1"></a>    <span class="st">&quot;Plant&quot;</span>,</span>
<span id="cb105-70"><a href="structural-equation-models.html#cb105-70" tabindex="-1"></a>    <span class="st">&quot;Plant&quot;</span>,</span>
<span id="cb105-71"><a href="structural-equation-models.html#cb105-71" tabindex="-1"></a>    <span class="st">&quot;Pollinator&quot;</span>,</span>
<span id="cb105-72"><a href="structural-equation-models.html#cb105-72" tabindex="-1"></a>    <span class="st">&quot;Pollinator&quot;</span></span>
<span id="cb105-73"><a href="structural-equation-models.html#cb105-73" tabindex="-1"></a>  )</span>
<span id="cb105-74"><a href="structural-equation-models.html#cb105-74" tabindex="-1"></a>)</span>
<span id="cb105-75"><a href="structural-equation-models.html#cb105-75" tabindex="-1"></a></span>
<span id="cb105-76"><a href="structural-equation-models.html#cb105-76" tabindex="-1"></a><span class="co"># Get layout and merge roles</span></span>
<span id="cb105-77"><a href="structural-equation-models.html#cb105-77" tabindex="-1"></a>dag_df <span class="ot">&lt;-</span> <span class="fu">tidy_dagitty</span>(ivm_dag, <span class="at">layout =</span> <span class="st">&quot;nicely&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb105-78"><a href="structural-equation-models.html#cb105-78" tabindex="-1"></a>  <span class="fu">left_join</span>(node_roles, <span class="at">by =</span> <span class="st">&quot;name&quot;</span>)</span>
<span id="cb105-79"><a href="structural-equation-models.html#cb105-79" tabindex="-1"></a></span>
<span id="cb105-80"><a href="structural-equation-models.html#cb105-80" tabindex="-1"></a><span class="co"># Plot using ggplot2 with corrected edge structure</span></span>
<span id="cb105-81"><a href="structural-equation-models.html#cb105-81" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb105-82"><a href="structural-equation-models.html#cb105-82" tabindex="-1"></a>  <span class="fu">geom_segment</span>(</span>
<span id="cb105-83"><a href="structural-equation-models.html#cb105-83" tabindex="-1"></a>    <span class="at">data =</span> dag_df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(xend)),</span>
<span id="cb105-84"><a href="structural-equation-models.html#cb105-84" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">xend =</span> xend, <span class="at">yend =</span> yend),</span>
<span id="cb105-85"><a href="structural-equation-models.html#cb105-85" tabindex="-1"></a>    <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.02</span>, <span class="st">&quot;npc&quot;</span>)),</span>
<span id="cb105-86"><a href="structural-equation-models.html#cb105-86" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;grey40&quot;</span></span>
<span id="cb105-87"><a href="structural-equation-models.html#cb105-87" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb105-88"><a href="structural-equation-models.html#cb105-88" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb105-89"><a href="structural-equation-models.html#cb105-89" tabindex="-1"></a>    <span class="at">data =</span> dag_df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(x)), </span>
<span id="cb105-90"><a href="structural-equation-models.html#cb105-90" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">color =</span> role), </span>
<span id="cb105-91"><a href="structural-equation-models.html#cb105-91" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">8</span>, <span class="at">alpha =</span> <span class="fl">0.85</span></span>
<span id="cb105-92"><a href="structural-equation-models.html#cb105-92" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb105-93"><a href="structural-equation-models.html#cb105-93" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb105-94"><a href="structural-equation-models.html#cb105-94" tabindex="-1"></a>    <span class="at">data =</span> dag_df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(x)), </span>
<span id="cb105-95"><a href="structural-equation-models.html#cb105-95" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> name), </span>
<span id="cb105-96"><a href="structural-equation-models.html#cb105-96" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">4</span></span>
<span id="cb105-97"><a href="structural-equation-models.html#cb105-97" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb105-98"><a href="structural-equation-models.html#cb105-98" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb105-99"><a href="structural-equation-models.html#cb105-99" tabindex="-1"></a>    <span class="st">&quot;Treatment&quot;</span> <span class="ot">=</span> <span class="st">&quot;#FB7E21FF&quot;</span>,</span>
<span id="cb105-100"><a href="structural-equation-models.html#cb105-100" tabindex="-1"></a>    <span class="st">&quot;Context&quot;</span> <span class="ot">=</span> <span class="st">&quot;#A91601FF&quot;</span>,</span>
<span id="cb105-101"><a href="structural-equation-models.html#cb105-101" tabindex="-1"></a>    <span class="st">&quot;Plant&quot;</span> <span class="ot">=</span> <span class="st">&quot;#18DDC2FF&quot;</span>,</span>
<span id="cb105-102"><a href="structural-equation-models.html#cb105-102" tabindex="-1"></a>    <span class="st">&quot;Pollinator&quot;</span> <span class="ot">=</span> <span class="st">&quot;#00468BFF&quot;</span></span>
<span id="cb105-103"><a href="structural-equation-models.html#cb105-103" tabindex="-1"></a>  )) <span class="sc">+</span></span>
<span id="cb105-104"><a href="structural-equation-models.html#cb105-104" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb105-105"><a href="structural-equation-models.html#cb105-105" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Hypothesized DAG for Pollinator Response to IVM Treatment&quot;</span>,</span>
<span id="cb105-106"><a href="structural-equation-models.html#cb105-106" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;Variable Type&quot;</span></span>
<span id="cb105-107"><a href="structural-equation-models.html#cb105-107" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb105-108"><a href="structural-equation-models.html#cb105-108" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-32-1.png" width="672" /></p>
</div>
</div>
<div id="adjustment-sets" class="section level3 hasAnchor" number="2.5.10">
<h3><span class="header-section-number">2.5.10</span> Adjustment Sets<a href="structural-equation-models.html#adjustment-sets" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>An adjustment set is a group of variables you control for (include as covariates) in order to estimate the causal effect of one variable (say, Treatment) on another (say, Pollinator_Richness) without bias.</p>
<p>In short, it blocks backdoor paths â those sneaky alternative routes through which spurious associations can travel.</p>
<p>To find variables to condition on:</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="structural-equation-models.html#cb106-1" tabindex="-1"></a><span class="fu">adjustmentSets</span>(ivm_dag, <span class="at">exposure =</span> <span class="st">&quot;Treatment&quot;</span>, <span class="at">outcome =</span> <span class="st">&quot;Pollinator_Richness&quot;</span>)</span></code></pre></div>
<pre><code>## { Soil_Substrate }</code></pre>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="structural-equation-models.html#cb108-1" tabindex="-1"></a><span class="fu">adjustmentSets</span>(ivm_dag, <span class="at">exposure =</span> <span class="st">&quot;Treatment&quot;</span>, <span class="at">outcome =</span> <span class="st">&quot;Pollinator_Abundance&quot;</span>)</span></code></pre></div>
<pre><code>## { Soil_Substrate }</code></pre>
<p>Interpretation:</p>
<p>To estimate the total causal effect of Treatment on Pollinator_Richness, you only need to adjust for Soil_Substrate.</p>
<p>This means:</p>
<pre><code>â¢   Soil_Substrate is a backdoor variable â it opens a non-causal path because it influences both Treatment and plant variables that, in turn, influence pollinators.
â¢   Controlling for Soil_Substrate blocks that spurious path and gives you an unbiased estimate of the effect of Treatment.</code></pre>
<p>Do not control for:</p>
<pre><code>â¢   Mediators, like Plant_Richness, Plant_Cover, or Woody_Debris, if you want the total effect of treatment.
â¢   Colliders, such as anything caused by both Treatment and another variable (you donât have a clear collider in this DAG, but good to keep in mind).</code></pre>
<p>Example in a model:</p>
<pre><code>â¢   model &lt;- lm(Pollinator_Richness ~ Treatment + Soil_Substrate, data = your_data)</code></pre>
<p><em>GREG HERE YOU NEED TO CREATE YOUR FINAL DATASET BY SUMMARIZING THE VEG DATA AND ADDING YOUR POLLINATOR DATA PER PLOT. THEN WE CAN ADJUST THE CODE BELOW TO TEST WHETHER YOU REPLICATION / DATA ARE OK AND THEN MOVE ONTO NEXT STEPS</em></p>
</div>
</div>
<div id="chapter-5-covariance-based-estimation-in-sem" class="section level2 hasAnchor" number="2.6">
<h2><span class="header-section-number">2.6</span> Chapter 5: Covariance-Based Estimation in SEM<a href="structural-equation-models.html#chapter-5-covariance-based-estimation-in-sem" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="structural-equation-models.html#cb113-1" tabindex="-1"></a><span class="fu">library</span>(lavaan)</span>
<span id="cb113-2"><a href="structural-equation-models.html#cb113-2" tabindex="-1"></a><span class="fu">library</span>(mvtnorm)</span>
<span id="cb113-3"><a href="structural-equation-models.html#cb113-3" tabindex="-1"></a><span class="fu">library</span>(mvnormtest)</span>
<span id="cb113-4"><a href="structural-equation-models.html#cb113-4" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb113-5"><a href="structural-equation-models.html#cb113-5" tabindex="-1"></a><span class="fu">library</span>(Matrix)</span></code></pre></div>
<div id="what-is-covariance-based-sem" class="section level3 hasAnchor" number="2.6.1">
<h3><span class="header-section-number">2.6.1</span> What is Covariance-Based SEM?<a href="structural-equation-models.html#what-is-covariance-based-sem" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Structural Equation Modeling (SEM) using covariance-based maximum likelihood estimation fits parameters so that the model-implied covariance matrix matches the observed covariance matrix as closely as possible. Unlike individual regression models:</p>
<ul>
<li>SEM accounts for how estimation of one parameter affects others.</li>
<li>SEM allows for modeling feedbacks and latent variables.</li>
<li>SEM is based on maximum likelihood estimation (MLE).</li>
</ul>
</div>
<div id="maximum-likelihood-estimation" class="section level3 hasAnchor" number="2.6.2">
<h3><span class="header-section-number">2.6.2</span> Maximum Likelihood Estimation<a href="structural-equation-models.html#maximum-likelihood-estimation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In SEM, MLE identifies parameters that maximize the likelihood of observing the data, given the model. This involves:</p>
<ul>
<li>Exploring the parameter space iteratively.</li>
<li>Estimating model fit using a fitting function like ML.</li>
<li>Computationally intensive with more parameters.</li>
</ul>
</div>
<div id="assumptions-behind-ml-estimation" class="section level3 hasAnchor" number="2.6.3">
<h3><span class="header-section-number">2.6.3</span> Assumptions Behind ML Estimation<a href="structural-equation-models.html#assumptions-behind-ml-estimation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Multivariate normality (use <code>mvnormtest::mshapiro.test()</code>)</li>
</ul>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="structural-equation-models.html#cb114-1" tabindex="-1"></a><span class="co"># Simulate multivariate normal data</span></span>
<span id="cb114-2"><a href="structural-equation-models.html#cb114-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb114-3"><a href="structural-equation-models.html#cb114-3" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb114-4"><a href="structural-equation-models.html#cb114-4" tabindex="-1"></a>  <span class="at">x1 =</span> <span class="fu">rnorm</span>(<span class="dv">100</span>),</span>
<span id="cb114-5"><a href="structural-equation-models.html#cb114-5" tabindex="-1"></a>  <span class="at">x2 =</span> <span class="fu">rnorm</span>(<span class="dv">100</span>),</span>
<span id="cb114-6"><a href="structural-equation-models.html#cb114-6" tabindex="-1"></a>  <span class="at">x3 =</span> <span class="fu">rnorm</span>(<span class="dv">100</span>)</span>
<span id="cb114-7"><a href="structural-equation-models.html#cb114-7" tabindex="-1"></a>)</span>
<span id="cb114-8"><a href="structural-equation-models.html#cb114-8" tabindex="-1"></a></span>
<span id="cb114-9"><a href="structural-equation-models.html#cb114-9" tabindex="-1"></a><span class="co"># Use mshapiro.test from mvnormtest</span></span>
<span id="cb114-10"><a href="structural-equation-models.html#cb114-10" tabindex="-1"></a><span class="fu">mshapiro.test</span>(<span class="fu">t</span>(data))  <span class="co"># Note the transpose!</span></span></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  Z
## W = 0.97635, p-value = 0.0689</code></pre>
<ul>
<li>No severe skew or missing data</li>
<li>No redundant variables (covariance matrix must be positive definite)</li>
</ul>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="structural-equation-models.html#cb116-1" tabindex="-1"></a><span class="co"># Check skew and kurtosis</span></span>
<span id="cb116-2"><a href="structural-equation-models.html#cb116-2" tabindex="-1"></a>psych<span class="sc">::</span><span class="fu">describe</span>(data)</span></code></pre></div>
<pre><code>##    vars   n  mean   sd median trimmed  mad   min  max range skew kurtosis   se
## x1    1 100  0.09 0.91   0.06    0.08 0.89 -2.31 2.19  4.50 0.06    -0.22 0.09
## x2    2 100 -0.11 0.97  -0.23   -0.17 0.97 -2.05 3.24  5.29 0.63     0.58 0.10
## x3    3 100  0.12 0.95   0.04    0.09 0.91 -1.76 2.29  4.05 0.32    -0.59 0.09</code></pre>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="structural-equation-models.html#cb118-1" tabindex="-1"></a><span class="co"># Check for missing data</span></span>
<span id="cb118-2"><a href="structural-equation-models.html#cb118-2" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">is.na</span>(data))  <span class="co"># Should be all FALSE</span></span></code></pre></div>
<pre><code>##      x1              x2              x3         
##  Mode :logical   Mode :logical   Mode :logical  
##  FALSE:100       FALSE:100       FALSE:100</code></pre>
<ul>
<li>Sufficient sample size relative to parameters</li>
</ul>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="structural-equation-models.html#cb120-1" tabindex="-1"></a><span class="co"># Count parameters in a simple lavaan model</span></span>
<span id="cb120-2"><a href="structural-equation-models.html#cb120-2" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="st">&#39;</span></span>
<span id="cb120-3"><a href="structural-equation-models.html#cb120-3" tabindex="-1"></a><span class="st">  y1 ~ x1 + x2</span></span>
<span id="cb120-4"><a href="structural-equation-models.html#cb120-4" tabindex="-1"></a><span class="st">  y2 ~ y1</span></span>
<span id="cb120-5"><a href="structural-equation-models.html#cb120-5" tabindex="-1"></a><span class="st">&#39;</span></span>
<span id="cb120-6"><a href="structural-equation-models.html#cb120-6" tabindex="-1"></a><span class="co"># Simulate data</span></span>
<span id="cb120-7"><a href="structural-equation-models.html#cb120-7" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x1 =</span> <span class="fu">rnorm</span>(<span class="dv">100</span>), <span class="at">x2 =</span> <span class="fu">rnorm</span>(<span class="dv">100</span>), <span class="at">y1 =</span> <span class="fu">rnorm</span>(<span class="dv">100</span>), <span class="at">y2 =</span> <span class="fu">rnorm</span>(<span class="dv">100</span>))</span>
<span id="cb120-8"><a href="structural-equation-models.html#cb120-8" tabindex="-1"></a></span>
<span id="cb120-9"><a href="structural-equation-models.html#cb120-9" tabindex="-1"></a><span class="co"># Estimate number of parameters</span></span>
<span id="cb120-10"><a href="structural-equation-models.html#cb120-10" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">sem</span>(model, <span class="at">data =</span> data)</span>
<span id="cb120-11"><a href="structural-equation-models.html#cb120-11" tabindex="-1"></a><span class="fu">summary</span>(fit)</span></code></pre></div>
<pre><code>## lavaan 0.6-19 ended normally after 1 iteration
## 
##   Estimator                                         ML
##   Optimization method                           NLMINB
##   Number of model parameters                         5
## 
##   Number of observations                           100
## 
## Model Test User Model:
##                                                       
##   Test statistic                                 0.497
##   Degrees of freedom                                 2
##   P-value (Chi-square)                           0.780
## 
## Parameter Estimates:
## 
##   Standard errors                             Standard
##   Information                                 Expected
##   Information saturated (h1) model          Structured
## 
## Regressions:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##   y1 ~                                                
##     x1               -0.078    0.088   -0.882    0.378
##     x2                0.194    0.092    2.103    0.036
##   y2 ~                                                
##     y1               -0.071    0.109   -0.648    0.517
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##    .y1                0.829    0.117    7.071    0.000
##    .y2                1.042    0.147    7.071    0.000</code></pre>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="structural-equation-models.html#cb122-1" tabindex="-1"></a><span class="co"># Count parameters</span></span>
<span id="cb122-2"><a href="structural-equation-models.html#cb122-2" tabindex="-1"></a>n_params <span class="ot">&lt;-</span> <span class="fu">lavInspect</span>(fit, <span class="st">&quot;npar&quot;</span>)</span>
<span id="cb122-3"><a href="structural-equation-models.html#cb122-3" tabindex="-1"></a>n_obs <span class="ot">&lt;-</span> <span class="fu">nrow</span>(data)</span>
<span id="cb122-4"><a href="structural-equation-models.html#cb122-4" tabindex="-1"></a></span>
<span id="cb122-5"><a href="structural-equation-models.html#cb122-5" tabindex="-1"></a><span class="co"># Portnoyâs Rule</span></span>
<span id="cb122-6"><a href="structural-equation-models.html#cb122-6" tabindex="-1"></a>portnoy_value <span class="ot">&lt;-</span> n_params<span class="sc">^</span>(<span class="dv">3</span><span class="sc">/</span><span class="dv">2</span>) <span class="sc">/</span> n_obs</span>
<span id="cb122-7"><a href="structural-equation-models.html#cb122-7" tabindex="-1"></a>portnoy_value  <span class="co"># Should be close to 0</span></span></code></pre></div>
<pre><code>## [1] 0.1118034</code></pre>
</div>
<div id="identifiability" class="section level3 hasAnchor" number="2.6.4">
<h3><span class="header-section-number">2.6.4</span> Identifiability<a href="structural-equation-models.html#identifiability" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Before fitting a SEM, you must ensure it is <strong>identified</strong> â meaning you have enough unique information to estimate all model parameters.</p>
<div id="key-rules" class="section level4 hasAnchor" number="2.6.4.1">
<h4><span class="header-section-number">2.6.4.1</span> Key Rules<a href="structural-equation-models.html#key-rules" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li><strong>T-rule</strong>: Number of parameters â¤ unique entries in covariance matrix.</li>
</ul>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="structural-equation-models.html#cb124-1" tabindex="-1"></a><span class="co"># Number of unique observed covariances</span></span>
<span id="cb124-2"><a href="structural-equation-models.html#cb124-2" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ncol</span>(data)</span>
<span id="cb124-3"><a href="structural-equation-models.html#cb124-3" tabindex="-1"></a>n_cov <span class="ot">&lt;-</span> p <span class="sc">*</span> (p <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb124-4"><a href="structural-equation-models.html#cb124-4" tabindex="-1"></a></span>
<span id="cb124-5"><a href="structural-equation-models.html#cb124-5" tabindex="-1"></a><span class="co"># Compare to number of free parameters</span></span>
<span id="cb124-6"><a href="structural-equation-models.html#cb124-6" tabindex="-1"></a>n_cov</span></code></pre></div>
<pre><code>## [1] 10</code></pre>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="structural-equation-models.html#cb126-1" tabindex="-1"></a><span class="fu">lavInspect</span>(fit, <span class="st">&quot;npar&quot;</span>)  <span class="co"># Should be â¤ n_cov</span></span></code></pre></div>
<pre><code>## [1] 5</code></pre>
<ul>
<li><strong>Order condition</strong>: For each endogenous variable, incoming paths â¤ connected variables.</li>
</ul>
<p>Thereâs no direct test â but:
â¢ Draw your DAG.
â¢ Count how many arrows go into each endogenous variable.
â¢ Make sure that number â¤ number of variables related to it.</p>
<ul>
<li><p><strong>Rank condition</strong>: Variables in feedback loops must be influenced by different causes.</p>
<p>â¢ For feedback loops: ensure that each variable has at least one unique exogenous predictor.
â¢ Use DAG tools (ggdag or dagitty) to visualize and confirm.</p></li>
</ul>
<blockquote>
<p>If these rules are violated, the model is underidentified and cannot be estimated.</p>
</blockquote>
</div>
</div>
<div id="degrees-of-freedom" class="section level3 hasAnchor" number="2.6.5">
<h3><span class="header-section-number">2.6.5</span> Degrees of Freedom<a href="structural-equation-models.html#degrees-of-freedom" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><strong>DF = number of observed variances/covariances â number of estimated parameters</strong></li>
<li>Just-identified models (DF = 0): Canât test fit</li>
<li>Overidentified models (DF &gt; 0): Preferred â allows model fit evaluation</li>
</ul>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="structural-equation-models.html#cb128-1" tabindex="-1"></a><span class="fu">library</span>(lavaan)</span>
<span id="cb128-2"><a href="structural-equation-models.html#cb128-2" tabindex="-1"></a></span>
<span id="cb128-3"><a href="structural-equation-models.html#cb128-3" tabindex="-1"></a><span class="co"># define model as a lavaan-style string</span></span>
<span id="cb128-4"><a href="structural-equation-models.html#cb128-4" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="st">&#39;</span></span>
<span id="cb128-5"><a href="structural-equation-models.html#cb128-5" tabindex="-1"></a><span class="st">  cover ~ age + elev</span></span>
<span id="cb128-6"><a href="structural-equation-models.html#cb128-6" tabindex="-1"></a><span class="st">  firesev ~ age + cover</span></span>
<span id="cb128-7"><a href="structural-equation-models.html#cb128-7" tabindex="-1"></a><span class="st">&#39;</span></span>
<span id="cb128-8"><a href="structural-equation-models.html#cb128-8" tabindex="-1"></a></span>
<span id="cb128-9"><a href="structural-equation-models.html#cb128-9" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">sem</span>(model, <span class="at">data =</span> keeley)</span>
<span id="cb128-10"><a href="structural-equation-models.html#cb128-10" tabindex="-1"></a><span class="fu">fitMeasures</span>(fit, <span class="fu">c</span>(<span class="st">&quot;chisq&quot;</span>, <span class="st">&quot;df&quot;</span>, <span class="st">&quot;pvalue&quot;</span>, <span class="st">&quot;cfi&quot;</span>, <span class="st">&quot;rmsea&quot;</span>))</span></code></pre></div>
<pre><code>##  chisq     df pvalue    cfi  rmsea 
##  0.900  1.000  0.343  1.000  0.000</code></pre>
</div>
<div id="sample-size-considerations" class="section level3 hasAnchor" number="2.6.6">
<h3><span class="header-section-number">2.6.6</span> Sample Size Considerations<a href="structural-equation-models.html#sample-size-considerations" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A modelâs complexity is limited by your sample size:</p>
<ul>
<li>Rule of thumb: â¥ 5 observations per estimated parameter</li>
<li>Preferably: â¥ 20 observations per parameter</li>
<li>Use Portnoyâs rule: Ï<sup>3/2</sup> / <em>n</em> â 0</li>
</ul>
<p>Account for:</p>
<ul>
<li>Exogenous variable variances/covariances (often directly estimated from data)</li>
<li>Endogenous variable error variances (often derived, not estimated directly)</li>
</ul>
</div>
<div id="summary-1" class="section level3 hasAnchor" number="2.6.7">
<h3><span class="header-section-number">2.6.7</span> Summary<a href="structural-equation-models.html#summary-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Covariance-based SEM is powerful but demands careful model design:</p>
<ul>
<li>Check identifiability before estimation</li>
<li>Be aware of sample size constraints</li>
<li>Use model diagnostics to evaluate fit after estimation</li>
</ul>
</div>
<div id="chapter-6-structural-equation-modeling-in-r-with-lavaan" class="section level3 hasAnchor" number="2.6.8">
<h3><span class="header-section-number">2.6.8</span> Chapter 6: Structural Equation Modeling in R with lavaan<a href="structural-equation-models.html#chapter-6-structural-equation-modeling-in-r-with-lavaan" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
</div>
<div id="getting-started-with-lavaan-model-specification-estimation-and-interpretation" class="section level2 hasAnchor" number="2.7">
<h2><span class="header-section-number">2.7</span> Getting Started with lavaan â Model Specification, Estimation, and Interpretation<a href="structural-equation-models.html#getting-started-with-lavaan-model-specification-estimation-and-interpretation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Setting Up</p>
<p>Before you begin, make sure the lavaan and lavaanPlot packages are installed:</p>
<p>What is lavaan?</p>
<pre><code>â¢   lavaan stands for Latent Variable Analysis.
â¢   Developed by Yves Rosseel (2010).
â¢   Syntax is similar to regression in R using formulas.
â¢   It supports latent and observed variables, covariance-based SEM, mediation, path analysis, and more.</code></pre>
<p>Example: Post-Fire Plant Recovery</p>
<p>Weâll analyze a dataset from Keeley et al.Â (2006) studying how stand age, fire severity, and other factors affect plant cover.</p>
<p>Step 1: Start Simple â A Regression as SEM</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="structural-equation-models.html#cb131-1" tabindex="-1"></a><span class="co"># Load dataset</span></span>
<span id="cb131-2"><a href="structural-equation-models.html#cb131-2" tabindex="-1"></a><span class="co"># Example: keeley &lt;- read.csv(&quot;path/to/your/keeley_data.csv&quot;)</span></span>
<span id="cb131-3"><a href="structural-equation-models.html#cb131-3" tabindex="-1"></a></span>
<span id="cb131-4"><a href="structural-equation-models.html#cb131-4" tabindex="-1"></a><span class="co"># Fit SEM</span></span>
<span id="cb131-5"><a href="structural-equation-models.html#cb131-5" tabindex="-1"></a><span class="co">#model1 &lt;- &#39;cover ~ age&#39;</span></span>
<span id="cb131-6"><a href="structural-equation-models.html#cb131-6" tabindex="-1"></a><span class="co">#fit1 &lt;- sem(model1, data = keeley)</span></span>
<span id="cb131-7"><a href="structural-equation-models.html#cb131-7" tabindex="-1"></a><span class="co">#summary(fit1, standardized = TRUE, rsquare = TRUE)</span></span></code></pre></div>
<p>Intercepts and Mean Structures</p>
<p>To explicitly estimate intercepts:</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="structural-equation-models.html#cb132-1" tabindex="-1"></a><span class="co">#fit1_mean &lt;- sem(model1, data = keeley, meanstructure = TRUE)</span></span>
<span id="cb132-2"><a href="structural-equation-models.html#cb132-2" tabindex="-1"></a><span class="co">#summary(fit1_mean)</span></span></code></pre></div>
<p>Viewing the Model</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="structural-equation-models.html#cb133-1" tabindex="-1"></a><span class="co">#lavaanPlot(model = fit1, coefs = TRUE, stand = TRUE)</span></span></code></pre></div>
<p>Standardized Estimates</p>
<p>standardizedSolution(fit1)</p>
<p>This gives standardized coefficients and helps compare the relative strength of predictors.</p>
<p>Mediation Example: Indirect Effects</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="structural-equation-models.html#cb134-1" tabindex="-1"></a><span class="co">#model2 &lt;- &#39;</span></span>
<span id="cb134-2"><a href="structural-equation-models.html#cb134-2" tabindex="-1"></a><span class="co">#  firesev ~ age</span></span>
<span id="cb134-3"><a href="structural-equation-models.html#cb134-3" tabindex="-1"></a><span class="co">#  cover ~ firesev + age</span></span>
<span id="cb134-4"><a href="structural-equation-models.html#cb134-4" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb134-5"><a href="structural-equation-models.html#cb134-5" tabindex="-1"></a><span class="co">#fit2 &lt;- sem(model2, data = keeley)</span></span>
<span id="cb134-6"><a href="structural-equation-models.html#cb134-6" tabindex="-1"></a><span class="co">#summary(fit2, standardized = TRUE, rsquare = TRUE)</span></span></code></pre></div>
<p>Direct, Indirect, and Total Effects</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="structural-equation-models.html#cb135-1" tabindex="-1"></a><span class="co">#model3 &lt;- &#39;</span></span>
<span id="cb135-2"><a href="structural-equation-models.html#cb135-2" tabindex="-1"></a><span class="co">#  firesev ~ af*age</span></span>
<span id="cb135-3"><a href="structural-equation-models.html#cb135-3" tabindex="-1"></a><span class="co">#  cover ~ fc*firesev + ac*age</span></span>
<span id="cb135-4"><a href="structural-equation-models.html#cb135-4" tabindex="-1"></a></span>
<span id="cb135-5"><a href="structural-equation-models.html#cb135-5" tabindex="-1"></a>  <span class="co"># Derived</span></span>
<span id="cb135-6"><a href="structural-equation-models.html#cb135-6" tabindex="-1"></a><span class="co"># indirect := af * fc</span></span>
<span id="cb135-7"><a href="structural-equation-models.html#cb135-7" tabindex="-1"></a><span class="co">#  total := ac + (af * fc)</span></span>
<span id="cb135-8"><a href="structural-equation-models.html#cb135-8" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb135-9"><a href="structural-equation-models.html#cb135-9" tabindex="-1"></a><span class="co">#fit3 &lt;- sem(model3, data = keeley)</span></span>
<span id="cb135-10"><a href="structural-equation-models.html#cb135-10" tabindex="-1"></a><span class="co">#standardizedSolution(fit3)</span></span></code></pre></div>
<p>Warnings: Variance Scaling</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="structural-equation-models.html#cb136-1" tabindex="-1"></a><span class="co">#varTable(fit3)</span></span></code></pre></div>
<p>If you get a warning about variances differing by orders of magnitude, consider rescaling your variables or using standardized solutions.</p>
<p>Visualizing Complex Models</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="structural-equation-models.html#cb137-1" tabindex="-1"></a><span class="co">#lavaanPlot(</span></span>
<span id="cb137-2"><a href="structural-equation-models.html#cb137-2" tabindex="-1"></a><span class="co">#  model = fit3,</span></span>
<span id="cb137-3"><a href="structural-equation-models.html#cb137-3" tabindex="-1"></a><span class="co">#  coefs = TRUE,</span></span>
<span id="cb137-4"><a href="structural-equation-models.html#cb137-4" tabindex="-1"></a><span class="co">#  stand = TRUE,</span></span>
<span id="cb137-5"><a href="structural-equation-models.html#cb137-5" tabindex="-1"></a><span class="co">#  sig = 0.05,</span></span>
<span id="cb137-6"><a href="structural-equation-models.html#cb137-6" tabindex="-1"></a><span class="co">#  graph_options = list(layout = &quot;circo&quot;)</span></span>
<span id="cb137-7"><a href="structural-equation-models.html#cb137-7" tabindex="-1"></a><span class="co">#)</span></span></code></pre></div>
<p>Final Exercise Prompt</p>
<p>Try fitting the following model:</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="structural-equation-models.html#cb138-1" tabindex="-1"></a><span class="co">#model_final &lt;- &#39;</span></span>
<span id="cb138-2"><a href="structural-equation-models.html#cb138-2" tabindex="-1"></a><span class="co">#  rich ~ distance + abiotic + hetero</span></span>
<span id="cb138-3"><a href="structural-equation-models.html#cb138-3" tabindex="-1"></a><span class="co">#  hetero ~ distance</span></span>
<span id="cb138-4"><a href="structural-equation-models.html#cb138-4" tabindex="-1"></a><span class="co">#  abiotic ~ distance</span></span>
<span id="cb138-5"><a href="structural-equation-models.html#cb138-5" tabindex="-1"></a><span class="co">#  abiotic ~~ hetero</span></span>
<span id="cb138-6"><a href="structural-equation-models.html#cb138-6" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb138-7"><a href="structural-equation-models.html#cb138-7" tabindex="-1"></a><span class="co">#fit_final &lt;- sem(model_final, data = keeley)</span></span>
<span id="cb138-8"><a href="structural-equation-models.html#cb138-8" tabindex="-1"></a><span class="co">#summary(fit_final, standardized = TRUE)</span></span></code></pre></div>
<div id="chapter-7assessing-fit-and-normality" class="section level3 hasAnchor" number="2.7.1">
<h3><span class="header-section-number">2.7.1</span> Chapter 7:Assessing Fit and Normality<a href="structural-equation-models.html#chapter-7assessing-fit-and-normality" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="structural-equation-models.html#cb139-1" tabindex="-1"></a><span class="fu">library</span>(lavaan)</span>
<span id="cb139-2"><a href="structural-equation-models.html#cb139-2" tabindex="-1"></a><span class="fu">library</span>(mvnormtest)</span>
<span id="cb139-3"><a href="structural-equation-models.html#cb139-3" tabindex="-1"></a><span class="fu">library</span>(MVN)</span></code></pre></div>
<p>Overview</p>
<p>In this tutorial, we learn how to evaluate model fit and test for normality, key assumptions in covariance-based SEM. Weâll cover:</p>
<pre><code>â¢   Standard fit indices (e.g., RMSEA, CFI)
â¢   Residuals and modification indices
â¢   Normality diagnostics
â¢   Remedies for assumption violations</code></pre>
<p>Example: Fully Mediated SEM</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="structural-equation-models.html#cb141-1" tabindex="-1"></a><span class="co">#model_full &lt;- &#39;</span></span>
<span id="cb141-2"><a href="structural-equation-models.html#cb141-2" tabindex="-1"></a><span class="co">#  firesev ~ age</span></span>
<span id="cb141-3"><a href="structural-equation-models.html#cb141-3" tabindex="-1"></a><span class="co">#  cover ~ firesev</span></span>
<span id="cb141-4"><a href="structural-equation-models.html#cb141-4" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb141-5"><a href="structural-equation-models.html#cb141-5" tabindex="-1"></a></span>
<span id="cb141-6"><a href="structural-equation-models.html#cb141-6" tabindex="-1"></a><span class="co">#fit_full &lt;- sem(model_full, data = keeley, meanstructure = TRUE)</span></span>
<span id="cb141-7"><a href="structural-equation-models.html#cb141-7" tabindex="-1"></a><span class="co">#summary(fit_full, fit.measures = TRUE)</span></span></code></pre></div>
<p>Interpretation:</p>
<pre><code>â¢   Chi-square (p &gt; 0.05) â Model is not significantly different from the observed data.
â¢   Check additional fit indices: RMSEA, CFI, SRMR, AIC, BIC.</code></pre>
<p>Fit Indices (Kline 2023 Recommendations)</p>
<p>Fit Measure Interpretation
Chi-square test Prefer p &gt; 0.05
RMSEA 90% CI lower bound &lt; 0.05
CFI &gt; 0.90
SRMR &lt; 0.10</p>
<p>Diagnosing Misfit with Residuals</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="structural-equation-models.html#cb143-1" tabindex="-1"></a><span class="co">#residuals(fit_full, type = &quot;cor&quot;)  # residual correlations</span></span>
<span id="cb143-2"><a href="structural-equation-models.html#cb143-2" tabindex="-1"></a><span class="co">#modificationIndices(fit_full, standardized = FALSE, sort. = TRUE)</span></span></code></pre></div>
<pre><code>â¢   Large residuals or modification indices &gt; 3.84 suggest misfit.
â¢   Inspect residual correlation between rich and distance.</code></pre>
<p>Testing Normality of Residuals</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="structural-equation-models.html#cb145-1" tabindex="-1"></a><span class="fu">library</span>(MVN)</span>
<span id="cb145-2"><a href="structural-equation-models.html#cb145-2" tabindex="-1"></a></span>
<span id="cb145-3"><a href="structural-equation-models.html#cb145-3" tabindex="-1"></a><span class="co"># Step 1: Get residuals from lavaan model</span></span>
<span id="cb145-4"><a href="structural-equation-models.html#cb145-4" tabindex="-1"></a><span class="co">#resids &lt;- lavPredict(fit_full, type = &quot;ov&quot;)  # residuals for observed variables</span></span>
<span id="cb145-5"><a href="structural-equation-models.html#cb145-5" tabindex="-1"></a></span>
<span id="cb145-6"><a href="structural-equation-models.html#cb145-6" tabindex="-1"></a><span class="co"># Optional: check univariate normality visually</span></span>
<span id="cb145-7"><a href="structural-equation-models.html#cb145-7" tabindex="-1"></a><span class="co">#apply(resids[, 1:2], 2, function(x) {</span></span>
<span id="cb145-8"><a href="structural-equation-models.html#cb145-8" tabindex="-1"></a><span class="co">#  qqnorm(x); qqline(x)</span></span>
<span id="cb145-9"><a href="structural-equation-models.html#cb145-9" tabindex="-1"></a><span class="co">#})</span></span>
<span id="cb145-10"><a href="structural-equation-models.html#cb145-10" tabindex="-1"></a></span>
<span id="cb145-11"><a href="structural-equation-models.html#cb145-11" tabindex="-1"></a><span class="co"># Step 2: Multivariate Shapiro-Wilk (for n â¤ 50)</span></span>
<span id="cb145-12"><a href="structural-equation-models.html#cb145-12" tabindex="-1"></a><span class="co">#mshapiro.test(t(resids[, 1:2]))</span></span>
<span id="cb145-13"><a href="structural-equation-models.html#cb145-13" tabindex="-1"></a></span>
<span id="cb145-14"><a href="structural-equation-models.html#cb145-14" tabindex="-1"></a><span class="co"># Step 3: Mardia&#39;s test for multivariate normality</span></span>
<span id="cb145-15"><a href="structural-equation-models.html#cb145-15" tabindex="-1"></a><span class="co">#MVN::mvn(data = resids[, 1:2], mvn_test = &quot;mardia&quot;)</span></span>
<span id="cb145-16"><a href="structural-equation-models.html#cb145-16" tabindex="-1"></a></span>
<span id="cb145-17"><a href="structural-equation-models.html#cb145-17" tabindex="-1"></a><span class="co"># Step 1: Get residuals from lavaan model</span></span>
<span id="cb145-18"><a href="structural-equation-models.html#cb145-18" tabindex="-1"></a><span class="co">#tryCatch({</span></span>
<span id="cb145-19"><a href="structural-equation-models.html#cb145-19" tabindex="-1"></a><span class="co">#  resids &lt;- lavPredict(fit_full, type = &quot;ov&quot;)</span></span>
<span id="cb145-20"><a href="structural-equation-models.html#cb145-20" tabindex="-1"></a>  </span>
<span id="cb145-21"><a href="structural-equation-models.html#cb145-21" tabindex="-1"></a>  <span class="co"># Make sure residuals are numeric and have no missing values</span></span>
<span id="cb145-22"><a href="structural-equation-models.html#cb145-22" tabindex="-1"></a><span class="co">#  if (!is.null(resids) &amp;&amp; is.matrix(resids) &amp;&amp; all(is.finite(resids[, 1:2]))) {</span></span>
<span id="cb145-23"><a href="structural-equation-models.html#cb145-23" tabindex="-1"></a>    <span class="co"># Step 2: Multivariate Shapiro-Wilk (for n â¤ 50)</span></span>
<span id="cb145-24"><a href="structural-equation-models.html#cb145-24" tabindex="-1"></a><span class="co">#    print(mshapiro.test(t(resids[, 1:2])))</span></span>
<span id="cb145-25"><a href="structural-equation-models.html#cb145-25" tabindex="-1"></a></span>
<span id="cb145-26"><a href="structural-equation-models.html#cb145-26" tabindex="-1"></a>    <span class="co"># Step 3: Mardia&#39;s test</span></span>
<span id="cb145-27"><a href="structural-equation-models.html#cb145-27" tabindex="-1"></a><span class="co">#    print(MVN::mvn(data = resids[, 1:2], mvn_test = &quot;mardia&quot;))</span></span>
<span id="cb145-28"><a href="structural-equation-models.html#cb145-28" tabindex="-1"></a><span class="co">#  } else {</span></span>
<span id="cb145-29"><a href="structural-equation-models.html#cb145-29" tabindex="-1"></a><span class="co">#    message(&quot;Residuals are missing, not numeric, or contain NA/Inf values.&quot;)</span></span>
<span id="cb145-30"><a href="structural-equation-models.html#cb145-30" tabindex="-1"></a><span class="co">#  }</span></span>
<span id="cb145-31"><a href="structural-equation-models.html#cb145-31" tabindex="-1"></a><span class="co">#}, error = function(e) {</span></span>
<span id="cb145-32"><a href="structural-equation-models.html#cb145-32" tabindex="-1"></a><span class="co">#  message(&quot;MVN test failed: &quot;, conditionMessage(e))</span></span>
<span id="cb145-33"><a href="structural-equation-models.html#cb145-33" tabindex="-1"></a><span class="co">#})</span></span></code></pre></div>
<p>â¸»</p>
<p>If Assumptions Are Violatedâ¦</p>
<p>Option 1: Satorra-Bentler Correction</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="structural-equation-models.html#cb146-1" tabindex="-1"></a><span class="co">#fit_sb &lt;- sem(model_full, data = keeley, test = &quot;Satorra.Bentler&quot;)</span></span>
<span id="cb146-2"><a href="structural-equation-models.html#cb146-2" tabindex="-1"></a><span class="co">#summary(fit_sb)</span></span></code></pre></div>
<p>Option 2: Bollen-Stine Bootstrap</p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="structural-equation-models.html#cb147-1" tabindex="-1"></a><span class="co">#fit_bs &lt;- sem(model_full, data = keeley, test = &quot;bollen.stine&quot;, se = &quot;boot&quot;, bootstrap = 1000)</span></span>
<span id="cb147-2"><a href="structural-equation-models.html#cb147-2" tabindex="-1"></a><span class="co">#summary(fit_bs)</span></span></code></pre></div>
<p>Summary:</p>
<pre><code>â¢   Use fit indices and residuals to assess model performance.
â¢   Check assumptions of normality; consider corrections if violated.
â¢   Explore modification indices to identify potential improvements.</code></pre>
</div>
<div id="chapter-8-comparing-models-and-testing-mediation" class="section level3 hasAnchor" number="2.7.2">
<h3><span class="header-section-number">2.7.2</span> Chapter 8: Comparing Models and Testing Mediation<a href="structural-equation-models.html#chapter-8-comparing-models-and-testing-mediation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This section introduces two major approaches for comparing SEM models:
â¢ Likelihood Ratio Tests (LRTs) for nested models.
â¢ Information Criteria (e.g., AIC, AICc) for both nested and non-nested models.</p>
<p>We also explore mediation, which refers to how a relationship between two variables is explained by one or more intervening variables.</p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="structural-equation-models.html#cb149-1" tabindex="-1"></a><span class="co"># Load required libraries</span></span>
<span id="cb149-2"><a href="structural-equation-models.html#cb149-2" tabindex="-1"></a><span class="fu">library</span>(lavaan)</span>
<span id="cb149-3"><a href="structural-equation-models.html#cb149-3" tabindex="-1"></a><span class="fu">library</span>(AICcmodavg)</span>
<span id="cb149-4"><a href="structural-equation-models.html#cb149-4" tabindex="-1"></a></span>
<span id="cb149-5"><a href="structural-equation-models.html#cb149-5" tabindex="-1"></a><span class="co"># Fully Mediated Model</span></span>
<span id="cb149-6"><a href="structural-equation-models.html#cb149-6" tabindex="-1"></a>fullMedModel <span class="ot">&lt;-</span> <span class="st">&#39;</span></span>
<span id="cb149-7"><a href="structural-equation-models.html#cb149-7" tabindex="-1"></a><span class="st">  firesev ~ age</span></span>
<span id="cb149-8"><a href="structural-equation-models.html#cb149-8" tabindex="-1"></a><span class="st">  cover ~ firesev</span></span>
<span id="cb149-9"><a href="structural-equation-models.html#cb149-9" tabindex="-1"></a><span class="st">&#39;</span></span>
<span id="cb149-10"><a href="structural-equation-models.html#cb149-10" tabindex="-1"></a>fullMedSEM <span class="ot">&lt;-</span> <span class="fu">sem</span>(fullMedModel, <span class="at">data =</span> keeley)</span>
<span id="cb149-11"><a href="structural-equation-models.html#cb149-11" tabindex="-1"></a></span>
<span id="cb149-12"><a href="structural-equation-models.html#cb149-12" tabindex="-1"></a><span class="co"># Partially Mediated Model</span></span>
<span id="cb149-13"><a href="structural-equation-models.html#cb149-13" tabindex="-1"></a>partialMedModel <span class="ot">&lt;-</span> <span class="st">&#39;</span></span>
<span id="cb149-14"><a href="structural-equation-models.html#cb149-14" tabindex="-1"></a><span class="st">  firesev ~ age</span></span>
<span id="cb149-15"><a href="structural-equation-models.html#cb149-15" tabindex="-1"></a><span class="st">  cover ~ firesev + age</span></span>
<span id="cb149-16"><a href="structural-equation-models.html#cb149-16" tabindex="-1"></a><span class="st">&#39;</span></span>
<span id="cb149-17"><a href="structural-equation-models.html#cb149-17" tabindex="-1"></a>partialMedSEM <span class="ot">&lt;-</span> <span class="fu">sem</span>(partialMedModel, <span class="at">data =</span> keeley)</span>
<span id="cb149-18"><a href="structural-equation-models.html#cb149-18" tabindex="-1"></a></span>
<span id="cb149-19"><a href="structural-equation-models.html#cb149-19" tabindex="-1"></a><span class="co"># Likelihood Ratio Test (nested models)</span></span>
<span id="cb149-20"><a href="structural-equation-models.html#cb149-20" tabindex="-1"></a><span class="fu">anova</span>(partialMedSEM, fullMedSEM)</span></code></pre></div>
<pre><code>## 
## Chi-Squared Difference Test
## 
##               Df   AIC   BIC  Chisq Chisq diff   RMSEA Df diff Pr(&gt;Chisq)  
## partialMedSEM  0 359.4 371.9 0.0000                                        
## fullMedSEM     1 360.7 370.7 3.2974     3.2974 0.15977       1    0.06939 .
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Interpretation: A non-significant LRT suggests that the simpler (fully mediated) model fits the data about as well as the more complex model.</p>
<p>AIC-Based Model Comparison</p>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="structural-equation-models.html#cb151-1" tabindex="-1"></a><span class="co"># AICc model comparison</span></span>
<span id="cb151-2"><a href="structural-equation-models.html#cb151-2" tabindex="-1"></a><span class="fu">aictab</span>(</span>
<span id="cb151-3"><a href="structural-equation-models.html#cb151-3" tabindex="-1"></a>  <span class="at">cand.set =</span> <span class="fu">list</span>(fullMedSEM, partialMedSEM),</span>
<span id="cb151-4"><a href="structural-equation-models.html#cb151-4" tabindex="-1"></a>  <span class="at">modnames =</span> <span class="fu">c</span>(<span class="st">&quot;Full&quot;</span>, <span class="st">&quot;Partial&quot;</span>)</span>
<span id="cb151-5"><a href="structural-equation-models.html#cb151-5" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## 
## Model selection based on AICc:
## 
##         K   AICc Delta_AICc AICcWt Cum.Wt      LL
## Partial 5 360.11       0.00   0.63   0.63 -174.70
## Full    4 361.17       1.05   0.37   1.00 -176.35</code></pre>
<p>Interpretation: Models within 2 ÎAICc units are considered roughly equivalent. Higher AIC weight (AICcWt) indicates stronger support for that model.</p>
<p>Additional Example: Distance and Species Richness</p>
<p>Key Takeaways:</p>
<pre><code>â¢   Use LRT for nested models; lower chi-square and higher p-value = simpler model may suffice.
â¢   Use AICc for broader comparisons; lower AICc and higher weight = better.
â¢   Mediation is central to SEM and can be tested with both approaches.
â¢   Fully vs. Partially Mediated models differ by whether direct paths bypass mediators.</code></pre>
</div>
<div id="chapter-8-latent-variables-as-drivers" class="section level3 hasAnchor" number="2.7.3">
<h3><span class="header-section-number">2.7.3</span> Chapter 8: Latent Variables as Drivers<a href="structural-equation-models.html#chapter-8-latent-variables-as-drivers" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>What is a Latent Variable?</p>
<p>Latent variables are unobserved constructs that we infer from multiple observed indicators. They represent abstract concepts like intelligence, disturbance, or biodiversity.</p>
<pre><code>â¢   In SEM, latent variables are drawn as circles.
â¢   Observed indicators are squares or rectangles.
â¢   Latent variables are typically estimated through Confirmatory Factor Analysis (CFA).</code></pre>
<p>Confirmatory Factor Analysis (CFA)</p>
<p>CFA allows you to test whether certain observed variables co-vary in ways consistent with an underlying theoretical construct.</p>
<p>Example: Aposematism in Poison Frogs</p>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="structural-equation-models.html#cb155-1" tabindex="-1"></a><span class="co"># Sample covariance matrix from Santos &amp; Cannatella (2011)</span></span>
<span id="cb155-2"><a href="structural-equation-models.html#cb155-2" tabindex="-1"></a><span class="co"># santosCov &lt;- read.table(&quot;https://raw.githubusercontent.com/username/santosCov.txt&quot;, na.strings = #&quot;.&quot;)</span></span>
<span id="cb155-3"><a href="structural-equation-models.html#cb155-3" tabindex="-1"></a><span class="co">#santosCov &lt;- as.matrix(santosCov)</span></span>
<span id="cb155-4"><a href="structural-equation-models.html#cb155-4" tabindex="-1"></a></span>
<span id="cb155-5"><a href="structural-equation-models.html#cb155-5" tabindex="-1"></a><span class="co"># Create covariance matrix manually (example values)</span></span>
<span id="cb155-6"><a href="structural-equation-models.html#cb155-6" tabindex="-1"></a>santosCov <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(</span>
<span id="cb155-7"><a href="structural-equation-models.html#cb155-7" tabindex="-1"></a>  <span class="fl">1.00</span>,  <span class="fl">0.45</span>, <span class="fl">0.38</span>,</span>
<span id="cb155-8"><a href="structural-equation-models.html#cb155-8" tabindex="-1"></a>  <span class="fl">0.45</span>,  <span class="fl">1.00</span>, <span class="fl">0.50</span>,</span>
<span id="cb155-9"><a href="structural-equation-models.html#cb155-9" tabindex="-1"></a>  <span class="fl">0.38</span>,  <span class="fl">0.50</span>, <span class="fl">1.00</span></span>
<span id="cb155-10"><a href="structural-equation-models.html#cb155-10" tabindex="-1"></a>), <span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb155-11"><a href="structural-equation-models.html#cb155-11" tabindex="-1"></a></span>
<span id="cb155-12"><a href="structural-equation-models.html#cb155-12" tabindex="-1"></a><span class="co"># Add row and column names (must match your CFA model exactly)</span></span>
<span id="cb155-13"><a href="structural-equation-models.html#cb155-13" tabindex="-1"></a><span class="fu">colnames</span>(santosCov) <span class="ot">&lt;-</span> <span class="fu">rownames</span>(santosCov) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Alkaloid.quantity&quot;</span>, <span class="st">&quot;Alkaloid.diversity&quot;</span>, <span class="st">&quot;Conspicuous.coloration&quot;</span>)</span>
<span id="cb155-14"><a href="structural-equation-models.html#cb155-14" tabindex="-1"></a></span>
<span id="cb155-15"><a href="structural-equation-models.html#cb155-15" tabindex="-1"></a><span class="co"># Specify CFA model</span></span>
<span id="cb155-16"><a href="structural-equation-models.html#cb155-16" tabindex="-1"></a>santosCFA1 <span class="ot">&lt;-</span> <span class="st">&#39;</span></span>
<span id="cb155-17"><a href="structural-equation-models.html#cb155-17" tabindex="-1"></a><span class="st">  Aposematism =~ Alkaloid.quantity + Alkaloid.diversity + Conspicuous.coloration</span></span>
<span id="cb155-18"><a href="structural-equation-models.html#cb155-18" tabindex="-1"></a><span class="st">&#39;</span></span>
<span id="cb155-19"><a href="structural-equation-models.html#cb155-19" tabindex="-1"></a></span>
<span id="cb155-20"><a href="structural-equation-models.html#cb155-20" tabindex="-1"></a><span class="co"># Fit the model</span></span>
<span id="cb155-21"><a href="structural-equation-models.html#cb155-21" tabindex="-1"></a>santosFit1 <span class="ot">&lt;-</span> <span class="fu">sem</span>(santosCFA1, <span class="at">sample.cov =</span> santosCov, <span class="at">sample.nobs =</span> <span class="dv">21</span>)</span>
<span id="cb155-22"><a href="structural-equation-models.html#cb155-22" tabindex="-1"></a><span class="fu">summary</span>(santosFit1, <span class="at">standardized =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## lavaan 0.6-19 ended normally after 23 iterations
## 
##   Estimator                                         ML
##   Optimization method                           NLMINB
##   Number of model parameters                         6
## 
##   Number of observations                            21
## 
## Model Test User Model:
##                                                       
##   Test statistic                                 0.000
##   Degrees of freedom                                 0
## 
## Parameter Estimates:
## 
##   Standard errors                             Standard
##   Information                                 Expected
##   Information saturated (h1) model          Structured
## 
## Latent Variables:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##   Aposematism =~                                                        
##     Alkaloid.qntty    1.000                               0.571    0.585
##     Alkalod.dvrsty    1.316    0.714    1.842    0.065    0.751    0.769
##     Conspics.clrtn    1.111    0.572    1.943    0.052    0.634    0.650
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##    .Alkaloid.qntty    0.627    0.249    2.514    0.012    0.627    0.658
##    .Alkalod.dvrsty    0.388    0.298    1.305    0.192    0.388    0.408
##    .Conspics.clrtn    0.550    0.258    2.133    0.033    0.550    0.578
##     Aposematism       0.326    0.272    1.199    0.230    1.000    1.000</code></pre>
<p>Why Use Latent Variables?</p>
<pre><code>â¢   Increase accuracy by pooling information across multiple imperfect indicators.
â¢   Reduce measurement error.
â¢   Enable modeling of unobservable constructs.</code></pre>
<p>Identification Rules (How to Know Your Model Can Be Estimated):</p>
<pre><code>1.  T-Rule: Number of estimated parameters â¤ number of unique elements in the covariance matrix.
2.  Three-indicator rule: Each latent variable has â¥ 3 uncorrelated indicators â SUFFICIENT.
3.  Two-indicator rule: Works for multiple latent variables if indicators donât share variance â SUFFICIENT.
4.  Fixing scale:

â¢   Set variance of latent = 1.0, or
â¢   Set one loading to 1.0 to put latent on that indicatorâs scale.</code></pre>
<p>Models with 2 indicators and shared error may be underidentified.</p>
<p>Fit a Second Latent Variable: Body Size</p>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="structural-equation-models.html#cb159-1" tabindex="-1"></a><span class="co">#santosSize &lt;- &#39;</span></span>
<span id="cb159-2"><a href="structural-equation-models.html#cb159-2" tabindex="-1"></a><span class="co">#  Size =~ Log.Mass + Log.RMR + Log.Scope</span></span>
<span id="cb159-3"><a href="structural-equation-models.html#cb159-3" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb159-4"><a href="structural-equation-models.html#cb159-4" tabindex="-1"></a></span>
<span id="cb159-5"><a href="structural-equation-models.html#cb159-5" tabindex="-1"></a><span class="co">#santosSizeFit &lt;- sem(santosSize, sample.cov = santosCov, sample.nobs = 21)</span></span>
<span id="cb159-6"><a href="structural-equation-models.html#cb159-6" tabindex="-1"></a><span class="co">#summary(santosSizeFit, standardized = TRUE)</span></span></code></pre></div>
<p>Combine Latent Variables</p>
<p>You can model multiple latent variables and test how they relate to each other.</p>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="structural-equation-models.html#cb160-1" tabindex="-1"></a><span class="co">#santosCFA2 &lt;- &#39;</span></span>
<span id="cb160-2"><a href="structural-equation-models.html#cb160-2" tabindex="-1"></a><span class="co">#  Aposematism =~ Alkaloid.quantity + Alkaloid.diversity + Conspicuous.coloration + #Ant.Mite.Specialization + log.Prey</span></span>
<span id="cb160-3"><a href="structural-equation-models.html#cb160-3" tabindex="-1"></a><span class="co">#  Scale =~ Log.Mass + Log.RMR + Log.Scope + Conspicuous.coloration</span></span>
<span id="cb160-4"><a href="structural-equation-models.html#cb160-4" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb160-5"><a href="structural-equation-models.html#cb160-5" tabindex="-1"></a></span>
<span id="cb160-6"><a href="structural-equation-models.html#cb160-6" tabindex="-1"></a><span class="co">#santosFit2 &lt;- sem(santosCFA2, sample.cov = santosCov, sample.nobs = 21)</span></span>
<span id="cb160-7"><a href="structural-equation-models.html#cb160-7" tabindex="-1"></a><span class="co">#summary(santosFit2, standardized = TRUE)</span></span></code></pre></div>
<p>Summary:</p>
<pre><code>â¢   Latent variables allow you to estimate unobservable concepts.
â¢   CFA is the method used to define latent variables in SEM.
â¢   Identification is criticalâuse the rules to check if your model can be estimated.
â¢   Measurement error is reduced by leveraging multiple indicators.</code></pre>
</div>
<div id="chapter-10-latent-responses-and-measurement-error" class="section level3 hasAnchor" number="2.7.4">
<h3><span class="header-section-number">2.7.4</span> Chapter 10: Latent Responses and Measurement Error<a href="structural-equation-models.html#chapter-10-latent-responses-and-measurement-error" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="structural-equation-models.html#cb162-1" tabindex="-1"></a><span class="fu">library</span>(lavaan)</span>
<span id="cb162-2"><a href="structural-equation-models.html#cb162-2" tabindex="-1"></a><span class="fu">library</span>(semPlot)</span></code></pre></div>
<p>Overview</p>
<p>In this section, we explore how latent variables can be modeled as responses and how to account for measurement error in observed indicators.</p>
<p>Latent variables are constructs that cannot be measured directly (e.g., biodiversity, ecosystem health, intelligence), but are inferred from multiple observed indicators.</p>
<p>Key Concepts</p>
<p>Latent Variables as Responses</p>
<p>Latent variables can be endogenous (influenced by other variables in the model). For instance:</p>
<pre><code>â¢   A latent construct such as âHabitat Qualityâ could be influenced by soil moisture, disturbance, and vegetation cover.
â¢   Each latent construct is defined by observed indicators, which are imperfect and contain measurement error.</code></pre>
<p>Measurement Error</p>
<p>SEM is powerful because it separates true score variance from error variance. Each observed variable has two components:
â¢ The true score linked to the latent construct.
â¢ The error term (random noise or instrument error).</p>
<p>Accounting for measurement error prevents biased parameter estimates and inflated correlations.</p>
<p>Example: Latent Response Model with Measurement Error</p>
<p>We model a latent response Performance, influenced by an observed predictor Treatment, and measured via three indicators: perf1, perf2, perf3.</p>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="structural-equation-models.html#cb164-1" tabindex="-1"></a><span class="co"># Define the SEM</span></span>
<span id="cb164-2"><a href="structural-equation-models.html#cb164-2" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="st">&#39;</span></span>
<span id="cb164-3"><a href="structural-equation-models.html#cb164-3" tabindex="-1"></a><span class="st">  # Measurement model</span></span>
<span id="cb164-4"><a href="structural-equation-models.html#cb164-4" tabindex="-1"></a><span class="st">  Performance =~ perf1 + perf2 + perf3</span></span>
<span id="cb164-5"><a href="structural-equation-models.html#cb164-5" tabindex="-1"></a></span>
<span id="cb164-6"><a href="structural-equation-models.html#cb164-6" tabindex="-1"></a><span class="st">  # Structural model</span></span>
<span id="cb164-7"><a href="structural-equation-models.html#cb164-7" tabindex="-1"></a><span class="st">  Performance ~ Treatment</span></span>
<span id="cb164-8"><a href="structural-equation-models.html#cb164-8" tabindex="-1"></a><span class="st">&#39;</span></span>
<span id="cb164-9"><a href="structural-equation-models.html#cb164-9" tabindex="-1"></a></span>
<span id="cb164-10"><a href="structural-equation-models.html#cb164-10" tabindex="-1"></a><span class="co"># Simulate data</span></span>
<span id="cb164-11"><a href="structural-equation-models.html#cb164-11" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb164-12"><a href="structural-equation-models.html#cb164-12" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">200</span></span>
<span id="cb164-13"><a href="structural-equation-models.html#cb164-13" tabindex="-1"></a>Treatment <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb164-14"><a href="structural-equation-models.html#cb164-14" tabindex="-1"></a>perf1 <span class="ot">&lt;-</span> <span class="fl">0.6</span><span class="sc">*</span>Treatment <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb164-15"><a href="structural-equation-models.html#cb164-15" tabindex="-1"></a>perf2 <span class="ot">&lt;-</span> <span class="fl">0.6</span><span class="sc">*</span>Treatment <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb164-16"><a href="structural-equation-models.html#cb164-16" tabindex="-1"></a>perf3 <span class="ot">&lt;-</span> <span class="fl">0.6</span><span class="sc">*</span>Treatment <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb164-17"><a href="structural-equation-models.html#cb164-17" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(Treatment, perf1, perf2, perf3)</span>
<span id="cb164-18"><a href="structural-equation-models.html#cb164-18" tabindex="-1"></a></span>
<span id="cb164-19"><a href="structural-equation-models.html#cb164-19" tabindex="-1"></a><span class="co"># Fit the SEM</span></span>
<span id="cb164-20"><a href="structural-equation-models.html#cb164-20" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">sem</span>(model, <span class="at">data =</span> data)</span>
<span id="cb164-21"><a href="structural-equation-models.html#cb164-21" tabindex="-1"></a><span class="fu">summary</span>(fit, <span class="at">standardized =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## lavaan 0.6-19 ended normally after 22 iterations
## 
##   Estimator                                         ML
##   Optimization method                           NLMINB
##   Number of model parameters                         7
## 
##   Number of observations                           200
## 
## Model Test User Model:
##                                                       
##   Test statistic                                 1.871
##   Degrees of freedom                                 2
##   P-value (Chi-square)                           0.392
## 
## Parameter Estimates:
## 
##   Standard errors                             Standard
##   Information                                 Expected
##   Information saturated (h1) model          Structured
## 
## Latent Variables:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##   Performance =~                                                        
##     perf1             1.000                               0.552    0.489
##     perf2             0.995    0.180    5.522    0.000    0.549    0.499
##     perf3             0.968    0.183    5.288    0.000    0.535    0.467
## 
## Regressions:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##   Performance ~                                                         
##     Treatment         0.570    0.075    7.642    0.000    1.032    0.971
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##    .perf1             0.969    0.106    9.135    0.000    0.969    0.761
##    .perf2             0.910    0.100    9.058    0.000    0.910    0.751
##    .perf3             1.024    0.110    9.289    0.000    1.024    0.782
##    .Performance       0.017    0.042    0.410    0.682    0.056    0.056</code></pre>
<p>Visualizing the SEM</p>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="structural-equation-models.html#cb166-1" tabindex="-1"></a><span class="fu">semPaths</span>(fit, <span class="st">&quot;std&quot;</span>, <span class="at">layout =</span> <span class="st">&quot;tree&quot;</span>, <span class="at">whatLabels =</span> <span class="st">&quot;std&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-61-1.png" width="672" /></p>
<p>Why Model Latent Responses?</p>
<pre><code>â¢   More reliable constructs by combining multiple indicators.
â¢   Reduces noise from any single observed variable.
â¢   Better reflects theoretical constructs (e.g., stress, biodiversity).</code></pre>
<p>Key Assumptions</p>
<pre><code>â¢   Indicators are unidimensional (reflect one latent factor).
â¢   Measurement errors are uncorrelated.
â¢   Sufficient variation and correlation among indicators.</code></pre>
<p>Takeaway</p>
<p>Modeling latent responses allows you to capture complex, unobserved constructs while accounting for error in measurements. SEM enables estimation of both the relationships among constructs and their measurement structure.</p>
</div>
<div id="chapter-11-local-estimation-and-d-separation" class="section level3 hasAnchor" number="2.7.5">
<h3><span class="header-section-number">2.7.5</span> Chapter 11: Local Estimation and D-Separation<a href="structural-equation-models.html#chapter-11-local-estimation-and-d-separation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Overview</p>
<p>This chapter introduces local (piecewise) SEM â an approach that decomposes a full SEM into a series of local linear models. It contrasts with global covariance-based SEM in both assumptions and evaluation.</p>
<p>Why Use Piecewise SEM?</p>
<p>Covariance SEM Piecewise SEM
Requires multivariate normality Robust to non-normal data
Models all paths simultaneously Fits multiple linear models separately
Fit assessed globally (ÏÂ², RMSEA) Fit assessed via D-separation tests
Difficult with small N More flexible with limited sample size</p>
<p>Example: Breaking SEM Into Local Regressions</p>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="structural-equation-models.html#cb169-1" tabindex="-1"></a><span class="fu">library</span>(piecewiseSEM)</span>
<span id="cb169-2"><a href="structural-equation-models.html#cb169-2" tabindex="-1"></a></span>
<span id="cb169-3"><a href="structural-equation-models.html#cb169-3" tabindex="-1"></a><span class="co"># Now check if the functions are available</span></span>
<span id="cb169-4"><a href="structural-equation-models.html#cb169-4" tabindex="-1"></a><span class="fu">ls</span>(<span class="st">&quot;package:piecewiseSEM&quot;</span>)</span></code></pre></div>
<pre><code>##  [1] &quot;%~~%&quot;            &quot;AIC_psem&quot;        &quot;as.psem&quot;         &quot;basisSet&quot;        &quot;cerror&quot;          &quot;coefs&quot;          
##  [7] &quot;dSep&quot;            &quot;evaluateClasses&quot; &quot;fisherC&quot;         &quot;getCoefficients&quot; &quot;getDAG&quot;          &quot;getSortedPsem&quot;  
## [13] &quot;keeley&quot;          &quot;LLchisq&quot;         &quot;meadows&quot;         &quot;multigroup&quot;      &quot;partialCorr&quot;     &quot;partialResid&quot;   
## [19] &quot;psem&quot;            &quot;rsquared&quot;        &quot;shipley&quot;         &quot;stdCoefs&quot;        &quot;unstdCoefs&quot;</code></pre>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="structural-equation-models.html#cb171-1" tabindex="-1"></a><span class="co"># Simulate data</span></span>
<span id="cb171-2"><a href="structural-equation-models.html#cb171-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb171-3"><a href="structural-equation-models.html#cb171-3" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb171-4"><a href="structural-equation-models.html#cb171-4" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb171-5"><a href="structural-equation-models.html#cb171-5" tabindex="-1"></a>y2 <span class="ot">&lt;-</span> <span class="fl">0.5</span> <span class="sc">*</span> x <span class="sc">+</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb171-6"><a href="structural-equation-models.html#cb171-6" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> <span class="fl">0.6</span> <span class="sc">*</span> x <span class="sc">+</span> <span class="fl">0.4</span> <span class="sc">*</span> y2 <span class="sc">+</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb171-7"><a href="structural-equation-models.html#cb171-7" tabindex="-1"></a>example_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x, y1, y2)</span>
<span id="cb171-8"><a href="structural-equation-models.html#cb171-8" tabindex="-1"></a></span>
<span id="cb171-9"><a href="structural-equation-models.html#cb171-9" tabindex="-1"></a><span class="co"># Fit piecewise SEM</span></span>
<span id="cb171-10"><a href="structural-equation-models.html#cb171-10" tabindex="-1"></a>mod_list <span class="ot">&lt;-</span> <span class="fu">psem</span>(</span>
<span id="cb171-11"><a href="structural-equation-models.html#cb171-11" tabindex="-1"></a>  <span class="fu">lm</span>(y2 <span class="sc">~</span> x, <span class="at">data =</span> example_data),</span>
<span id="cb171-12"><a href="structural-equation-models.html#cb171-12" tabindex="-1"></a>  <span class="fu">lm</span>(y1 <span class="sc">~</span> x <span class="sc">+</span> y2, <span class="at">data =</span> example_data)</span>
<span id="cb171-13"><a href="structural-equation-models.html#cb171-13" tabindex="-1"></a>)</span>
<span id="cb171-14"><a href="structural-equation-models.html#cb171-14" tabindex="-1"></a></span>
<span id="cb171-15"><a href="structural-equation-models.html#cb171-15" tabindex="-1"></a><span class="co"># Test model fit using Fisher&#39;s C</span></span>
<span id="cb171-16"><a href="structural-equation-models.html#cb171-16" tabindex="-1"></a><span class="fu">fisherC</span>(mod_list)</span></code></pre></div>
<pre><code>##   Fisher.C df P.Value
## 1       NA  0      NA</code></pre>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="structural-equation-models.html#cb173-1" tabindex="-1"></a><span class="co"># Extract standardized coefficients</span></span>
<span id="cb173-2"><a href="structural-equation-models.html#cb173-2" tabindex="-1"></a><span class="fu">stdCoefs</span>(mod_list)</span></code></pre></div>
<pre><code>##   Response Predictor  Estimate  Std.Error DF Crit.Value      P.Value Std.Estimate sig
## 1       y2         x 0.4475284 0.10687862 98   4.187258 6.172903e-05    0.3895619 ***
## 2       y1         x 0.4549228 0.11372501 97   4.000200 1.236720e-04    0.3509054 ***
## 3       y1        y2 0.4238113 0.09899469 97   4.281152 4.371472e-05    0.3755510 ***</code></pre>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="structural-equation-models.html#cb175-1" tabindex="-1"></a>dag <span class="ot">&lt;-</span> <span class="fu">getDAG</span>(mod_list)</span>
<span id="cb175-2"><a href="structural-equation-models.html#cb175-2" tabindex="-1"></a><span class="fu">plot</span>(dag)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-62-1.png" width="672" /></p>
<p>Directed Separation (D-sep)</p>
<p>D-sep tests whether missing paths in your model are truly unnecessary. It evaluates conditional independence assumptions implied by the model.</p>
<p>Understanding D-separation
â¢ Two variables are D-separated if they are conditionally independent, given a set of other variables.
â¢ D-sep claims are testable and form the basis set of the model.</p>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="structural-equation-models.html#cb176-1" tabindex="-1"></a><span class="co"># Define DAG</span></span>
<span id="cb176-2"><a href="structural-equation-models.html#cb176-2" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">dagitty</span>(<span class="st">&quot;dag {</span></span>
<span id="cb176-3"><a href="structural-equation-models.html#cb176-3" tabindex="-1"></a><span class="st">  x -&gt; y2 -&gt; y1</span></span>
<span id="cb176-4"><a href="structural-equation-models.html#cb176-4" tabindex="-1"></a><span class="st">  x -&gt; y1</span></span>
<span id="cb176-5"><a href="structural-equation-models.html#cb176-5" tabindex="-1"></a><span class="st">}&quot;</span>)</span>
<span id="cb176-6"><a href="structural-equation-models.html#cb176-6" tabindex="-1"></a></span>
<span id="cb176-7"><a href="structural-equation-models.html#cb176-7" tabindex="-1"></a><span class="co"># View conditional independencies implied by the DAG</span></span>
<span id="cb176-8"><a href="structural-equation-models.html#cb176-8" tabindex="-1"></a><span class="fu">impliedConditionalIndependencies</span>(g)</span></code></pre></div>
<p>Model Fit via Fisherâs C</p>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="structural-equation-models.html#cb177-1" tabindex="-1"></a><span class="fu">library</span>(piecewiseSEM)</span>
<span id="cb177-2"><a href="structural-equation-models.html#cb177-2" tabindex="-1"></a></span>
<span id="cb177-3"><a href="structural-equation-models.html#cb177-3" tabindex="-1"></a><span class="co"># Simulate example data</span></span>
<span id="cb177-4"><a href="structural-equation-models.html#cb177-4" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb177-5"><a href="structural-equation-models.html#cb177-5" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb177-6"><a href="structural-equation-models.html#cb177-6" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb177-7"><a href="structural-equation-models.html#cb177-7" tabindex="-1"></a>y2 <span class="ot">&lt;-</span> <span class="fl">0.5</span> <span class="sc">*</span> x <span class="sc">+</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb177-8"><a href="structural-equation-models.html#cb177-8" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> <span class="fl">0.6</span> <span class="sc">*</span> x <span class="sc">+</span> <span class="fl">0.4</span> <span class="sc">*</span> y2 <span class="sc">+</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb177-9"><a href="structural-equation-models.html#cb177-9" tabindex="-1"></a>example_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x, y1, y2)</span>
<span id="cb177-10"><a href="structural-equation-models.html#cb177-10" tabindex="-1"></a></span>
<span id="cb177-11"><a href="structural-equation-models.html#cb177-11" tabindex="-1"></a><span class="co"># Fit piecewise SEM</span></span>
<span id="cb177-12"><a href="structural-equation-models.html#cb177-12" tabindex="-1"></a>mod_list <span class="ot">&lt;-</span> <span class="fu">psem</span>(</span>
<span id="cb177-13"><a href="structural-equation-models.html#cb177-13" tabindex="-1"></a>  <span class="fu">lm</span>(y2 <span class="sc">~</span> x, <span class="at">data =</span> example_data),</span>
<span id="cb177-14"><a href="structural-equation-models.html#cb177-14" tabindex="-1"></a>  <span class="fu">lm</span>(y1 <span class="sc">~</span> x <span class="sc">+</span> y2, <span class="at">data =</span> example_data)</span>
<span id="cb177-15"><a href="structural-equation-models.html#cb177-15" tabindex="-1"></a>)</span>
<span id="cb177-16"><a href="structural-equation-models.html#cb177-16" tabindex="-1"></a></span>
<span id="cb177-17"><a href="structural-equation-models.html#cb177-17" tabindex="-1"></a><span class="co"># â Get model fit statistics (replaces sem.fit)</span></span>
<span id="cb177-18"><a href="structural-equation-models.html#cb177-18" tabindex="-1"></a><span class="fu">fisherC</span>(mod_list)</span></code></pre></div>
<pre><code>##   Fisher.C df P.Value
## 1       NA  0      NA</code></pre>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="structural-equation-models.html#cb179-1" tabindex="-1"></a><span class="co"># â Get standardized path coefficients (replaces sem.coefs)</span></span>
<span id="cb179-2"><a href="structural-equation-models.html#cb179-2" tabindex="-1"></a><span class="fu">stdCoefs</span>(mod_list)</span></code></pre></div>
<pre><code>##   Response Predictor  Estimate  Std.Error DF Crit.Value      P.Value Std.Estimate sig
## 1       y2         x 0.4475284 0.10687862 98   4.187258 6.172903e-05    0.3895619 ***
## 2       y1         x 0.4549228 0.11372501 97   4.000200 1.236720e-04    0.3509054 ***
## 3       y1        y2 0.4238113 0.09899469 97   4.281152 4.371472e-05    0.3755510 ***</code></pre>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="structural-equation-models.html#cb181-1" tabindex="-1"></a><span class="co"># â Optional: View DAG</span></span>
<span id="cb181-2"><a href="structural-equation-models.html#cb181-2" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">getDAG</span>(mod_list))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-64-1.png" width="672" /></p>
<p>Interpretation:</p>
<pre><code>â¢   p &gt; 0.05 â model is not rejected, D-sep claims hold.
â¢   p &lt; 0.05 â model is rejected, missing paths may be important.</code></pre>
<p>Summary:</p>
<pre><code>â¢   Piecewise SEM is ideal when:
â¢   Data violate global SEM assumptions.
â¢   Sample size is too small for global SEM.
â¢   You want to understand model fit using D-sep logic.
â¢   Use dagitty to derive implied independencies.
â¢   Use sem.fit() and sem.coefs() for piecewise evaluation.</code></pre>
</div>
<div id="chapter-12-introduction-to-piecewise-sem-in-r" class="section level3 hasAnchor" number="2.7.6">
<h3><span class="header-section-number">2.7.6</span> Chapter 12: Introduction to Piecewise SEM in R<a href="structural-equation-models.html#chapter-12-introduction-to-piecewise-sem-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Learning Objectives</p>
<p>By the end of this tutorial, you will be able to:</p>
<pre><code>â¢   Understand how piecewise SEM differs from traditional covariance-based SEM.
â¢   Fit a multi-equation SEM using the psem() function.
â¢   Evaluate model fit using d-separation tests and Fisherâs C statistic.
â¢   Extract path coefficients and RÂ² values.
â¢   Visualize model structure and relationships using visreg, DiagrammeR, or plot().</code></pre>
</div>
</div>
<div id="part-1-what-is-piecewise-sem" class="section level2 hasAnchor" number="2.8">
<h2><span class="header-section-number">2.8</span> Part 1: What is Piecewise SEM?<a href="structural-equation-models.html#part-1-what-is-piecewise-sem" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Piecewise SEM uses a local estimation approach: each equation is estimated separately using standard regression (e.g., lm, lmer). This provides greater flexibility, such as:</p>
<pre><code>â¢   Including non-normal or mixed-effect models.
â¢   Dealing with small sample sizes or nested structures.
â¢   Assessing model fit through d-sep tests (Shipleyâs test of directed separation).</code></pre>
<p>Limitations:</p>
<pre><code>â¢   Canât handle latent variables.
â¢   Not suitable for cyclical feedback loops.
â¢   Difficult to interpret in overidentified models with correlated errors.</code></pre>
<p>Part 2: Load Packages and Data</p>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="structural-equation-models.html#cb187-1" tabindex="-1"></a><span class="co"># Load libraries</span></span>
<span id="cb187-2"><a href="structural-equation-models.html#cb187-2" tabindex="-1"></a><span class="fu">library</span>(piecewiseSEM)</span>
<span id="cb187-3"><a href="structural-equation-models.html#cb187-3" tabindex="-1"></a><span class="fu">library</span>(visreg)</span>
<span id="cb187-4"><a href="structural-equation-models.html#cb187-4" tabindex="-1"></a><span class="fu">library</span>(DiagrammeR)</span>
<span id="cb187-5"><a href="structural-equation-models.html#cb187-5" tabindex="-1"></a></span>
<span id="cb187-6"><a href="structural-equation-models.html#cb187-6" tabindex="-1"></a><span class="co"># Load sample data (or use your own)</span></span>
<span id="cb187-7"><a href="structural-equation-models.html#cb187-7" tabindex="-1"></a><span class="fu">data</span>(keeley)  <span class="co"># from piecewiseSEM</span></span></code></pre></div>
<p>Part 3: Specify and Fit Your Model</p>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="structural-equation-models.html#cb188-1" tabindex="-1"></a><span class="co"># Fit individual models</span></span>
<span id="cb188-2"><a href="structural-equation-models.html#cb188-2" tabindex="-1"></a>mod1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(abiotic <span class="sc">~</span> distance, <span class="at">data =</span> keeley)</span>
<span id="cb188-3"><a href="structural-equation-models.html#cb188-3" tabindex="-1"></a>mod2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(hetero <span class="sc">~</span> distance, <span class="at">data =</span> keeley)</span>
<span id="cb188-4"><a href="structural-equation-models.html#cb188-4" tabindex="-1"></a>mod3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(rich <span class="sc">~</span> abiotic <span class="sc">+</span> hetero, <span class="at">data =</span> keeley)</span>
<span id="cb188-5"><a href="structural-equation-models.html#cb188-5" tabindex="-1"></a></span>
<span id="cb188-6"><a href="structural-equation-models.html#cb188-6" tabindex="-1"></a><span class="co"># Combine into a psem object</span></span>
<span id="cb188-7"><a href="structural-equation-models.html#cb188-7" tabindex="-1"></a>keeley_sem <span class="ot">&lt;-</span> <span class="fu">psem</span>(mod1, mod2, mod3)</span></code></pre></div>
<p>Evaluate Model Fit</p>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="structural-equation-models.html#cb189-1" tabindex="-1"></a><span class="co"># Directed separation test</span></span>
<span id="cb189-2"><a href="structural-equation-models.html#cb189-2" tabindex="-1"></a><span class="co">#dSep(keeley_sem)</span></span>
<span id="cb189-3"><a href="structural-equation-models.html#cb189-3" tabindex="-1"></a></span>
<span id="cb189-4"><a href="structural-equation-models.html#cb189-4" tabindex="-1"></a><span class="co"># Fisher&#39;s C statistic</span></span>
<span id="cb189-5"><a href="structural-equation-models.html#cb189-5" tabindex="-1"></a><span class="co">#fisherC(keeley_sem)</span></span></code></pre></div>
<p>Interpret:</p>
<pre><code>â¢   A non-significant p-value (&gt; 0.05) = model fits.
â¢   Significant missing paths â consider adding them and reassessing fit.</code></pre>
<p>Part 5: Summarize Coefficients and RÂ²</p>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="structural-equation-models.html#cb191-1" tabindex="-1"></a><span class="co"># Coefficients</span></span>
<span id="cb191-2"><a href="structural-equation-models.html#cb191-2" tabindex="-1"></a><span class="fu">coefs</span>(keeley_sem)</span></code></pre></div>
<pre><code>##   Response Predictor Estimate Std.Error DF Crit.Value P.Value Std.Estimate    
## 1  abiotic  distance   0.3998    0.0823 88     4.8562   0e+00       0.4597 ***
## 2   hetero  distance   0.0045    0.0013 88     3.4593   8e-04       0.3460 ***
## 3     rich   abiotic   0.8136    0.1746 87     4.6586   0e+00       0.4136 ***
## 4     rich    hetero  45.0702   11.6797 87     3.8589   2e-04       0.3426 ***</code></pre>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="structural-equation-models.html#cb193-1" tabindex="-1"></a><span class="co"># R-squared values</span></span>
<span id="cb193-2"><a href="structural-equation-models.html#cb193-2" tabindex="-1"></a><span class="fu">rsquared</span>(keeley_sem)</span></code></pre></div>
<pre><code>##   Response   family     link method R.squared
## 1  abiotic gaussian identity   none 0.2113455
## 2   hetero gaussian identity   none 0.1197074
## 3     rich gaussian identity   none 0.3667967</code></pre>
<p>Part 6: Plot Your Model</p>
<p>Option A: Quick Base R Plot</p>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb195-1"><a href="structural-equation-models.html#cb195-1" tabindex="-1"></a>keeley_sem <span class="ot">&lt;-</span> <span class="fu">psem</span>(</span>
<span id="cb195-2"><a href="structural-equation-models.html#cb195-2" tabindex="-1"></a>  <span class="fu">lm</span>(firesev <span class="sc">~</span> age <span class="sc">+</span> cover, <span class="at">data =</span> keeley),</span>
<span id="cb195-3"><a href="structural-equation-models.html#cb195-3" tabindex="-1"></a>  <span class="fu">lm</span>(cover <span class="sc">~</span> age <span class="sc">+</span> elev <span class="sc">+</span> firesev, <span class="at">data =</span> keeley),</span>
<span id="cb195-4"><a href="structural-equation-models.html#cb195-4" tabindex="-1"></a>  <span class="at">data =</span> keeley</span>
<span id="cb195-5"><a href="structural-equation-models.html#cb195-5" tabindex="-1"></a>)</span>
<span id="cb195-6"><a href="structural-equation-models.html#cb195-6" tabindex="-1"></a></span>
<span id="cb195-7"><a href="structural-equation-models.html#cb195-7" tabindex="-1"></a><span class="fu">plot</span>(keeley_sem)</span></code></pre></div>
<div class="grViz html-widget html-fill-item" id="htmlwidget-d9477e2807b8c833e042" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-d9477e2807b8c833e042">{"x":{"diagram":"digraph {\n\ngraph [layout = \"neato\",\n       outputorder = \"edgesfirst\",\n       bgcolor = \"white\"]\n\nnode [fontname = \"Helvetica\",\n      fontsize = \"10\",\n      shape = \"circle\",\n      fixedsize = \"true\",\n      width = \"0.5\",\n      style = \"filled\",\n      fillcolor = \"aliceblue\",\n      color = \"gray70\",\n      fontcolor = \"gray50\"]\n\nedge [fontname = \"Helvetica\",\n     fontsize = \"8\",\n     len = \"1.5\",\n     color = \"gray80\",\n     arrowsize = \"0.5\"]\n\n  \"1\" [label = \"firesev\", shape = \"rectangle\", color = \"black\", fillcolor = \"#FFFFFF\", fontcolor = \"#000000\"] \n  \"2\" [label = \"cover\", shape = \"rectangle\", color = \"black\", fillcolor = \"#FFFFFF\", fontcolor = \"#000000\"] \n  \"3\" [label = \"age\", shape = \"rectangle\", color = \"black\", fillcolor = \"#FFFFFF\", fontcolor = \"#000000\"] \n  \"4\" [label = \"elev\", shape = \"rectangle\", color = \"black\", fillcolor = \"#FFFFFF\", fontcolor = \"#000000\"] \n\"3\"->\"1\" [style = \"solid\", color = \"black\", label = \" 0.343 \"] \n\"2\"->\"1\" [style = \"solid\", color = \"black\", label = \" -0.317 \"] \n\"3\"->\"2\" [style = \"solid\", color = \"black\", label = \" -0.229 \"] \n\"4\"->\"2\" [style = \"solid\", color = \"black\", label = \" 0.203 \"] \n\"1\"->\"2\" [style = \"solid\", color = \"black\", label = \" -0.31 \"] \n}","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="structural-equation-models.html#cb196-1" tabindex="-1"></a><span class="co">#Option B: Refined Graph with DiagrammeR</span></span>
<span id="cb196-2"><a href="structural-equation-models.html#cb196-2" tabindex="-1"></a></span>
<span id="cb196-3"><a href="structural-equation-models.html#cb196-3" tabindex="-1"></a><span class="co"># Optional customization</span></span>
<span id="cb196-4"><a href="structural-equation-models.html#cb196-4" tabindex="-1"></a><span class="fu">plot</span>(keeley_sem,</span>
<span id="cb196-5"><a href="structural-equation-models.html#cb196-5" tabindex="-1"></a>     <span class="at">node_attrs =</span> <span class="fu">list</span>(</span>
<span id="cb196-6"><a href="structural-equation-models.html#cb196-6" tabindex="-1"></a>       <span class="at">x =</span> <span class="fu">c</span>(<span class="fl">2.5</span>, <span class="fl">2.5</span>, <span class="dv">4</span>, <span class="dv">1</span>),</span>
<span id="cb196-7"><a href="structural-equation-models.html#cb196-7" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>),</span>
<span id="cb196-8"><a href="structural-equation-models.html#cb196-8" tabindex="-1"></a>       <span class="at">shape =</span> <span class="st">&quot;rectangle&quot;</span>,</span>
<span id="cb196-9"><a href="structural-equation-models.html#cb196-9" tabindex="-1"></a>       <span class="at">fillcolor =</span> <span class="st">&quot;white&quot;</span></span>
<span id="cb196-10"><a href="structural-equation-models.html#cb196-10" tabindex="-1"></a>     ))</span></code></pre></div>
<div class="grViz html-widget html-fill-item" id="htmlwidget-a70140c8f686cc1c13cd" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-a70140c8f686cc1c13cd">{"x":{"diagram":"digraph {\n\ngraph [layout = \"neato\",\n       outputorder = \"edgesfirst\",\n       bgcolor = \"white\"]\n\nnode [fontname = \"Helvetica\",\n      fontsize = \"10\",\n      shape = \"circle\",\n      fixedsize = \"true\",\n      width = \"0.5\",\n      style = \"filled\",\n      fillcolor = \"aliceblue\",\n      color = \"gray70\",\n      fontcolor = \"gray50\"]\n\nedge [fontname = \"Helvetica\",\n     fontsize = \"8\",\n     len = \"1.5\",\n     color = \"gray80\",\n     arrowsize = \"0.5\"]\n\n  \"1\" [label = \"firesev\", shape = \"rectangle\", fillcolor = \"#FFFFFF\", fontcolor = \"#000000\", pos = \"2.5,3!\"] \n  \"2\" [label = \"cover\", shape = \"rectangle\", fillcolor = \"#FFFFFF\", fontcolor = \"#000000\", pos = \"2.5,1!\"] \n  \"3\" [label = \"age\", shape = \"rectangle\", fillcolor = \"#FFFFFF\", fontcolor = \"#000000\", pos = \"4,2!\"] \n  \"4\" [label = \"elev\", shape = \"rectangle\", fillcolor = \"#FFFFFF\", fontcolor = \"#000000\", pos = \"1,2!\"] \n\"3\"->\"1\" [style = \"solid\", color = \"black\", label = \" 0.343 \"] \n\"2\"->\"1\" [style = \"solid\", color = \"black\", label = \" -0.317 \"] \n\"3\"->\"2\" [style = \"solid\", color = \"black\", label = \" -0.229 \"] \n\"4\"->\"2\" [style = \"solid\", color = \"black\", label = \" 0.203 \"] \n\"1\"->\"2\" [style = \"solid\", color = \"black\", label = \" -0.31 \"] \n}","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
<p>Part 7: Mediation Example</p>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb197-1"><a href="structural-equation-models.html#cb197-1" tabindex="-1"></a>mod_firesev  <span class="ot">&lt;-</span> <span class="fu">lm</span>(firesev <span class="sc">~</span> age, <span class="at">data =</span> keeley)</span>
<span id="cb197-2"><a href="structural-equation-models.html#cb197-2" tabindex="-1"></a>mod_cover    <span class="ot">&lt;-</span> <span class="fu">lm</span>(cover <span class="sc">~</span> firesev, <span class="at">data =</span> keeley)</span>
<span id="cb197-3"><a href="structural-equation-models.html#cb197-3" tabindex="-1"></a></span>
<span id="cb197-4"><a href="structural-equation-models.html#cb197-4" tabindex="-1"></a>firesev_model <span class="ot">&lt;-</span> <span class="fu">psem</span>(mod_firesev, mod_cover)</span>
<span id="cb197-5"><a href="structural-equation-models.html#cb197-5" tabindex="-1"></a></span>
<span id="cb197-6"><a href="structural-equation-models.html#cb197-6" tabindex="-1"></a><span class="fu">summary</span>(firesev_model)</span></code></pre></div>
<pre><code>##   |                                                                                                                 |                                                                                                         |   0%  |                                                                                                                 |=========================================================================================================| 100%</code></pre>
<pre><code>## 
## Structural Equation Model of firesev_model 
## 
## Call:
##   firesev ~ age
##   cover ~ firesev
## 
##     AIC
##  364.696
## 
## ---
## Tests of directed separation:
## 
##      Independ.Claim Test.Type DF Crit.Value P.Value 
##   cover ~ age + ...      coef 87    -1.8018   0.075 
## 
## --
## Global goodness-of-fit:
## 
## Chi-Squared = 3.297 with P-value = 0.069 and on 1 degrees of freedom
## Fisher&#39;s C = 5.18 with P-value = 0.075 and on 2 degrees of freedom
## 
## ---
## Coefficients:
## 
##   Response Predictor Estimate Std.Error DF Crit.Value P.Value Std.Estimate    
##    firesev       age   0.0597    0.0125 88     4.7781       0       0.4539 ***
##      cover   firesev  -0.0839    0.0184 88    -4.5594       0      -0.4371 ***
## 
##   Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05
## 
## ---
## Individual R-squared:
## 
##   Response method R.squared
##    firesev   none      0.21
##      cover   none      0.19</code></pre>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="structural-equation-models.html#cb200-1" tabindex="-1"></a><span class="fu">dSep</span>(firesev_model)</span></code></pre></div>
<pre><code>##   |                                                                                                                 |                                                                                                         |   0%  |                                                                                                                 |=========================================================================================================| 100%</code></pre>
<pre><code>##      Independ.Claim Test.Type DF Crit.Value    P.Value 
## 1 cover ~ age + ...      coef 87   -1.80184 0.07503437</code></pre>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="structural-equation-models.html#cb203-1" tabindex="-1"></a><span class="fu">rsquared</span>(firesev_model)</span></code></pre></div>
<pre><code>##   Response   family     link method R.squared
## 1  firesev gaussian identity   none 0.2059938
## 2    cover gaussian identity   none 0.1910867</code></pre>
<p>Bonus: Visualize with Covariates Held Constant</p>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="structural-equation-models.html#cb205-1" tabindex="-1"></a><span class="co"># Visualize fire severity&#39;s effect on cover</span></span>
<span id="cb205-2"><a href="structural-equation-models.html#cb205-2" tabindex="-1"></a><span class="fu">visreg</span>(firesev_model[[<span class="dv">2</span>]], <span class="at">xvar =</span> <span class="st">&quot;firesev&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-71-1.png" width="672" /></p>
<p>Wrap-Up</p>
<p>Piecewise SEM offers flexibility and clarity for causal inference in ecology. By evaluating each path independently while testing the full modelâs coherence through d-sep and Fisherâs C, you gain both transparency and statistical rigor.</p>
<div id="chapter-13-nonlinearity-and-interaction-in-sem" class="section level3 hasAnchor" number="2.8.1">
<h3><span class="header-section-number">2.8.1</span> Chapter 13: Nonlinearity and Interaction in SEM<a href="structural-equation-models.html#chapter-13-nonlinearity-and-interaction-in-sem" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Overview</p>
<p>In this tutorial, weâll cover:</p>
<pre><code>â¢   Nonlinearities (e.g., polynomial terms)
â¢   Centering variables to reduce multicollinearity
â¢   Interaction terms
â¢   Implementing these in SEM frameworks</code></pre>
<p>Example 1: Nonlinear Effects (Cardinale et al.Â 2009)</p>
<p>Load and Prepare Data</p>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="structural-equation-models.html#cb207-1" tabindex="-1"></a><span class="co"># Download data</span></span>
<span id="cb207-2"><a href="structural-equation-models.html#cb207-2" tabindex="-1"></a>url <span class="ot">&lt;-</span> <span class="st">&quot;https://drive.google.com/uc?export=download&amp;id=1oHBul4_JcqlPFZgYsH3WOIZJRQRw1O4F&quot;</span></span>
<span id="cb207-3"><a href="structural-equation-models.html#cb207-3" tabindex="-1"></a>cardinale <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(url)</span>
<span id="cb207-4"><a href="structural-equation-models.html#cb207-4" tabindex="-1"></a></span>
<span id="cb207-5"><a href="structural-equation-models.html#cb207-5" tabindex="-1"></a><span class="co"># Check it loaded</span></span>
<span id="cb207-6"><a href="structural-equation-models.html#cb207-6" tabindex="-1"></a><span class="fu">head</span>(cardinale)</span></code></pre></div>
<pre><code>##        Stream Well     N    Chl  SR SA
## 1 Adobe Creek    1 0e+00 0.0094 105 26
## 2 Adobe Creek    5 1e-06 0.0100 105 24
## 3 Adobe Creek    3 1e-04 0.0613 105 20
## 4 Adobe Creek    4 1e-02 0.1003 105 23
## 5 Adobe Creek    2 1e+00 0.2000 105 20
## 6 Adobe Creek    1 0e+00 0.0377 105 21</code></pre>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="structural-equation-models.html#cb209-1" tabindex="-1"></a><span class="co"># Log-transform variables</span></span>
<span id="cb209-2"><a href="structural-equation-models.html#cb209-2" tabindex="-1"></a>cardinale<span class="sc">$</span>logN <span class="ot">&lt;-</span> <span class="fu">log10</span>(cardinale<span class="sc">$</span>N <span class="sc">+</span> <span class="fl">1e-6</span>)</span>
<span id="cb209-3"><a href="structural-equation-models.html#cb209-3" tabindex="-1"></a>cardinale<span class="sc">$</span>logN2 <span class="ot">&lt;-</span> cardinale<span class="sc">$</span>logN<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb209-4"><a href="structural-equation-models.html#cb209-4" tabindex="-1"></a>cardinale<span class="sc">$</span>logChl <span class="ot">&lt;-</span> <span class="fu">log10</span>(cardinale<span class="sc">$</span>Chl)</span>
<span id="cb209-5"><a href="structural-equation-models.html#cb209-5" tabindex="-1"></a></span>
<span id="cb209-6"><a href="structural-equation-models.html#cb209-6" tabindex="-1"></a><span class="co">#Fit SEM with piecewiseSEM</span></span>
<span id="cb209-7"><a href="structural-equation-models.html#cb209-7" tabindex="-1"></a></span>
<span id="cb209-8"><a href="structural-equation-models.html#cb209-8" tabindex="-1"></a>model1 <span class="ot">&lt;-</span> <span class="fu">psem</span>(</span>
<span id="cb209-9"><a href="structural-equation-models.html#cb209-9" tabindex="-1"></a>  <span class="fu">lm</span>(SA <span class="sc">~</span> logN <span class="sc">+</span> logN2 <span class="sc">+</span> SR, <span class="at">data =</span> cardinale),</span>
<span id="cb209-10"><a href="structural-equation-models.html#cb209-10" tabindex="-1"></a>  <span class="fu">lm</span>(logChl <span class="sc">~</span> SA <span class="sc">+</span> logN <span class="sc">+</span> logN2, <span class="at">data =</span> cardinale),</span>
<span id="cb209-11"><a href="structural-equation-models.html#cb209-11" tabindex="-1"></a>  logN <span class="sc">%~~%</span> logN2,</span>
<span id="cb209-12"><a href="structural-equation-models.html#cb209-12" tabindex="-1"></a>  <span class="at">data =</span> cardinale</span>
<span id="cb209-13"><a href="structural-equation-models.html#cb209-13" tabindex="-1"></a>)</span>
<span id="cb209-14"><a href="structural-equation-models.html#cb209-14" tabindex="-1"></a></span>
<span id="cb209-15"><a href="structural-equation-models.html#cb209-15" tabindex="-1"></a><span class="fu">summary</span>(model1)</span></code></pre></div>
<pre><code>##   |                                                                                                                 |                                                                                                         |   0%  |                                                                                                                 |=========================================================================================================| 100%</code></pre>
<pre><code>## 
## Structural Equation Model of model1 
## 
## Call:
##   SA ~ logN + logN2 + SR
##   logChl ~ SA + logN + logN2
##   logN ~~ logN2
## 
##     AIC
##  1192.444
## 
## ---
## Tests of directed separation:
## 
##      Independ.Claim Test.Type  DF Crit.Value P.Value 
##   logChl ~ SR + ...      coef 122     0.6639   0.508 
## 
## --
## Global goodness-of-fit:
## 
## Chi-Squared = 0.458 with P-value = 0.499 and on 1 degrees of freedom
## Fisher&#39;s C = 1.355 with P-value = 0.508 and on 2 degrees of freedom
## 
## ---
## Coefficients:
## 
##   Response Predictor Estimate Std.Error  DF Crit.Value P.Value Std.Estimate    
##         SA      logN  -2.9944    1.5375 123    -1.9476  0.0537      -0.5044    
##         SA     logN2  -0.4742    0.2424 123    -1.9568  0.0526      -0.5067    
##         SA        SR   0.3838    0.0359 123    10.6844  0.0000       0.6893 ***
##     logChl        SA   0.0201     0.004 123     5.0327  0.0000       0.3946 ***
##     logChl      logN   0.1168    0.0953 123     1.2258  0.2226       0.3858    
##     logChl     logN2   0.0032     0.015 123     0.2108  0.8334       0.0664    
##     ~~logN   ~~logN2  -0.9685         - 125   -43.4652  0.0000      -0.9685 ***
## 
##   Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05
## 
## ---
## Individual R-squared:
## 
##   Response method R.squared
##         SA   none      0.49
##     logChl   none      0.25</code></pre>
<p>Reducing Collinearity via Centering</p>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb212-1"><a href="structural-equation-models.html#cb212-1" tabindex="-1"></a><span class="co"># Center predictors</span></span>
<span id="cb212-2"><a href="structural-equation-models.html#cb212-2" tabindex="-1"></a>cardinale<span class="sc">$</span>logN.cen <span class="ot">&lt;-</span> <span class="fu">scale</span>(cardinale<span class="sc">$</span>logN, <span class="at">scale =</span> <span class="cn">FALSE</span>)</span>
<span id="cb212-3"><a href="structural-equation-models.html#cb212-3" tabindex="-1"></a>cardinale<span class="sc">$</span>logN2.cen <span class="ot">&lt;-</span> cardinale<span class="sc">$</span>logN.cen<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb212-4"><a href="structural-equation-models.html#cb212-4" tabindex="-1"></a></span>
<span id="cb212-5"><a href="structural-equation-models.html#cb212-5" tabindex="-1"></a><span class="co"># Check correlation</span></span>
<span id="cb212-6"><a href="structural-equation-models.html#cb212-6" tabindex="-1"></a><span class="fu">cor</span>(cardinale<span class="sc">$</span>logN.cen, cardinale<span class="sc">$</span>logN2.cen)</span></code></pre></div>
<pre><code>##           [,1]
## [1,] 0.5126311</code></pre>
<p>Refit Model with Centered Predictors</p>
<div class="sourceCode" id="cb214"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb214-1"><a href="structural-equation-models.html#cb214-1" tabindex="-1"></a>model2 <span class="ot">&lt;-</span> <span class="fu">psem</span>(</span>
<span id="cb214-2"><a href="structural-equation-models.html#cb214-2" tabindex="-1"></a>  <span class="fu">lm</span>(SA <span class="sc">~</span> logN.cen <span class="sc">+</span> logN2.cen <span class="sc">+</span> SR, <span class="at">data =</span> cardinale),</span>
<span id="cb214-3"><a href="structural-equation-models.html#cb214-3" tabindex="-1"></a>  <span class="fu">lm</span>(logChl <span class="sc">~</span> SA <span class="sc">+</span> logN.cen <span class="sc">+</span> logN2.cen, <span class="at">data =</span> cardinale),</span>
<span id="cb214-4"><a href="structural-equation-models.html#cb214-4" tabindex="-1"></a>  logN.cen <span class="sc">%~~%</span> logN2.cen,</span>
<span id="cb214-5"><a href="structural-equation-models.html#cb214-5" tabindex="-1"></a>  <span class="at">data =</span> cardinale</span>
<span id="cb214-6"><a href="structural-equation-models.html#cb214-6" tabindex="-1"></a>)</span>
<span id="cb214-7"><a href="structural-equation-models.html#cb214-7" tabindex="-1"></a></span>
<span id="cb214-8"><a href="structural-equation-models.html#cb214-8" tabindex="-1"></a><span class="fu">summary</span>(model2)</span></code></pre></div>
<pre><code>##   |                                                                                                                 |                                                                                                         |   0%  |                                                                                                                 |=========================================================================================================| 100%</code></pre>
<pre><code>## 
## Structural Equation Model of model2 
## 
## Call:
##   SA ~ logN.cen + logN2.cen + SR
##   logChl ~ SA + logN.cen + logN2.cen
##   logN.cen ~~ logN2.cen
## 
##     AIC
##  1192.444
## 
## ---
## Tests of directed separation:
## 
##      Independ.Claim Test.Type  DF Crit.Value P.Value 
##   logChl ~ SR + ...      coef 122     0.6639   0.508 
## 
## --
## Global goodness-of-fit:
## 
## Chi-Squared = 0.458 with P-value = 0.499 and on 1 degrees of freedom
## Fisher&#39;s C = 1.355 with P-value = 0.508 and on 2 degrees of freedom
## 
## ---
## Coefficients:
## 
##     Response   Predictor Estimate Std.Error  DF Crit.Value P.Value Std.Estimate    
##           SA    logN.cen   0.3668     0.446 123     0.8223  0.4125       0.0618    
##           SA   logN2.cen  -0.4742    0.2424 123    -1.9568  0.0526      -0.1470    
##           SA          SR   0.3838    0.0359 123    10.6844  0.0000       0.6893 ***
##       logChl          SA   0.0201     0.004 123     5.0327  0.0000       0.3946 ***
##       logChl    logN.cen   0.0944    0.0275 123     3.4320  0.0008       0.3116 ***
##       logChl   logN2.cen   0.0032     0.015 123     0.2108  0.8334       0.0193    
##   ~~logN.cen ~~logN2.cen   0.5126         - 125     6.6752  0.0000       0.5126 ***
## 
##   Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05
## 
## ---
## Individual R-squared:
## 
##   Response method R.squared
##         SA   none      0.49
##     logChl   none      0.25</code></pre>
<p>Try lavaan for the Same Model</p>
<p>Example 2: Interaction Effects (Keeley et al.)</p>
<p>Center and Create Interaction</p>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb217-1"><a href="structural-equation-models.html#cb217-1" tabindex="-1"></a>url2 <span class="ot">&lt;-</span> <span class="st">&quot;https://drive.google.com/uc?export=download&amp;id=1YTsFP1T__Hn13hTvj9TVOK-wbGDxLd01&quot;</span></span>
<span id="cb217-2"><a href="structural-equation-models.html#cb217-2" tabindex="-1"></a></span>
<span id="cb217-3"><a href="structural-equation-models.html#cb217-3" tabindex="-1"></a><span class="co"># Try to read the CSV directly</span></span>
<span id="cb217-4"><a href="structural-equation-models.html#cb217-4" tabindex="-1"></a>keeley <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(url2)</span>
<span id="cb217-5"><a href="structural-equation-models.html#cb217-5" tabindex="-1"></a></span>
<span id="cb217-6"><a href="structural-equation-models.html#cb217-6" tabindex="-1"></a>keeley<span class="sc">$</span>age_cent <span class="ot">&lt;-</span> <span class="fu">scale</span>(keeley<span class="sc">$</span>age, <span class="at">scale =</span> <span class="cn">FALSE</span>)</span>
<span id="cb217-7"><a href="structural-equation-models.html#cb217-7" tabindex="-1"></a>keeley<span class="sc">$</span>fire_cent <span class="ot">&lt;-</span> <span class="fu">scale</span>(keeley<span class="sc">$</span>firesev, <span class="at">scale =</span> <span class="cn">FALSE</span>)</span>
<span id="cb217-8"><a href="structural-equation-models.html#cb217-8" tabindex="-1"></a>keeley<span class="sc">$</span>int_term <span class="ot">&lt;-</span> keeley<span class="sc">$</span>age_cent <span class="sc">*</span> keeley<span class="sc">$</span>fire_cent</span></code></pre></div>
<p>Fit SEM with Interaction in piecewiseSEM</p>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb218-1"><a href="structural-equation-models.html#cb218-1" tabindex="-1"></a>keeley_int <span class="ot">&lt;-</span> <span class="fu">psem</span>(</span>
<span id="cb218-2"><a href="structural-equation-models.html#cb218-2" tabindex="-1"></a>  <span class="fu">lm</span>(cover <span class="sc">~</span> age_cent <span class="sc">*</span> fire_cent, <span class="at">data =</span> keeley),</span>
<span id="cb218-3"><a href="structural-equation-models.html#cb218-3" tabindex="-1"></a>  <span class="fu">lm</span>(fire_cent <span class="sc">~</span> age_cent, <span class="at">data =</span> keeley),</span>
<span id="cb218-4"><a href="structural-equation-models.html#cb218-4" tabindex="-1"></a>  <span class="at">data =</span> keeley</span>
<span id="cb218-5"><a href="structural-equation-models.html#cb218-5" tabindex="-1"></a>)</span>
<span id="cb218-6"><a href="structural-equation-models.html#cb218-6" tabindex="-1"></a></span>
<span id="cb218-7"><a href="structural-equation-models.html#cb218-7" tabindex="-1"></a><span class="fu">summary</span>(keeley_int)</span></code></pre></div>
<pre><code>## 
## Structural Equation Model of keeley_int 
## 
## Call:
##   cover ~ age_cent * fire_cent
##   fire_cent ~ age_cent
## 
##     AIC
##  362.993
## 
## ---
## Tests of directed separation:
## 
##  No independence claims present. Tests of directed separation not possible.
## 
## --
## Global goodness-of-fit:
## 
## Chi-Squared = 0 with P-value = 1 and on 0 degrees of freedom
## Fisher&#39;s C = NA with P-value = NA and on 0 degrees of freedom
## 
## ---
## Coefficients:
## 
##    Response          Predictor Estimate Std.Error DF Crit.Value P.Value Std.Estimate    
##       cover           age_cent  -0.0050    0.0027 86    -1.8810  0.0634      -0.1985    
##       cover          fire_cent  -0.0684    0.0203 86    -3.3752  0.0011      -0.3561  **
##       cover age_cent:fire_cent  -0.0021    0.0014 86    -1.5263  0.1306      -0.1438    
##   fire_cent           age_cent   0.0597    0.0125 88     4.7781  0.0000       0.4539 ***
## 
##   Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05
## 
## ---
## Individual R-squared:
## 
##    Response method R.squared
##       cover   none      0.24
##   fire_cent   none      0.21</code></pre>
<p>Optional: Fit Interaction SEM with lavaan</p>
<p>Final Notes:</p>
<pre><code>â¢   Polynomial terms allow us to model curvature.
â¢   Centering reduces collinearity and changes interpretation.
â¢   Interaction terms help model conditional effects.
â¢   Both lavaan and piecewiseSEM support these techniques.</code></pre>
</div>
<div id="chapter-14-glms-with-sem-using-piecewisesem" class="section level3 hasAnchor" number="2.8.2">
<h3><span class="header-section-number">2.8.2</span> Chapter 14: GLMs with SEM using PiecewiseSEM<a href="structural-equation-models.html#chapter-14-glms-with-sem-using-piecewisesem" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This section integrates Generalized Linear Models (GLMs) into Structural Equation Modeling, especially using piecewiseSEM. It also introduces important adjustments for working with non-normal data, and compares latent theoretic (LT) and observed error (OE) approaches for standardizing coefficients.</p>
</div>
</div>
<div id="overview-1" class="section level2 hasAnchor" number="2.9">
<h2><span class="header-section-number">2.9</span> Overview<a href="structural-equation-models.html#overview-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In this tutorial, weâll:</p>
<pre><code>â¢   Learn how to incorporate GLMs into SEM using piecewiseSEM
â¢   Understand how to deal with non-normality and directed separation warnings
â¢   Compute standardized coefficients using both Latent Theoretic (LT) and Observed Error (OE) approaches</code></pre>
<p>Data from Anderson et al.Â 2010 Example</p>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb222-1"><a href="structural-equation-models.html#cb222-1" tabindex="-1"></a><span class="co"># Simulated structure to mimic Anderson et al.</span></span>
<span id="cb222-2"><a href="structural-equation-models.html#cb222-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb222-3"><a href="structural-equation-models.html#cb222-3" tabindex="-1"></a>anderson <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb222-4"><a href="structural-equation-models.html#cb222-4" tabindex="-1"></a>  <span class="at">biomass.kg =</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">mean =</span> <span class="dv">10</span>, <span class="at">sd =</span> <span class="dv">2</span>),</span>
<span id="cb222-5"><a href="structural-equation-models.html#cb222-5" tabindex="-1"></a>  <span class="at">leafN =</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">mean =</span> <span class="dv">3</span>, <span class="at">sd =</span> <span class="fl">0.5</span>),</span>
<span id="cb222-6"><a href="structural-equation-models.html#cb222-6" tabindex="-1"></a>  <span class="at">landscape =</span> <span class="fu">sample</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, <span class="dv">100</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb222-7"><a href="structural-equation-models.html#cb222-7" tabindex="-1"></a>  <span class="at">hotspotYN =</span> <span class="fu">rbinom</span>(<span class="dv">100</span>, <span class="dv">1</span>, <span class="fl">0.4</span>)</span>
<span id="cb222-8"><a href="structural-equation-models.html#cb222-8" tabindex="-1"></a>)</span></code></pre></div>
<p>Model: Using GLM in psem</p>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb223-1"><a href="structural-equation-models.html#cb223-1" tabindex="-1"></a><span class="fu">library</span>(piecewiseSEM)</span>
<span id="cb223-2"><a href="structural-equation-models.html#cb223-2" tabindex="-1"></a></span>
<span id="cb223-3"><a href="structural-equation-models.html#cb223-3" tabindex="-1"></a>anderson.sem <span class="ot">&lt;-</span> <span class="fu">psem</span>(</span>
<span id="cb223-4"><a href="structural-equation-models.html#cb223-4" tabindex="-1"></a>  <span class="fu">lm</span>(leafN <span class="sc">~</span> biomass.kg, <span class="at">data =</span> anderson),</span>
<span id="cb223-5"><a href="structural-equation-models.html#cb223-5" tabindex="-1"></a>  <span class="fu">glm</span>(hotspotYN <span class="sc">~</span> leafN <span class="sc">+</span> biomass.kg <span class="sc">+</span> landscape, <span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>, <span class="at">data =</span> anderson)</span>
<span id="cb223-6"><a href="structural-equation-models.html#cb223-6" tabindex="-1"></a>)</span>
<span id="cb223-7"><a href="structural-equation-models.html#cb223-7" tabindex="-1"></a></span>
<span id="cb223-8"><a href="structural-equation-models.html#cb223-8" tabindex="-1"></a><span class="fu">summary</span>(anderson.sem)</span></code></pre></div>
<pre><code>##   |                                                                                                                 |                                                                                                         |   0%  |                                                                                                                 |=========================================================================================================| 100%</code></pre>
<pre><code>## 
## Structural Equation Model of anderson.sem 
## 
## Call:
##   leafN ~ biomass.kg
##   hotspotYN ~ leafN + biomass.kg + landscape
## 
##     AIC
##  270.381
## 
## ---
## Tests of directed separation:
## 
##            Independ.Claim Test.Type DF Crit.Value P.Value 
##   leafN ~ landscape + ...      coef 97     1.1151  0.2676 
## 
## --
## Global goodness-of-fit:
## 
## Chi-Squared = 1.274 with P-value = 0.259 and on 1 degrees of freedom
## Fisher&#39;s C = 2.637 with P-value = 0.268 and on 2 degrees of freedom
## 
## ---
## Coefficients:
## 
##    Response  Predictor Estimate Std.Error DF Crit.Value P.Value Std.Estimate 
##       leafN biomass.kg   0.0068    0.0219 98     0.3098  0.7574       0.0313 
##   hotspotYN      leafN  -0.1212    0.4652 96    -0.2604  0.7945      -0.0301 
##   hotspotYN biomass.kg   0.0374    0.1005 96     0.3720  0.7099       0.0428 
##   hotspotYN  landscape  -0.1553    0.4181 96    -0.3715  0.7103      -0.0427 
## 
##   Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05
## 
## ---
## Individual R-squared:
## 
##    Response     method R.squared
##       leafN       none         0
##   hotspotYN nagelkerke         0</code></pre>
<p>Directed Separation &amp; Non-Normality</p>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb226-1"><a href="structural-equation-models.html#cb226-1" tabindex="-1"></a><span class="co"># Add the &#39;conserve = TRUE&#39; argument to be conservative in tests</span></span>
<span id="cb226-2"><a href="structural-equation-models.html#cb226-2" tabindex="-1"></a><span class="fu">summary</span>(anderson.sem, <span class="at">conserve =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>##   |                                                                                                                 |                                                                                                         |   0%  |                                                                                                                 |=========================================================================================================| 100%</code></pre>
<pre><code>## 
## Structural Equation Model of anderson.sem 
## 
## Call:
##   leafN ~ biomass.kg
##   hotspotYN ~ leafN + biomass.kg + landscape
## 
##     AIC
##  270.381
## 
## ---
## Tests of directed separation:
## 
##            Independ.Claim Test.Type DF Crit.Value P.Value 
##   leafN ~ landscape + ...      coef 97     1.1151  0.2676 
## 
## --
## Global goodness-of-fit:
## 
## Chi-Squared = 1.274 with P-value = 0.259 and on 1 degrees of freedom
## Fisher&#39;s C = 2.637 with P-value = 0.268 and on 2 degrees of freedom
## 
## ---
## Coefficients:
## 
##    Response  Predictor Estimate Std.Error DF Crit.Value P.Value Std.Estimate 
##       leafN biomass.kg   0.0068    0.0219 98     0.3098  0.7574       0.0313 
##   hotspotYN      leafN  -0.1212    0.4652 96    -0.2604  0.7945      -0.0301 
##   hotspotYN biomass.kg   0.0374    0.1005 96     0.3720  0.7099       0.0428 
##   hotspotYN  landscape  -0.1553    0.4181 96    -0.3715  0.7103      -0.0427 
## 
##   Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05
## 
## ---
## Individual R-squared:
## 
##    Response     method R.squared
##       leafN       none         0
##   hotspotYN nagelkerke         0</code></pre>
<p>If the model includes non-normal endogenous variables (e.g., binary hotspotYN), the direction of independence tests matters. Use:</p>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb229-1"><a href="structural-equation-models.html#cb229-1" tabindex="-1"></a><span class="fu">dSep</span>(anderson.sem, <span class="at">direction =</span> <span class="fu">c</span>(<span class="st">&quot;hotspotYN &lt;- leafN&quot;</span>))</span></code></pre></div>
<pre><code>##   |                                                                                                                 |                                                                                                         |   0%  |                                                                                                                 |=========================================================================================================| 100%</code></pre>
<pre><code>##            Independ.Claim Test.Type DF Crit.Value   P.Value 
## 1 leafN ~ landscape + ...      coef 97   1.115091 0.2675663</code></pre>
<p>Or specify a correlated error structure:</p>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb232-1"><a href="structural-equation-models.html#cb232-1" tabindex="-1"></a>anderson.sem2 <span class="ot">&lt;-</span> <span class="fu">update</span>(anderson.sem, hotspotYN <span class="sc">%~~%</span> leafN)</span>
<span id="cb232-2"><a href="structural-equation-models.html#cb232-2" tabindex="-1"></a><span class="fu">dSep</span>(anderson.sem2)</span></code></pre></div>
<pre><code>##   |                                                                                                                 |                                                                                                         |   0%  |                                                                                                                 |=========================================================================================================| 100%</code></pre>
<pre><code>##            Independ.Claim Test.Type DF Crit.Value   P.Value 
## 1 leafN ~ landscape + ...      coef 97   1.115091 0.2675663</code></pre>
<p>Standardizing Coefficients</p>
<p>Latent Theoretic (LT) Approach</p>
<div class="sourceCode" id="cb235"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb235-1"><a href="structural-equation-models.html#cb235-1" tabindex="-1"></a>anderson.glm <span class="ot">&lt;-</span> anderson.sem[[<span class="dv">2</span>]]</span>
<span id="cb235-2"><a href="structural-equation-models.html#cb235-2" tabindex="-1"></a>Betas <span class="ot">&lt;-</span> <span class="fu">coefs</span>(anderson.sem)[<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>, <span class="dv">3</span>]  <span class="co"># GLM coefficients</span></span>
<span id="cb235-3"><a href="structural-equation-models.html#cb235-3" tabindex="-1"></a>preds <span class="ot">&lt;-</span> <span class="fu">predict</span>(anderson.glm, <span class="at">type =</span> <span class="st">&quot;link&quot;</span>)</span>
<span id="cb235-4"><a href="structural-equation-models.html#cb235-4" tabindex="-1"></a></span>
<span id="cb235-5"><a href="structural-equation-models.html#cb235-5" tabindex="-1"></a>sd.y.LT <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">var</span>(preds) <span class="sc">+</span> pi<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">3</span>)</span>
<span id="cb235-6"><a href="structural-equation-models.html#cb235-6" tabindex="-1"></a>sd.x <span class="ot">&lt;-</span> <span class="fu">sapply</span>(anderson[, <span class="fu">c</span>(<span class="st">&quot;leafN&quot;</span>, <span class="st">&quot;biomass.kg&quot;</span>, <span class="st">&quot;landscape&quot;</span>)], sd)</span>
<span id="cb235-7"><a href="structural-equation-models.html#cb235-7" tabindex="-1"></a></span>
<span id="cb235-8"><a href="structural-equation-models.html#cb235-8" tabindex="-1"></a>Betas.LT <span class="ot">&lt;-</span> Betas <span class="sc">*</span> sd.x <span class="sc">/</span> sd.y.LT</span>
<span id="cb235-9"><a href="structural-equation-models.html#cb235-9" tabindex="-1"></a>Betas.LT</span></code></pre></div>
<pre><code>##       leafN  biomass.kg   landscape 
## -0.03014129  0.04284880 -0.04271486</code></pre>
<p>Observed Error (OE) Approach</p>
<div class="sourceCode" id="cb237"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb237-1"><a href="structural-equation-models.html#cb237-1" tabindex="-1"></a>preds_response <span class="ot">&lt;-</span> <span class="fu">predict</span>(anderson.glm, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb237-2"><a href="structural-equation-models.html#cb237-2" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="fu">cor</span>(anderson<span class="sc">$</span>hotspotYN, preds_response)</span>
<span id="cb237-3"><a href="structural-equation-models.html#cb237-3" tabindex="-1"></a></span>
<span id="cb237-4"><a href="structural-equation-models.html#cb237-4" tabindex="-1"></a>sd.y.OE <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">var</span>(preds_response)) <span class="sc">/</span> R</span>
<span id="cb237-5"><a href="structural-equation-models.html#cb237-5" tabindex="-1"></a>Betas.OE <span class="ot">&lt;-</span> Betas <span class="sc">*</span> sd.x <span class="sc">/</span> sd.y.OE</span>
<span id="cb237-6"><a href="structural-equation-models.html#cb237-6" tabindex="-1"></a>Betas.OE</span></code></pre></div>
<pre><code>##      leafN biomass.kg  landscape 
## -0.1089265  0.1548496 -0.1543656</code></pre>
<p>Compare LT vs OE Approaches</p>
<div class="sourceCode" id="cb239"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb239-1"><a href="structural-equation-models.html#cb239-1" tabindex="-1"></a><span class="co"># Indirect effect: leafN â hotspotYN (through biomass.kg)</span></span>
<span id="cb239-2"><a href="structural-equation-models.html#cb239-2" tabindex="-1"></a>Beta.leafN <span class="ot">&lt;-</span> <span class="fu">coefs</span>(anderson.sem)<span class="sc">$</span>Std.Estimate[<span class="dv">1</span>]</span>
<span id="cb239-3"><a href="structural-equation-models.html#cb239-3" tabindex="-1"></a>indirect_LT <span class="ot">&lt;-</span> Beta.leafN <span class="sc">*</span> Betas.LT[<span class="dv">1</span>]</span>
<span id="cb239-4"><a href="structural-equation-models.html#cb239-4" tabindex="-1"></a>indirect_OE <span class="ot">&lt;-</span> Beta.leafN <span class="sc">*</span> Betas.OE[<span class="dv">1</span>]</span>
<span id="cb239-5"><a href="structural-equation-models.html#cb239-5" tabindex="-1"></a></span>
<span id="cb239-6"><a href="structural-equation-models.html#cb239-6" tabindex="-1"></a><span class="fu">c</span>(<span class="at">LT =</span> indirect_LT, <span class="at">OE =</span> indirect_OE)</span></code></pre></div>
<pre><code>##      LT.leafN      OE.leafN 
## -0.0009434225 -0.0034093982</code></pre>
<p>Summary:</p>
<pre><code>â¢   Use glm() in psem() for binary or count outcomes.
â¢   Add conserve = TRUE for directed separation when variables are non-normal.
â¢   Use both LT and OE standardization to interpret effect sizes.</code></pre>
<div id="chapter-15-categorical-predictors-multigroup-sem" class="section level3 hasAnchor" number="2.9.1">
<h3><span class="header-section-number">2.9.1</span> Chapter 15: Categorical Predictors &amp; Multigroup SEM<a href="structural-equation-models.html#chapter-15-categorical-predictors-multigroup-sem" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb242-1"><a href="structural-equation-models.html#cb242-1" tabindex="-1"></a><span class="fu">library</span>(lme4)</span>
<span id="cb242-2"><a href="structural-equation-models.html#cb242-2" tabindex="-1"></a><span class="fu">library</span>(piecewiseSEM)</span>
<span id="cb242-3"><a href="structural-equation-models.html#cb242-3" tabindex="-1"></a><span class="fu">library</span>(emmeans)</span>
<span id="cb242-4"><a href="structural-equation-models.html#cb242-4" tabindex="-1"></a><span class="fu">library</span>(lavaan)</span></code></pre></div>
<p>Overview</p>
<p>In this tutorial, we explore:</p>
<pre><code>â¢   Using categorical predictors in SEM.
â¢   Accounting for random effects (e.g., genotype).
â¢   Conducting multigroup SEM across different contexts or study sites.</code></pre>
<ol style="list-style-type: decimal">
<li>Categorical Predictors and Random Effects</li>
</ol>
<p>Example: Bowen et al.Â (2017) tested whether Phragmites genotype affects soil microbes and productivity.</p>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb244-1"><a href="structural-equation-models.html#cb244-1" tabindex="-1"></a><span class="fu">library</span>(multcompView)</span>
<span id="cb244-2"><a href="structural-equation-models.html#cb244-2" tabindex="-1"></a></span>
<span id="cb244-3"><a href="structural-equation-models.html#cb244-3" tabindex="-1"></a><span class="co"># Simulated structure: Genotype nested within Phragmites status (e.g., native, invasive)</span></span>
<span id="cb244-4"><a href="structural-equation-models.html#cb244-4" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb244-5"><a href="structural-equation-models.html#cb244-5" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">90</span></span>
<span id="cb244-6"><a href="structural-equation-models.html#cb244-6" tabindex="-1"></a>bowen <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb244-7"><a href="structural-equation-models.html#cb244-7" tabindex="-1"></a>  <span class="at">status =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;native&quot;</span>, <span class="st">&quot;invasive&quot;</span>, <span class="st">&quot;introduced&quot;</span>), <span class="at">each =</span> <span class="dv">30</span>)),</span>
<span id="cb244-8"><a href="structural-equation-models.html#cb244-8" tabindex="-1"></a>  <span class="at">Genotype =</span> <span class="fu">rep</span>(<span class="fu">paste0</span>(<span class="st">&quot;G&quot;</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>), <span class="at">each =</span> <span class="dv">10</span>),</span>
<span id="cb244-9"><a href="structural-equation-models.html#cb244-9" tabindex="-1"></a>  <span class="at">observed_otus =</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">2500</span>, <span class="at">sd =</span> <span class="dv">100</span>),</span>
<span id="cb244-10"><a href="structural-equation-models.html#cb244-10" tabindex="-1"></a>  <span class="at">RNA.DNA =</span> <span class="fu">rnorm</span>(n, <span class="fl">0.7</span>, <span class="fl">0.05</span>),</span>
<span id="cb244-11"><a href="structural-equation-models.html#cb244-11" tabindex="-1"></a>  <span class="at">below.C =</span> <span class="fu">rnorm</span>(n, <span class="dv">43</span>, <span class="dv">1</span>),</span>
<span id="cb244-12"><a href="structural-equation-models.html#cb244-12" tabindex="-1"></a>  <span class="at">abovebiomass_g =</span> <span class="fu">rnorm</span>(n, <span class="dv">2</span>, <span class="fl">0.5</span>)</span>
<span id="cb244-13"><a href="structural-equation-models.html#cb244-13" tabindex="-1"></a>)</span>
<span id="cb244-14"><a href="structural-equation-models.html#cb244-14" tabindex="-1"></a></span>
<span id="cb244-15"><a href="structural-equation-models.html#cb244-15" tabindex="-1"></a><span class="co"># Mixed models for each component</span></span>
<span id="cb244-16"><a href="structural-equation-models.html#cb244-16" tabindex="-1"></a>div_mod <span class="ot">&lt;-</span> <span class="fu">lmer</span>(observed_otus <span class="sc">~</span> status <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Genotype), <span class="at">data =</span> bowen)</span></code></pre></div>
<pre><code>## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb246-1"><a href="structural-equation-models.html#cb246-1" tabindex="-1"></a>activity_mod <span class="ot">&lt;-</span> <span class="fu">lmer</span>(RNA.DNA <span class="sc">~</span> status <span class="sc">+</span> observed_otus <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Genotype), <span class="at">data =</span> bowen)</span>
<span id="cb246-2"><a href="structural-equation-models.html#cb246-2" tabindex="-1"></a>carbon_mod <span class="ot">&lt;-</span> <span class="fu">lmer</span>(below.C <span class="sc">~</span> observed_otus <span class="sc">+</span> status <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Genotype), <span class="at">data =</span> bowen)</span></code></pre></div>
<pre><code>## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb248-1"><a href="structural-equation-models.html#cb248-1" tabindex="-1"></a>biomass_mod <span class="ot">&lt;-</span> <span class="fu">lmer</span>(abovebiomass_g <span class="sc">~</span> RNA.DNA <span class="sc">+</span> observed_otus <span class="sc">+</span> below.C <span class="sc">+</span> status <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Genotype), <span class="at">data =</span> bowen)</span></code></pre></div>
<pre><code>## Warning: Some predictor variables are on very different scales: consider rescaling</code></pre>
<pre><code>## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<div class="sourceCode" id="cb251"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb251-1"><a href="structural-equation-models.html#cb251-1" tabindex="-1"></a><span class="co"># Build piecewise SEM</span></span>
<span id="cb251-2"><a href="structural-equation-models.html#cb251-2" tabindex="-1"></a>bowen_mod <span class="ot">&lt;-</span> <span class="fu">psem</span>(div_mod, activity_mod, carbon_mod, biomass_mod, <span class="at">data =</span> bowen)</span>
<span id="cb251-3"><a href="structural-equation-models.html#cb251-3" tabindex="-1"></a><span class="fu">summary</span>(bowen_mod)</span></code></pre></div>
<pre><code>##   |                                                                                                                 |                                                                                                         |   0%</code></pre>
<pre><code>## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<pre><code>##   |                                                                                                                 |=========================================================================================================| 100%</code></pre>
<pre><code>## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<pre><code>## Warning: Categorical or non-linear variables detected. Please refer to documentation for interpretation of
## Estimates!</code></pre>
<pre><code>## 
## Structural Equation Model of bowen_mod 
## 
## Call:
##   observed_otus ~ status
##   RNA.DNA ~ status + observed_otus
##   below.C ~ observed_otus + status
##   abovebiomass_g ~ RNA.DNA + observed_otus + below.C + status
## 
##     AIC
##  1251.338
## 
## ---
## Tests of directed separation:
## 
##            Independ.Claim Test.Type     DF Crit.Value P.Value 
##   below.C ~ RNA.DNA + ...      coef 83.905      0.018  0.8937 
## 
## --
## Global goodness-of-fit:
## 
## Chi-Squared = 3.513 with P-value = 0.061 and on 1 degrees of freedom
## Fisher&#39;s C = 0.225 with P-value = 0.894 and on 2 degrees of freedom
## 
## ---
## Coefficients:
## 
##         Response           Predictor  Estimate Std.Error      DF Crit.Value P.Value Std.Estimate    
##    observed_otus              status         -         -  2.0000     0.0237  0.9766            -    
##    observed_otus     status = native 2508.2458   16.3598  6.0000   153.3172  0.0000            - ***
##    observed_otus status = introduced 2511.0278   16.3598  6.0000   153.4872  0.0000            - ***
##    observed_otus   status = invasive 2513.2775   16.3598  6.0000   153.6247  0.0000            - ***
##          RNA.DNA       observed_otus   -0.0062    0.0147 84.1918     0.1100  0.7409            -    
##          RNA.DNA              status         -         -  2.0000     2.0441  0.2111            -    
##          RNA.DNA   status = invasive    0.6835    0.0104  5.9386    65.7032  0.0000            - ***
##          RNA.DNA     status = native    0.7056    0.0104  5.9389    67.8238  0.0000            - ***
##          RNA.DNA status = introduced    0.7119    0.0104  5.9365    68.4304  0.0000            - ***
##          below.C       observed_otus    -4e-04    0.0012 85.2844     0.1004  0.7521            -    
##          below.C              status         -         -  2.0000     0.7820  0.4997            -    
##          below.C   status = invasive    42.763    0.1857  5.9128   230.2879  0.0000            - ***
##          below.C status = introduced   43.0245    0.1857  5.9100   231.7263  0.0000            - ***
##          below.C     status = native   43.0658    0.1857  5.9132   231.9142  0.0000            - ***
##   abovebiomass_g             RNA.DNA    0.1948    1.1068 82.9464     0.0290  0.8651            -    
##   abovebiomass_g       observed_otus     2e-04     6e-04 83.1788     0.1687  0.6824            -    
##   abovebiomass_g             below.C   -0.1292    0.0523 83.1665     5.9076  0.0172            -   *
##   abovebiomass_g              status         -         -  2.0000     0.2393  0.7943            -    
##   abovebiomass_g status = introduced    2.0074    0.0911  5.8667    22.0333  0.0000            - ***
##   abovebiomass_g     status = native    2.0829    0.0905  5.7339    23.0193  0.0000            - ***
##   abovebiomass_g   status = invasive    2.0871    0.0927  6.2237    22.5236  0.0000            - ***
## 
##   Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05
## 
## ---
## Individual R-squared:
## 
##         Response method Marginal Conditional
##    observed_otus   none     0.00        0.00
##          RNA.DNA   none     0.06        0.10
##          below.C   none     0.02        0.02
##   abovebiomass_g   none     0.07        0.07</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>Visualizing Categorical Effects</li>
</ol>
<p>Estimated Marginal Means by status:</p>
<div class="sourceCode" id="cb258"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb258-1"><a href="structural-equation-models.html#cb258-1" tabindex="-1"></a><span class="fu">lapply</span>(bowen_mod[<span class="sc">-</span><span class="fu">length</span>(bowen_mod)], emmeans, <span class="at">specs =</span> <span class="sc">~</span>status)</span></code></pre></div>
<pre><code>## [[1]]
##  status     emmean   SE df lower.CL upper.CL
##  introduced   2511 16.4  6     2471     2551
##  invasive     2513 16.4  6     2473     2553
##  native       2508 16.4  6     2468     2548
## 
## Degrees-of-freedom method: kenward-roger 
## Confidence level used: 0.95 
## 
## [[2]]
##  status     emmean     SE   df lower.CL upper.CL
##  introduced  0.712 0.0104 5.94    0.686    0.737
##  invasive    0.684 0.0104 5.94    0.658    0.709
##  native      0.706 0.0104 5.94    0.680    0.731
## 
## Degrees-of-freedom method: kenward-roger 
## Confidence level used: 0.95 
## 
## [[3]]
##  status     emmean    SE   df lower.CL upper.CL
##  introduced   43.0 0.186 5.91     42.6     43.5
##  invasive     42.8 0.186 5.91     42.3     43.2
##  native       43.1 0.186 5.91     42.6     43.5
## 
## Degrees-of-freedom method: kenward-roger 
## Confidence level used: 0.95 
## 
## [[4]]
##  status     emmean     SE   df lower.CL upper.CL
##  introduced   2.01 0.0911 5.87     1.78     2.23
##  invasive     2.09 0.0927 6.22     1.86     2.31
##  native       2.08 0.0905 5.73     1.86     2.31
## 
## Degrees-of-freedom method: kenward-roger 
## Confidence level used: 0.95</code></pre>
<div class="sourceCode" id="cb260"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb260-1"><a href="structural-equation-models.html#cb260-1" tabindex="-1"></a><span class="co"># Post-hoc Tests (Tukey)</span></span>
<span id="cb260-2"><a href="structural-equation-models.html#cb260-2" tabindex="-1"></a></span>
<span id="cb260-3"><a href="structural-equation-models.html#cb260-3" tabindex="-1"></a>generic_tukey <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">emmeans</span>(x, <span class="fu">list</span>(pairwise <span class="sc">~</span> status))</span>
<span id="cb260-4"><a href="structural-equation-models.html#cb260-4" tabindex="-1"></a><span class="fu">lapply</span>(bowen_mod[<span class="sc">-</span><span class="fu">length</span>(bowen_mod)], generic_tukey)</span></code></pre></div>
<pre><code>## [[1]]
## $`emmeans of status`
##  status     emmean   SE df lower.CL upper.CL
##  introduced   2511 16.4  6     2471     2551
##  invasive     2513 16.4  6     2473     2553
##  native       2508 16.4  6     2468     2548
## 
## Degrees-of-freedom method: kenward-roger 
## Confidence level used: 0.95 
## 
## $`pairwise differences of status`
##  1                     estimate   SE df t.ratio p.value
##  introduced - invasive    -2.25 23.1  6  -0.097  0.9948
##  introduced - native       2.78 23.1  6   0.120  0.9921
##  invasive - native         5.03 23.1  6   0.217  0.9744
## 
## Degrees-of-freedom method: kenward-roger 
## P value adjustment: tukey method for comparing a family of 3 estimates 
## 
## 
## [[2]]
## $`emmeans of status`
##  status     emmean     SE   df lower.CL upper.CL
##  introduced  0.712 0.0104 5.94    0.686    0.737
##  invasive    0.684 0.0104 5.94    0.658    0.709
##  native      0.706 0.0104 5.94    0.680    0.731
## 
## Degrees-of-freedom method: kenward-roger 
## Confidence level used: 0.95 
## 
## $`pairwise differences of status`
##  1                     estimate     SE   df t.ratio p.value
##  introduced - invasive  0.02831 0.0147 5.94   1.924  0.2130
##  introduced - native    0.00624 0.0147 5.94   0.424  0.9072
##  invasive - native     -0.02207 0.0147 5.94  -1.500  0.3560
## 
## Degrees-of-freedom method: kenward-roger 
## P value adjustment: tukey method for comparing a family of 3 estimates 
## 
## 
## [[3]]
## $`emmeans of status`
##  status     emmean    SE   df lower.CL upper.CL
##  introduced   43.0 0.186 5.91     42.6     43.5
##  invasive     42.8 0.186 5.91     42.3     43.2
##  native       43.1 0.186 5.91     42.6     43.5
## 
## Degrees-of-freedom method: kenward-roger 
## Confidence level used: 0.95 
## 
## $`pairwise differences of status`
##  1                     estimate    SE   df t.ratio p.value
##  introduced - invasive   0.2615 0.263 5.91   0.996  0.6061
##  introduced - native    -0.0413 0.263 5.91  -0.157  0.9865
##  invasive - native      -0.3029 0.263 5.92  -1.153  0.5204
## 
## Degrees-of-freedom method: kenward-roger 
## P value adjustment: tukey method for comparing a family of 3 estimates 
## 
## 
## [[4]]
## $`emmeans of status`
##  status     emmean     SE   df lower.CL upper.CL
##  introduced   2.01 0.0911 5.87     1.78     2.23
##  invasive     2.09 0.0927 6.22     1.86     2.31
##  native       2.08 0.0905 5.73     1.86     2.31
## 
## Degrees-of-freedom method: kenward-roger 
## Confidence level used: 0.95 
## 
## $`pairwise differences of status`
##  1                     estimate    SE   df t.ratio p.value
##  introduced - invasive -0.07972 0.132 6.41  -0.603  0.8234
##  introduced - native   -0.07557 0.128 5.67  -0.592  0.8295
##  invasive - native      0.00415 0.131 6.21   0.032  0.9994
## 
## Degrees-of-freedom method: kenward-roger 
## P value adjustment: tukey method for comparing a family of 3 estimates</code></pre>
<ol start="3" style="list-style-type: decimal">
<li>Multigroup SEM in lavaan</li>
</ol>
<p>Fit the same SEM model to different groups and test whether path coefficients differ.</p>
<div class="sourceCode" id="cb262"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb262-1"><a href="structural-equation-models.html#cb262-1" tabindex="-1"></a><span class="co"># Create simulated dataset</span></span>
<span id="cb262-2"><a href="structural-equation-models.html#cb262-2" tabindex="-1"></a>group_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb262-3"><a href="structural-equation-models.html#cb262-3" tabindex="-1"></a>  <span class="at">site =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>), <span class="at">each =</span> <span class="dv">50</span>),</span>
<span id="cb262-4"><a href="structural-equation-models.html#cb262-4" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">rnorm</span>(<span class="dv">100</span>),</span>
<span id="cb262-5"><a href="structural-equation-models.html#cb262-5" tabindex="-1"></a>  <span class="at">m =</span> <span class="fu">rnorm</span>(<span class="dv">100</span>),</span>
<span id="cb262-6"><a href="structural-equation-models.html#cb262-6" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">rnorm</span>(<span class="dv">100</span>)</span>
<span id="cb262-7"><a href="structural-equation-models.html#cb262-7" tabindex="-1"></a>)</span>
<span id="cb262-8"><a href="structural-equation-models.html#cb262-8" tabindex="-1"></a></span>
<span id="cb262-9"><a href="structural-equation-models.html#cb262-9" tabindex="-1"></a><span class="co"># Define a simple SEM model</span></span>
<span id="cb262-10"><a href="structural-equation-models.html#cb262-10" tabindex="-1"></a>sem_model <span class="ot">&lt;-</span> <span class="st">&#39;</span></span>
<span id="cb262-11"><a href="structural-equation-models.html#cb262-11" tabindex="-1"></a><span class="st">  m ~ a*x</span></span>
<span id="cb262-12"><a href="structural-equation-models.html#cb262-12" tabindex="-1"></a><span class="st">  y ~ b*m + c*x</span></span>
<span id="cb262-13"><a href="structural-equation-models.html#cb262-13" tabindex="-1"></a><span class="st">&#39;</span></span>
<span id="cb262-14"><a href="structural-equation-models.html#cb262-14" tabindex="-1"></a></span>
<span id="cb262-15"><a href="structural-equation-models.html#cb262-15" tabindex="-1"></a><span class="co"># Fit multi-group SEM</span></span>
<span id="cb262-16"><a href="structural-equation-models.html#cb262-16" tabindex="-1"></a>fit_multi <span class="ot">&lt;-</span> lavaan<span class="sc">::</span><span class="fu">sem</span>(sem_model, <span class="at">data =</span> group_df, <span class="at">group =</span> <span class="st">&quot;site&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: lavaan-&gt;lavParTable():  
##    using a single label per parameter in a multiple group setting implies imposing equality constraints across 
##    all the groups; If this is not intended, either remove the label(s), or use a vector of labels (one for each 
##    group); See the Multiple groups section in the man page of model.syntax.</code></pre>
<div class="sourceCode" id="cb264"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb264-1"><a href="structural-equation-models.html#cb264-1" tabindex="-1"></a><span class="co"># View summary</span></span>
<span id="cb264-2"><a href="structural-equation-models.html#cb264-2" tabindex="-1"></a><span class="fu">summary</span>(fit_multi, <span class="at">fit.measures =</span> <span class="cn">TRUE</span>, <span class="at">standardized =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## lavaan 0.6-19 ended normally after 12 iterations
## 
##   Estimator                                         ML
##   Optimization method                           NLMINB
##   Number of model parameters                        14
##   Number of equality constraints                     3
## 
##   Number of observations per group:                   
##     A                                               50
##     B                                               50
## 
## Model Test User Model:
##                                                       
##   Test statistic                                 0.790
##   Degrees of freedom                                 3
##   P-value (Chi-square)                           0.852
##   Test statistic for each group:
##     A                                            0.498
##     B                                            0.292
## 
## Model Test Baseline Model:
## 
##   Test statistic                                 2.093
##   Degrees of freedom                                 6
##   P-value                                        0.911
## 
## User Model versus Baseline Model:
## 
##   Comparative Fit Index (CFI)                    1.000
##   Tucker-Lewis Index (TLI)                      -0.131
## 
## Loglikelihood and Information Criteria:
## 
##   Loglikelihood user model (H0)               -293.784
##   Loglikelihood unrestricted model (H1)       -293.389
##                                                       
##   Akaike (AIC)                                 609.568
##   Bayesian (BIC)                               638.225
##   Sample-size adjusted Bayesian (SABIC)        603.484
## 
## Root Mean Square Error of Approximation:
## 
##   RMSEA                                          0.000
##   90 Percent confidence interval - lower         0.000
##   90 Percent confidence interval - upper         0.130
##   P-value H_0: RMSEA &lt;= 0.050                    0.874
##   P-value H_0: RMSEA &gt;= 0.080                    0.098
## 
## Standardized Root Mean Square Residual:
## 
##   SRMR                                           0.029
## 
## Parameter Estimates:
## 
##   Standard errors                             Standard
##   Information                                 Expected
##   Information saturated (h1) model          Structured
## 
## 
## Group 1 [A]:
## 
## Regressions:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##   m ~                                                                   
##     x          (a)   -0.011    0.099   -0.116    0.908   -0.011   -0.009
##   y ~                                                                   
##     m          (b)   -0.105    0.095   -1.106    0.269   -0.105   -0.128
##     x          (c)    0.031    0.101    0.310    0.757    0.031    0.031
## 
## Intercepts:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##    .m                 0.144    0.170    0.844    0.398    0.144    0.119
##    .y                 0.076    0.139    0.544    0.586    0.076    0.077
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##    .m                 1.445    0.289    5.000    0.000    1.445    1.000
##    .y                 0.960    0.192    5.000    0.000    0.960    0.983
## 
## 
## Group 2 [B]:
## 
## Regressions:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##   m ~                                                                   
##     x          (a)   -0.011    0.099   -0.116    0.908   -0.011   -0.014
##   y ~                                                                   
##     m          (b)   -0.105    0.095   -1.106    0.269   -0.105   -0.088
##     x          (c)    0.031    0.101    0.310    0.757    0.031    0.031
## 
## Intercepts:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##    .m                -0.116    0.134   -0.860    0.390   -0.116   -0.124
##    .y                -0.240    0.160   -1.506    0.132   -0.240   -0.215
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##    .m                 0.872    0.174    5.000    0.000    0.872    1.000
##    .y                 1.234    0.247    5.000    0.000    1.234    0.991</code></pre>
<ol start="4" style="list-style-type: decimal">
<li>Constraining Parameters Across Groups</li>
</ol>
<p>You can test whether coefficients differ across groups:</p>
<p>A significant p-value means the unconstrained model fits better â i.e., group differences do matter.</p>
<p>Summary:</p>
<pre><code>â¢   Use lme4 and piecewiseSEM for models with random effects.
â¢   lavaan enables multigroup comparisons to test generality across systems.
â¢   Post-hoc tools like emmeans help interpret categorical predictors.</code></pre>
</div>
<div id="chapter-16-multigroup-sem-in-r" class="section level3 hasAnchor" number="2.9.2">
<h3><span class="header-section-number">2.9.2</span> Chapter 16: Multigroup SEM in R<a href="structural-equation-models.html#chapter-16-multigroup-sem-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb267"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb267-1"><a href="structural-equation-models.html#cb267-1" tabindex="-1"></a><span class="fu">library</span>(lavaan)</span></code></pre></div>
<p>What is Multigroup SEM?</p>
<p>Multigroup SEM allows you to:
â¢ Test whether path coefficients differ between groups.
â¢ Assess whether a model holds equally well across groups.
â¢ Investigate measurement invariance (i.e., whether constructs are perceived similarly).</p>
<p>Example Model Setup</p>
<p>Weâll build a simple mediation model where group is a binary factor (âAâ vs âBâ).</p>
<div class="sourceCode" id="cb268"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb268-1"><a href="structural-equation-models.html#cb268-1" tabindex="-1"></a><span class="co"># Simulate data</span></span>
<span id="cb268-2"><a href="structural-equation-models.html#cb268-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb268-3"><a href="structural-equation-models.html#cb268-3" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb268-4"><a href="structural-equation-models.html#cb268-4" tabindex="-1"></a>group <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>), <span class="at">each =</span> n)</span>
<span id="cb268-5"><a href="structural-equation-models.html#cb268-5" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">2</span> <span class="sc">*</span> n)</span>
<span id="cb268-6"><a href="structural-equation-models.html#cb268-6" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fl">0.5</span> <span class="sc">*</span> x <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">2</span> <span class="sc">*</span> n)</span>
<span id="cb268-7"><a href="structural-equation-models.html#cb268-7" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fl">0.6</span> <span class="sc">*</span> m <span class="sc">+</span> <span class="fl">0.3</span> <span class="sc">*</span> x <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">2</span> <span class="sc">*</span> n)</span>
<span id="cb268-8"><a href="structural-equation-models.html#cb268-8" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(group, x, m, y)</span></code></pre></div>
<p>Define the SEM</p>
<div class="sourceCode" id="cb269"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb269-1"><a href="structural-equation-models.html#cb269-1" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="st">&#39;</span></span>
<span id="cb269-2"><a href="structural-equation-models.html#cb269-2" tabindex="-1"></a><span class="st">  m ~ a*x</span></span>
<span id="cb269-3"><a href="structural-equation-models.html#cb269-3" tabindex="-1"></a><span class="st">  y ~ b*m + c*x</span></span>
<span id="cb269-4"><a href="structural-equation-models.html#cb269-4" tabindex="-1"></a><span class="st">&#39;</span></span></code></pre></div>
<p>Fit Multigroup SEM</p>
<div class="sourceCode" id="cb270"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb270-1"><a href="structural-equation-models.html#cb270-1" tabindex="-1"></a>fit_multi <span class="ot">&lt;-</span> <span class="fu">sem</span>(model, <span class="at">data =</span> data, <span class="at">group =</span> <span class="st">&quot;group&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: lavaan-&gt;lavParTable():  
##    using a single label per parameter in a multiple group setting implies imposing equality constraints across 
##    all the groups; If this is not intended, either remove the label(s), or use a vector of labels (one for each 
##    group); See the Multiple groups section in the man page of model.syntax.</code></pre>
<div class="sourceCode" id="cb272"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb272-1"><a href="structural-equation-models.html#cb272-1" tabindex="-1"></a><span class="fu">summary</span>(fit_multi, <span class="at">fit.measures =</span> <span class="cn">TRUE</span>, <span class="at">standardized =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## lavaan 0.6-19 ended normally after 13 iterations
## 
##   Estimator                                         ML
##   Optimization method                           NLMINB
##   Number of model parameters                        14
##   Number of equality constraints                     3
## 
##   Number of observations per group:                   
##     A                                              100
##     B                                              100
## 
## Model Test User Model:
##                                                       
##   Test statistic                                 6.839
##   Degrees of freedom                                 3
##   P-value (Chi-square)                           0.077
##   Test statistic for each group:
##     A                                            3.618
##     B                                            3.220
## 
## Model Test Baseline Model:
## 
##   Test statistic                               131.688
##   Degrees of freedom                                 6
##   P-value                                        0.000
## 
## User Model versus Baseline Model:
## 
##   Comparative Fit Index (CFI)                    0.969
##   Tucker-Lewis Index (TLI)                       0.939
## 
## Loglikelihood and Information Criteria:
## 
##   Loglikelihood user model (H0)               -556.173
##   Loglikelihood unrestricted model (H1)       -552.754
##                                                       
##   Akaike (AIC)                                1134.347
##   Bayesian (BIC)                              1170.628
##   Sample-size adjusted Bayesian (SABIC)       1135.779
## 
## Root Mean Square Error of Approximation:
## 
##   RMSEA                                          0.113
##   90 Percent confidence interval - lower         0.000
##   90 Percent confidence interval - upper         0.228
##   P-value H_0: RMSEA &lt;= 0.050                    0.139
##   P-value H_0: RMSEA &gt;= 0.080                    0.755
## 
## Standardized Root Mean Square Residual:
## 
##   SRMR                                           0.083
## 
## Parameter Estimates:
## 
##   Standard errors                             Standard
##   Information                                 Expected
##   Information saturated (h1) model          Structured
## 
## 
## Group 1 [A]:
## 
## Regressions:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##   m ~                                                                   
##     x          (a)    0.453    0.075    6.064    0.000    0.453    0.401
##   y ~                                                                   
##     m          (b)    0.542    0.068    7.947    0.000    0.542    0.460
##     x          (c)    0.295    0.078    3.756    0.000    0.295    0.222
## 
## Intercepts:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##    .m                 0.125    0.094    1.323    0.186    0.125    0.122
##    .y                 0.116    0.098    1.178    0.239    0.116    0.096
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##    .m                 0.885    0.125    7.071    0.000    0.885    0.840
##    .y                 0.958    0.135    7.071    0.000    0.958    0.657
## 
## 
## Group 2 [B]:
## 
## Regressions:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##   m ~                                                                   
##     x          (a)    0.453    0.075    6.064    0.000    0.453    0.387
##   y ~                                                                   
##     m          (b)    0.542    0.068    7.947    0.000    0.542    0.504
##     x          (c)    0.295    0.078    3.756    0.000    0.295    0.235
## 
## Intercepts:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##    .m                -0.041    0.104   -0.397    0.691   -0.041   -0.037
##    .y                -0.048    0.094   -0.513    0.608   -0.048   -0.040
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##    .m                 1.074    0.152    7.071    0.000    1.074    0.850
##    .y                 0.874    0.124    7.071    0.000    0.874    0.599</code></pre>
<p>Test for Invariance</p>
<p>To test for invariance, you can constrain parameters to be equal across groups.</p>
<div class="sourceCode" id="cb274"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb274-1"><a href="structural-equation-models.html#cb274-1" tabindex="-1"></a><span class="co"># Constrain &#39;a&#39; and &#39;b&#39; to be equal across groups</span></span>
<span id="cb274-2"><a href="structural-equation-models.html#cb274-2" tabindex="-1"></a>model_constrained <span class="ot">&lt;-</span> <span class="st">&#39;</span></span>
<span id="cb274-3"><a href="structural-equation-models.html#cb274-3" tabindex="-1"></a><span class="st">  m ~ c(a, a)*x</span></span>
<span id="cb274-4"><a href="structural-equation-models.html#cb274-4" tabindex="-1"></a><span class="st">  y ~ c(b, b)*m + c*x</span></span>
<span id="cb274-5"><a href="structural-equation-models.html#cb274-5" tabindex="-1"></a><span class="st">&#39;</span></span>
<span id="cb274-6"><a href="structural-equation-models.html#cb274-6" tabindex="-1"></a></span>
<span id="cb274-7"><a href="structural-equation-models.html#cb274-7" tabindex="-1"></a>fit_constrained <span class="ot">&lt;-</span> <span class="fu">sem</span>(model_constrained, <span class="at">data =</span> data, <span class="at">group =</span> <span class="st">&quot;group&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: lavaan-&gt;lavParTable():  
##    using a single label per parameter in a multiple group setting implies imposing equality constraints across 
##    all the groups; If this is not intended, either remove the label(s), or use a vector of labels (one for each 
##    group); See the Multiple groups section in the man page of model.syntax.</code></pre>
<div class="sourceCode" id="cb276"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb276-1"><a href="structural-equation-models.html#cb276-1" tabindex="-1"></a><span class="fu">anova</span>(fit_multi, fit_constrained)  <span class="co"># Chi-square test for invariance</span></span></code></pre></div>
<pre><code>## Warning: lavaan-&gt;lavTestLRT():  
##    some models have the same degrees of freedom</code></pre>
<pre><code>## 
## Chi-Squared Difference Test
## 
##                 Df    AIC    BIC  Chisq Chisq diff RMSEA Df diff Pr(&gt;Chisq)
## fit_multi        3 1134.3 1170.6 6.8386                                    
## fit_constrained  3 1134.3 1170.6 6.8386          0     0       0</code></pre>
<p>Interpretation:</p>
<pre><code>â¢   If the constrained model does not significantly worsen fit, the paths a and b are likely invariant.
â¢   If the fit gets significantly worse, the relationship differs between groups and should be modeled separately.</code></pre>
<p>Visualizing Standardized Results</p>
<div class="sourceCode" id="cb280"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb280-1"><a href="structural-equation-models.html#cb280-1" tabindex="-1"></a><span class="fu">library</span>(semPlot)</span>
<span id="cb280-2"><a href="structural-equation-models.html#cb280-2" tabindex="-1"></a><span class="fu">semPaths</span>(fit_multi, <span class="st">&quot;std&quot;</span>, <span class="at">layout =</span> <span class="st">&quot;tree&quot;</span>, <span class="at">whatLabels =</span> <span class="st">&quot;std&quot;</span>, <span class="at">edge.label.cex =</span> <span class="fl">1.2</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-94-1.png" width="672" /><img src="_main_files/figure-html/unnamed-chunk-94-2.png" width="672" /></p>
<p>Summary</p>
<p>Multigroup SEM lets you:</p>
<pre><code>â¢   Evaluate moderation by group.
â¢   Test for measurement invariance.
â¢   Gain deeper insight into context-dependent pathways.</code></pre>
</div>
<div id="chapter-17" class="section level3 hasAnchor" number="2.9.3">
<h3><span class="header-section-number">2.9.3</span> Chapter 17:<a href="structural-equation-models.html#chapter-17" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Yes! Based on the content in SEM9.2 â Mixed Models Part 2, hereâs an R Markdown tutorial on using mixed models in piecewise SEM, covering:</p>
<pre><code>â¢   Fixed vs. random effects
â¢   Adding group-level predictors
â¢   Understanding RÂ² and model comparison
â¢   Dealing with hierarchical structure and sample size</code></pre>
<p>Introduction</p>
<p>This tutorial introduces how to incorporate mixed effects into Structural Equation Modeling using the piecewiseSEM package. Mixed models are essential when your data are hierarchically structured (e.g., plots within sites, streams within watersheds).</p>
<p>Step 1: Load Data and Create Variables</p>
<div class="sourceCode" id="cb283"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb283-1"><a href="structural-equation-models.html#cb283-1" tabindex="-1"></a><span class="co"># Log-transform predictors</span></span>
<span id="cb283-2"><a href="structural-equation-models.html#cb283-2" tabindex="-1"></a>cardinale<span class="sc">$</span>logN <span class="ot">&lt;-</span> <span class="fu">log10</span>(cardinale<span class="sc">$</span>N <span class="sc">+</span> <span class="fl">1e-6</span>)</span>
<span id="cb283-3"><a href="structural-equation-models.html#cb283-3" tabindex="-1"></a>cardinale<span class="sc">$</span>logN2 <span class="ot">&lt;-</span> cardinale<span class="sc">$</span>logN<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb283-4"><a href="structural-equation-models.html#cb283-4" tabindex="-1"></a>cardinale<span class="sc">$</span>logChl <span class="ot">&lt;-</span> <span class="fu">log10</span>(cardinale<span class="sc">$</span>Chl)</span>
<span id="cb283-5"><a href="structural-equation-models.html#cb283-5" tabindex="-1"></a></span>
<span id="cb283-6"><a href="structural-equation-models.html#cb283-6" tabindex="-1"></a><span class="co"># Centering predictors to reduce multicollinearity</span></span>
<span id="cb283-7"><a href="structural-equation-models.html#cb283-7" tabindex="-1"></a>cardinale<span class="sc">$</span>logN.cen <span class="ot">&lt;-</span> <span class="fu">scale</span>(cardinale<span class="sc">$</span>logN, <span class="at">scale =</span> <span class="cn">FALSE</span>)</span>
<span id="cb283-8"><a href="structural-equation-models.html#cb283-8" tabindex="-1"></a>cardinale<span class="sc">$</span>logN2.cen <span class="ot">&lt;-</span> <span class="fu">scale</span>(cardinale<span class="sc">$</span>logN<span class="sc">^</span><span class="dv">2</span>, <span class="at">scale =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p>Step 2: Fit Fixed Effects SEM</p>
<div class="sourceCode" id="cb284"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb284-1"><a href="structural-equation-models.html#cb284-1" tabindex="-1"></a>cardinale.sem <span class="ot">&lt;-</span> <span class="fu">psem</span>(</span>
<span id="cb284-2"><a href="structural-equation-models.html#cb284-2" tabindex="-1"></a>  <span class="fu">lm</span>(SA <span class="sc">~</span> logN.cen <span class="sc">+</span> logN2.cen <span class="sc">+</span> SR, <span class="at">data =</span> cardinale),</span>
<span id="cb284-3"><a href="structural-equation-models.html#cb284-3" tabindex="-1"></a>  <span class="fu">lm</span>(logChl <span class="sc">~</span> SA <span class="sc">+</span> logN.cen <span class="sc">+</span> logN2.cen, <span class="at">data =</span> cardinale),</span>
<span id="cb284-4"><a href="structural-equation-models.html#cb284-4" tabindex="-1"></a>  logN.cen <span class="sc">%~~%</span> logN2.cen,</span>
<span id="cb284-5"><a href="structural-equation-models.html#cb284-5" tabindex="-1"></a>  <span class="at">data =</span> cardinale</span>
<span id="cb284-6"><a href="structural-equation-models.html#cb284-6" tabindex="-1"></a>)</span>
<span id="cb284-7"><a href="structural-equation-models.html#cb284-7" tabindex="-1"></a></span>
<span id="cb284-8"><a href="structural-equation-models.html#cb284-8" tabindex="-1"></a><span class="fu">summary</span>(cardinale.sem)</span></code></pre></div>
<pre><code>##   |                                                                                                                 |                                                                                                         |   0%  |                                                                                                                 |=========================================================================================================| 100%</code></pre>
<pre><code>## 
## Structural Equation Model of cardinale.sem 
## 
## Call:
##   SA ~ logN.cen + logN2.cen + SR
##   logChl ~ SA + logN.cen + logN2.cen
##   logN.cen ~~ logN2.cen
## 
##     AIC
##  1192.444
## 
## ---
## Tests of directed separation:
## 
##      Independ.Claim Test.Type  DF Crit.Value P.Value 
##   logChl ~ SR + ...      coef 122     0.6639   0.508 
## 
## --
## Global goodness-of-fit:
## 
## Chi-Squared = 0.458 with P-value = 0.499 and on 1 degrees of freedom
## Fisher&#39;s C = 1.355 with P-value = 0.508 and on 2 degrees of freedom
## 
## ---
## Coefficients:
## 
##     Response   Predictor Estimate Std.Error  DF Crit.Value P.Value Std.Estimate    
##           SA    logN.cen  -2.9944    1.5375 123    -1.9476  0.0537      -0.5044    
##           SA   logN2.cen  -0.4742    0.2424 123    -1.9568  0.0526      -0.5067    
##           SA          SR   0.3838    0.0359 123    10.6844  0.0000       0.6893 ***
##       logChl          SA   0.0201     0.004 123     5.0327  0.0000       0.3946 ***
##       logChl    logN.cen   0.1168    0.0953 123     1.2258  0.2226       0.3858    
##       logChl   logN2.cen   0.0032     0.015 123     0.2108  0.8334       0.0664    
##   ~~logN.cen ~~logN2.cen  -0.9685         - 125   -43.4652  0.0000      -0.9685 ***
## 
##   Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05
## 
## ---
## Individual R-squared:
## 
##   Response method R.squared
##         SA   none      0.49
##     logChl   none      0.25</code></pre>
<p>Step 3: Add Random Effects with lme()</p>
<div class="sourceCode" id="cb287"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb287-1"><a href="structural-equation-models.html#cb287-1" tabindex="-1"></a><span class="co">#cardinale.mixed &lt;- psem(</span></span>
<span id="cb287-2"><a href="structural-equation-models.html#cb287-2" tabindex="-1"></a><span class="co">#  lme(SA ~ logN.cen + logN2.cen + SR, random = ~1 | Stream, data = cardinale),</span></span>
<span id="cb287-3"><a href="structural-equation-models.html#cb287-3" tabindex="-1"></a><span class="co">#  lme(logChl ~ SA + logN.cen + logN2.cen, random = ~1 | Stream, data = cardinale),</span></span>
<span id="cb287-4"><a href="structural-equation-models.html#cb287-4" tabindex="-1"></a><span class="co">#  logN.cen %~~% logN2.cen,</span></span>
<span id="cb287-5"><a href="structural-equation-models.html#cb287-5" tabindex="-1"></a><span class="co">#  data = cardinale</span></span>
<span id="cb287-6"><a href="structural-equation-models.html#cb287-6" tabindex="-1"></a><span class="co">#)</span></span>
<span id="cb287-7"><a href="structural-equation-models.html#cb287-7" tabindex="-1"></a></span>
<span id="cb287-8"><a href="structural-equation-models.html#cb287-8" tabindex="-1"></a><span class="co">#summary(cardinale.mixed)</span></span></code></pre></div>
<p>Step 4: Compare Models</p>
<div class="sourceCode" id="cb288"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb288-1"><a href="structural-equation-models.html#cb288-1" tabindex="-1"></a><span class="co"># Compare R-squared</span></span>
<span id="cb288-2"><a href="structural-equation-models.html#cb288-2" tabindex="-1"></a><span class="fu">rsquared</span>(cardinale.sem)</span></code></pre></div>
<pre><code>##   Response   family     link method R.squared
## 1       SA gaussian identity   none 0.4882395
## 2   logChl gaussian identity   none 0.2538638</code></pre>
<div class="sourceCode" id="cb290"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb290-1"><a href="structural-equation-models.html#cb290-1" tabindex="-1"></a><span class="co">#rsquared(cardinale.mixed)</span></span></code></pre></div>
<pre><code>â¢   Marginal RÂ²: Variance explained by fixed effects.
â¢   Conditional RÂ²: Variance explained by both fixed and random effects.</code></pre>
<p>Step 5: Optional â Add Group-Level Predictors</p>
<p>To address possible Simpsonâs paradox or correlated random effects:</p>
<div class="sourceCode" id="cb292"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb292-1"><a href="structural-equation-models.html#cb292-1" tabindex="-1"></a><span class="co"># Example if &quot;site_mean&quot; were available</span></span>
<span id="cb292-2"><a href="structural-equation-models.html#cb292-2" tabindex="-1"></a>cardinale<span class="sc">$</span>stream_mean_logN <span class="ot">&lt;-</span> <span class="fu">ave</span>(cardinale<span class="sc">$</span>logN, cardinale<span class="sc">$</span>Stream)</span>
<span id="cb292-3"><a href="structural-equation-models.html#cb292-3" tabindex="-1"></a>cardinale<span class="sc">$</span>deviation_logN <span class="ot">&lt;-</span> cardinale<span class="sc">$</span>logN <span class="sc">-</span> cardinale<span class="sc">$</span>stream_mean_logN</span></code></pre></div>
<p>This lets you include:</p>
<pre><code>â¢   stream_mean_logN (group-level predictor)
â¢   deviation_logN (individual-level deviation)</code></pre>
<p>Step 6: Basis Set and Fisherâs C</p>
<div class="sourceCode" id="cb294"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb294-1"><a href="structural-equation-models.html#cb294-1" tabindex="-1"></a><span class="co">#fisherC(cardinale.mixed)</span></span></code></pre></div>
<p>Summary:</p>
<pre><code>â¢   Mixed models let you account for non-independence among groups.
â¢   Use piecewiseSEM with lme() to include random effects.
â¢   Be cautious of group-level confounding â use centering and group-level predictors.
â¢   Use rsquared() and fisherC() for model comparison and goodness-of-fit.</code></pre>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": "https://github.com/sarasouther/DataAnalysis/edit/main/StructuralEquationModels.Rmd",
    "text": "Edit this page"
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": ["_main.epub"],
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
