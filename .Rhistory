best_model <- aic_df$Model[1]
best_aic   <- aic_df$AIC[1]
tibble(Plot_ID = plot_id, Best_Model = best_model, AIC = best_aic)
}
# Pseudocode for building aic_all — adapt as needed
aic_all <- list()
for (plot_id in unique(oak_data_final$Plot_ID)) {
data <- oak_data_final %>%
filter(Plot_ID == plot_id,
!is.na(DRC_2023), !is.na(canopy_spread_2023),
!is.na(height_2023), !is.na(Survived))
if (nrow(data) < 10 || length(unique(data$Survived)) < 2) next
models <- list(
model1  = glm(Survived ~ DRC_2023, data = data, family = "binomial"),
model2  = glm(Survived ~ canopy_spread_2023, data = data, family = "binomial"),
model3  = glm(Survived ~ height_2023, data = data, family = "binomial"),
model4  = glm(Survived ~ DRC_2023 + canopy_spread_2023, data = data, family = "binomial"),
model5  = glm(Survived ~ DRC_2023 + height_2023, data = data, family = "binomial"),
model6  = glm(Survived ~ canopy_spread_2023 + height_2023, data = data, family = "binomial"),
model7  = glm(Survived ~ DRC_2023 + canopy_spread_2023 + height_2023, data = data, family = "binomial"),
model8  = glm(Survived ~ DRC_2023 + I(DRC_2023^2), data = data, family = "binomial"),
model9  = glm(Survived ~ canopy_spread_2023 + I(canopy_spread_2023^2), data = data, family = "binomial"),
model10 = glm(Survived ~ height_2023 + I(height_2023^2), data = data, family = "binomial"),
model11 = glm(Survived ~ DRC_2023 + canopy_spread_2023 + I(DRC_2023^2) + I(canopy_spread_2023^2),
data = data, family = "binomial"),
model12 = glm(Survived ~ DRC_2023 + height_2023 + I(DRC_2023^2) + I(height_2023^2),
data = data, family = "binomial"),
model13 = glm(Survived ~ canopy_spread_2023 + height_2023 + I(canopy_spread_2023^2) + I(height_2023^2),
data = data, family = "binomial"),
model14 = glm(Survived ~ DRC_2023 + canopy_spread_2023 + height_2023 +
I(DRC_2023^2) + I(canopy_spread_2023^2) + I(height_2023^2),
data = data, family = "binomial")
)
# Store AICs in long format
for (i in seq_along(models)) {
aic_all[[length(aic_all) + 1]] <- tibble(
Plot_ID = plot_id,
Model = names(models)[i],
AIC = AIC(models[[i]])
)
}
}
# Combine to single data frame
aic_all <- bind_rows(aic_all)
# Step 1: Count number of plots supporting each model
support_summary <- best_models_by_plot %>%
filter(!is.na(Best_Model)) %>%
count(Best_Model, name = "Support_Count")
# Step 2: Convert model names to Best_Model format in AIC table
aic_all <- aic_all %>%
mutate(Best_Model = paste0("models[[", as.numeric(gsub("model", "", Model)), "]]"))
# Step 3: Summarize AICs per model
aic_summary <- aic_all %>%
group_by(Best_Model) %>%
summarize(
Median_AIC = median(AIC, na.rm = TRUE),
Mean_AIC   = mean(AIC, na.rm = TRUE),
.groups = "drop"
)
# Step 4: Combine everything
summary_table2 <- model_info %>%
left_join(support_summary, by = "Best_Model") %>%
left_join(aic_summary, by = "Best_Model") %>%
mutate(Support_Count = replace_na(Support_Count, 0)) %>%
arrange(desc(Support_Count), Median_AIC) %>%
select(Model_No, Formula, Description, Support_Count, Median_AIC, Mean_AIC)
# - create and export table
# Rename for clarity before merge
summary_fec <- summary_table %>% rename(Support_Fecundity = Support_Count)
summary_surv <- summary_table2 %>% rename(Support_Survival = Support_Count)
write.csv(summary_fec, "SuppTable_ModelSelection_Fecundity.csv", row.names = FALSE)
write.csv(summary_surv, "SuppTable_ModelSelection_Survival.csv", row.names = FALSE)
# Merge tables
merged_summary <- full_join(summary_fec, summary_surv, by = c("Model_No", "Formula", "Description")) %>%
mutate(
Support_Fecundity = replace_na(Support_Fecundity, 0),
Support_Survival = replace_na(Support_Survival, 0)
) %>%
arrange(desc(Support_Fecundity + Support_Survival))  # Optional: sort by total support
# Export to CSV for supplementary materials
write.csv(merged_summary, "SuppTable_ModelSelection_Fecundity_Survival.csv", row.names = FALSE)
# Filter data once
oak_data_final <- filter(oak_data, confidence == "1")
# Get unique Plot_IDs to iterate over
plot_ids <- unique(oak_data_final$Plot_ID)
# Function to fit all models and return best by AIC
fit_models_and_select_best <- function(plot_id, data) {
plot_data <- filter(data, Plot_ID == plot_id) %>%
filter(!is.na(DRC_2023), !is.na(canopy_spread_2023),
!is.na(height_2023), !is.na(fec1))
# Check if sufficient data for modeling
if (nrow(plot_data) < 10 || length(unique(plot_data$fec1)) < 2) {
return(tibble(Plot_ID = plot_id, Best_Model = NA, AIC = NA))
}
# Define models in a named list
models <- list(
model1  = glm(Survived ~ DRC_2023, data = plot_data, family = "binomial"),
model2  = glm(Survived ~ canopy_spread_2023, data = plot_data, family = "binomial"),
model3  = glm(Survived ~ height_2023, data = plot_data, family = "binomial"),
model4  = glm(Survived ~ DRC_2023 + canopy_spread_2023, data = plot_data, family = "binomial"),
model5  = glm(Survived ~ DRC_2023 + height_2023, data = plot_data, family = "binomial"),
model6  = glm(Survived ~ canopy_spread_2023 + height_2023, data = plot_data, family = "binomial"),
model7  = glm(Survived ~ DRC_2023 + canopy_spread_2023 + height_2023, data = plot_data, family = "binomial"),
model8  = glm(Survived ~ DRC_2023 + I(DRC_2023^2), data = plot_data, family = "binomial"),
model9  = glm(Survived ~ canopy_spread_2023 + I(canopy_spread_2023^2), data = plot_data, family = "binomial"),
model10 = glm(Survived ~ height_2023 + I(height_2023^2), data = plot_data, family = "binomial"),
model11 = glm(Survived ~ DRC_2023 + canopy_spread_2023 + I(DRC_2023^2) + I(canopy_spread_2023^2),
data = plot_data, family = "binomial"),
model12 = glm(Survived ~ DRC_2023 + height_2023 + I(DRC_2023^2) + I(height_2023^2),
data = plot_data, family = "binomial"),
model13 = glm(Survived ~ canopy_spread_2023 + height_2023 + I(canopy_spread_2023^2) + I(height_2023^2),
data = plot_data, family = "binomial"),
model14 = glm(Survived ~ DRC_2023 + canopy_spread_2023 + height_2023 +
I(DRC_2023^2) + I(canopy_spread_2023^2) + I(height_2023^2),
data = plot_data, family = "binomial")
)
# Calculate AIC for each model
aic_df <- AIC(models[[1]], models[[2]], models[[3]], models[[4]], models[[5]], models[[6]],
models[[7]], models[[8]], models[[9]], models[[10]], models[[11]],
models[[12]], models[[13]], models[[14]]) %>%
as.data.frame() %>%
rownames_to_column("Model") %>%
arrange(AIC)
best_model <- aic_df$Model[1]
best_aic   <- aic_df$AIC[1]
tibble(Plot_ID = plot_id, Best_Model = best_model, AIC = best_aic)
}
# Run for all plots
best_models_by_plot <- map_dfr(plot_ids, fit_models_and_select_best, data = oak_data_final)
# View results
print(best_models_by_plot)
# Count frequency of each Best_Model, excluding NAs
model_support <- best_models_by_plot %>%
filter(!is.na(Best_Model)) %>%
count(Best_Model, sort = TRUE)
# View most frequently best-supported models
print(model_support)
# 1. Define model descriptions and formulas
model_info <- tibble::tibble(
Model_No = 1:14,
Best_Model = paste0("models[[", Model_No, "]]"),
Formula = c(
"Survived ~ DRC_2023",
"Survived ~ canopy_spread_2023",
"Survived ~ height_2023",
"Survived ~ DRC_2023 + canopy_spread_2023",
"Survived ~ DRC_2023 + height_2023",
"Survived ~ canopy_spread_2023 + height_2023",
"Survived ~ DRC_2023 + canopy_spread_2023 + height_2023",
"Survived ~ DRC_2023 + DRC_2023^2",
"Survived ~ canopy_spread_2023 + canopy_spread_2023^2",
"Survived ~ height_2023 + height_2023^2",
"Survived ~ DRC_2023 + canopy_spread_2023 + DRC^2 + canopy^2",
"Survived ~ DRC_2023 + height_2023 + DRC^2 + height^2",
"Survived ~ canopy_spread_2023 + height_2023 + canopy^2 + height^2",
"Survived ~ DRC_2023 + canopy_spread_2023 + height_2023 + DRC^2 + canopy^2 + height^2"
),
Description = c(
"DRC only", "Canopy only", "Height only", "DRC + Canopy",
"DRC + Height", "Canopy + Height", "DRC + Canopy + Height",
"DRC + DRC²", "Canopy + Canopy²", "Height + Height²",
"DRC + Canopy + DRC² + Canopy²", "DRC + Height + DRC² + Height²",
"Canopy + Height + Canopy² + Height²",
"DRC + Canopy + Height + DRC² + Canopy² + Height²"
)
)
# Pseudocode for building aic_all — adapt as needed
aic_all <- list()
for (plot_id in unique(oak_data_final$Plot_ID)) {
data <- oak_data_final %>%
filter(Plot_ID == plot_id,
!is.na(DRC_2023), !is.na(canopy_spread_2023),
!is.na(height_2023), !is.na(Survived))
if (nrow(data) < 10 || length(unique(data$Survived)) < 2) next
models <- list(
model1  = glm(Survived ~ DRC_2023, data = data, family = "binomial"),
model2  = glm(Survived ~ canopy_spread_2023, data = data, family = "binomial"),
model3  = glm(Survived ~ height_2023, data = data, family = "binomial"),
model4  = glm(Survived ~ DRC_2023 + canopy_spread_2023, data = data, family = "binomial"),
model5  = glm(Survived ~ DRC_2023 + height_2023, data = data, family = "binomial"),
model6  = glm(Survived ~ canopy_spread_2023 + height_2023, data = data, family = "binomial"),
model7  = glm(Survived ~ DRC_2023 + canopy_spread_2023 + height_2023, data = data, family = "binomial"),
model8  = glm(Survived ~ DRC_2023 + I(DRC_2023^2), data = data, family = "binomial"),
model9  = glm(Survived ~ canopy_spread_2023 + I(canopy_spread_2023^2), data = data, family = "binomial"),
model10 = glm(Survived ~ height_2023 + I(height_2023^2), data = data, family = "binomial"),
model11 = glm(Survived ~ DRC_2023 + canopy_spread_2023 + I(DRC_2023^2) + I(canopy_spread_2023^2),
data = data, family = "binomial"),
model12 = glm(Survived ~ DRC_2023 + height_2023 + I(DRC_2023^2) + I(height_2023^2),
data = data, family = "binomial"),
model13 = glm(Survived ~ canopy_spread_2023 + height_2023 + I(canopy_spread_2023^2) + I(height_2023^2),
data = data, family = "binomial"),
model14 = glm(Survived ~ DRC_2023 + canopy_spread_2023 + height_2023 +
I(DRC_2023^2) + I(canopy_spread_2023^2) + I(height_2023^2),
data = data, family = "binomial")
)
# Store AICs in long format
for (i in seq_along(models)) {
aic_all[[length(aic_all) + 1]] <- tibble(
Plot_ID = plot_id,
Model = names(models)[i],
AIC = AIC(models[[i]])
)
}
}
# Combine to single data frame
aic_all <- bind_rows(aic_all)
# Step 1: Count number of plots supporting each model
support_summary <- best_models_by_plot %>%
filter(!is.na(Best_Model)) %>%
count(Best_Model, name = "Support_Count")
# Step 2: Convert model names to Best_Model format in AIC table
aic_all <- aic_all %>%
mutate(Best_Model = paste0("models[[", as.numeric(gsub("model", "", Model)), "]]"))
# Step 3: Summarize AICs per model
aic_summary <- aic_all %>%
group_by(Best_Model) %>%
summarize(
Median_AIC = median(AIC, na.rm = TRUE),
Mean_AIC   = mean(AIC, na.rm = TRUE),
.groups = "drop"
)
# Step 4: Combine everything
summary_table <- model_info %>%
left_join(support_summary, by = "Best_Model") %>%
left_join(aic_summary, by = "Best_Model") %>%
mutate(Support_Count = replace_na(Support_Count, 0)) %>%
arrange(desc(Support_Count), Median_AIC) %>%
select(Model_No, Formula, Description, Support_Count, Median_AIC, Mean_AIC)
write.csv(summary_table, "SuppTable_ModelSelection_Survival.csv", row.names = FALSE)
# Filter data once
oak_data_final <- filter(oak_data, confidence == "1")
# Get unique Plot_IDs to iterate over
plot_ids <- unique(oak_data_final$Plot_ID)
# Function to fit all models and return best by AIC
fit_models_and_select_best <- function(plot_id, data) {
plot_data <- filter(data, Plot_ID == plot_id) %>%
filter(!is.na(DRC_2023), !is.na(canopy_spread_2023),
!is.na(height_2023), !is.na(fec1))
# Check if sufficient data for modeling
if (nrow(plot_data) < 10 || length(unique(plot_data$fec1)) < 2) {
return(tibble(Plot_ID = plot_id, Best_Model = NA, AIC = NA))
}
# Define models in a named list
models <- list(
model1  = glm(fec1 ~ DRC_2023, data = plot_data, family = "binomial"),
model2  = glm(fec1 ~ canopy_spread_2023, data = plot_data, family = "binomial"),
model3  = glm(fec1 ~ height_2023, data = plot_data, family = "binomial"),
model4  = glm(fec1 ~ DRC_2023 + canopy_spread_2023, data = plot_data, family = "binomial"),
model5  = glm(fec1 ~ DRC_2023 + height_2023, data = plot_data, family = "binomial"),
model6  = glm(fec1 ~ canopy_spread_2023 + height_2023, data = plot_data, family = "binomial"),
model7  = glm(fec1 ~ DRC_2023 + canopy_spread_2023 + height_2023, data = plot_data, family = "binomial"),
model8  = glm(fec1 ~ DRC_2023 + I(DRC_2023^2), data = plot_data, family = "binomial"),
model9  = glm(fec1 ~ canopy_spread_2023 + I(canopy_spread_2023^2), data = plot_data, family = "binomial"),
model10 = glm(fec1 ~ height_2023 + I(height_2023^2), data = plot_data, family = "binomial"),
model11 = glm(fec1 ~ DRC_2023 + canopy_spread_2023 + I(DRC_2023^2) + I(canopy_spread_2023^2),
data = plot_data, family = "binomial"),
model12 = glm(fec1 ~ DRC_2023 + height_2023 + I(DRC_2023^2) + I(height_2023^2),
data = plot_data, family = "binomial"),
model13 = glm(fec1 ~ canopy_spread_2023 + height_2023 + I(canopy_spread_2023^2) + I(height_2023^2),
data = plot_data, family = "binomial"),
model14 = glm(fec1 ~ DRC_2023 + canopy_spread_2023 + height_2023 +
I(DRC_2023^2) + I(canopy_spread_2023^2) + I(height_2023^2),
data = plot_data, family = "binomial")
)
# Calculate AIC for each model
aic_df <- AIC(models[[1]], models[[2]], models[[3]], models[[4]], models[[5]], models[[6]],
models[[7]], models[[8]], models[[9]], models[[10]], models[[11]],
models[[12]], models[[13]], models[[14]]) %>%
as.data.frame() %>%
rownames_to_column("Model") %>%
arrange(AIC)
best_model <- aic_df$Model[1]
best_aic   <- aic_df$AIC[1]
tibble(Plot_ID = plot_id, Best_Model = best_model, AIC = best_aic)
}
# Run for all plots
best_models_by_plot <- map_dfr(plot_ids, fit_models_and_select_best, data = oak_data_final)
# View results
print(best_models_by_plot)
# Count frequency of each Best_Model, excluding NAs
model_support <- best_models_by_plot %>%
filter(!is.na(Best_Model)) %>%
count(Best_Model, sort = TRUE)
# View most frequently best-supported models
print(model_support)
# 1. Define model descriptions and formulas
model_info <- tibble::tibble(
Model_No = 1:14,
Best_Model = paste0("models[[", Model_No, "]]"),
Formula = c(
"fec1 ~ DRC_2023",
"fec1 ~ canopy_spread_2023",
"fec1 ~ height_2023",
"fec1 ~ DRC_2023 + canopy_spread_2023",
"fec1 ~ DRC_2023 + height_2023",
"fec1 ~ canopy_spread_2023 + height_2023",
"fec1 ~ DRC_2023 + canopy_spread_2023 + height_2023",
"fec1 ~ DRC_2023 + DRC_2023^2",
"fec1 ~ canopy_spread_2023 + canopy_spread_2023^2",
"fec1 ~ height_2023 + height_2023^2",
"fec1 ~ DRC_2023 + canopy_spread_2023 + DRC^2 + canopy^2",
"fec1 ~ DRC_2023 + height_2023 + DRC^2 + height^2",
"fec1 ~ canopy_spread_2023 + height_2023 + canopy^2 + height^2",
"fec1 ~ DRC_2023 + canopy_spread_2023 + height_2023 + DRC^2 + canopy^2 + height^2"
),
Description = c(
"DRC only", "Canopy only", "Height only", "DRC + Canopy",
"DRC + Height", "Canopy + Height", "DRC + Canopy + Height",
"DRC + DRC²", "Canopy + Canopy²", "Height + Height²",
"DRC + Canopy + DRC² + Canopy²", "DRC + Height + DRC² + Height²",
"Canopy + Height + Canopy² + Height²",
"DRC + Canopy + Height + DRC² + Canopy² + Height²"
)
)
# Pseudocode for building aic_all — adapt as needed
aic_all <- list()
for (plot_id in unique(oak_data_final$Plot_ID)) {
data <- oak_data_final %>%
filter(Plot_ID == plot_id,
!is.na(DRC_2023), !is.na(canopy_spread_2023),
!is.na(height_2023), !is.na(fec1))
if (nrow(data) < 10 || length(unique(data$fec1)) < 2) next
models <- list(
model1  = glm(fec1 ~ DRC_2023, data = data, family = "binomial"),
model2  = glm(fec1 ~ canopy_spread_2023, data = data, family = "binomial"),
model3  = glm(fec1 ~ height_2023, data = data, family = "binomial"),
model4  = glm(fec1 ~ DRC_2023 + canopy_spread_2023, data = data, family = "binomial"),
model5  = glm(fec1 ~ DRC_2023 + height_2023, data = data, family = "binomial"),
model6  = glm(fec1 ~ canopy_spread_2023 + height_2023, data = data, family = "binomial"),
model7  = glm(fec1 ~ DRC_2023 + canopy_spread_2023 + height_2023, data = data, family = "binomial"),
model8  = glm(fec1 ~ DRC_2023 + I(DRC_2023^2), data = data, family = "binomial"),
model9  = glm(fec1 ~ canopy_spread_2023 + I(canopy_spread_2023^2), data = data, family = "binomial"),
model10 = glm(fec1 ~ height_2023 + I(height_2023^2), data = data, family = "binomial"),
model11 = glm(fec1 ~ DRC_2023 + canopy_spread_2023 + I(DRC_2023^2) + I(canopy_spread_2023^2),
data = data, family = "binomial"),
model12 = glm(fec1 ~ DRC_2023 + height_2023 + I(DRC_2023^2) + I(height_2023^2),
data = data, family = "binomial"),
model13 = glm(fec1 ~ canopy_spread_2023 + height_2023 + I(canopy_spread_2023^2) + I(height_2023^2),
data = data, family = "binomial"),
model14 = glm(fec1 ~ DRC_2023 + canopy_spread_2023 + height_2023 +
I(DRC_2023^2) + I(canopy_spread_2023^2) + I(height_2023^2),
data = data, family = "binomial")
)
# Store AICs in long format
for (i in seq_along(models)) {
aic_all[[length(aic_all) + 1]] <- tibble(
Plot_ID = plot_id,
Model = names(models)[i],
AIC = AIC(models[[i]])
)
}
}
# Combine to single data frame
aic_all <- bind_rows(aic_all)
# Step 1: Count number of plots supporting each model
support_summary <- best_models_by_plot %>%
filter(!is.na(Best_Model)) %>%
count(Best_Model, name = "Support_Count")
# Step 2: Convert model names to Best_Model format in AIC table
aic_all <- aic_all %>%
mutate(Best_Model = paste0("models[[", as.numeric(gsub("model", "", Model)), "]]"))
# Step 3: Summarize AICs per model
aic_summary <- aic_all %>%
group_by(Best_Model) %>%
summarize(
Median_AIC = median(AIC, na.rm = TRUE),
Mean_AIC   = mean(AIC, na.rm = TRUE),
.groups = "drop"
)
# Step 4: Combine everything
summary_table <- model_info %>%
left_join(support_summary, by = "Best_Model") %>%
left_join(aic_summary, by = "Best_Model") %>%
mutate(Support_Count = replace_na(Support_Count, 0)) %>%
arrange(desc(Support_Count), Median_AIC) %>%
select(Model_No, Formula, Description, Support_Count, Median_AIC, Mean_AIC)
write.csv(summary_table, "SuppTable_ModelSelection_Fecundity.csv", row.names = FALSE)
# Count frequency of each Best_Model, excluding NAs
model_support <- best_models_by_plot %>%
filter(!is.na(Best_Model)) %>%
count(Best_Model, sort = TRUE)
# View most frequently best-supported models
print(model_support)
# Filter complete data
oak_data_complete <- oak_data %>%
filter(confidence == "1", !is.na(height_2023), !is.na(fec1), !is.na(Survived))
# Fit models
model_fec1 <- glm(fec1 ~ height_2023, data = oak_data_complete, family = "binomial")
model_surv <- glm(Survived ~ height_2023, data = oak_data_complete, family = "binomial")
library(ggplot2)
# Create predictions for both models
prediction_data <- oak_data_complete %>%
select(height_2023) %>%
distinct() %>%
arrange(height_2023) %>%
mutate(
pred_fec1 = predict(model_fec1, newdata = ., type = "response"),
pred_surv = predict(model_surv, newdata = ., type = "response")
)
# Plot for fec1
ggplot(oak_data_complete, aes(x = height_2023, y = fec1)) +
geom_jitter(width = 0.2, height = 0.05, alpha = 0.4) +
geom_line(data = prediction_data, aes(x = height_2023, y = pred_fec1), color = "#FB7E21FF", linewidth = 1.2) +
labs(title = "Reproduction Probability vs DRC", y = "Probability of fec1 = 1", x = "DRC (cm)") +
theme_minimal()
# Plot for Survived
ggplot(oak_data_complete, aes(x = height_2023, y = Survived)) +
geom_jitter(width = 0.2, height = 0.05, alpha = 0.4) +
geom_line(data = prediction_data, aes(x = height_2023, y = pred_surv), color = "#18DDC2FF", linewidth = 1.2) +
labs(title = "Survival Probability vs DRC", y = "Probability of Survived = 1", x = "DRC (cm)") +
theme_minimal()
# Summary
summary(model_fec1)
summary(model_surv)
# Filter complete data
oak_data_complete <- oak_data %>%
filter(confidence == "1", !is.na(height_2023), !is.na(fec1), !is.na(Survived))
# Fit models
model_fec1 <- glm(fec1 ~ height_2023, data = oak_data_complete, family = "binomial")
model_surv <- glm(Survived ~ height_2023, data = oak_data_complete, family = "binomial")
library(ggplot2)
# Create predictions for both models
prediction_data <- oak_data_complete %>%
select(height_2023) %>%
distinct() %>%
arrange(height_2023) %>%
mutate(
pred_fec1 = predict(model_fec1, newdata = ., type = "response"),
pred_surv = predict(model_surv, newdata = ., type = "response")
)
# Updated plot for fec1
plot_fec1 <- ggplot(oak_data_complete, aes(x = height_2023, y = fec1)) +
geom_jitter(width = 0.2, height = 0.05, alpha = 0.4) +
geom_line(data = prediction_data, aes(x = height_2023, y = pred_fec1), color = "#FB7E21FF", linewidth = 1.2) +
labs(title = "Reproduction Probability vs Height", y = "Pr(fec1 = 1)", x = "Height (cm)") +
theme_minimal()
# Updated plot for Survived
plot_surv <- ggplot(oak_data_complete, aes(x = height_2023, y = Survived)) +
geom_jitter(width = 0.2, height = 0.05, alpha = 0.4) +
geom_line(data = prediction_data, aes(x = height_2023, y = pred_surv), color = "#18DDC2FF", linewidth = 1.2) +
labs(title = "Survival Probability vs Height", y = "Pr(Survived = 1)", x = "Height (cm)") +
theme_minimal()
# PDF
ggsave("Reproduction_vs_Height.pdf", plot_fec1, width = 6, height = 4)
ggsave("Survival_vs_Height.pdf", plot_surv, width = 6, height = 4)
# PNG (for presentations or web)
ggsave("Reproduction_vs_Height.png", plot_fec1, width = 6, height = 4, dpi = 300)
ggsave("Survival_vs_Height.png", plot_surv, width = 6, height = 4, dpi = 300)
# Save summaries to text file
sink("Model_Summaries_Height.txt")
cat("Reproduction model (fec1 ~ height_2023)\n\n")
print(summary(model_fec1))
cat("\n\n--------------------------------------------\n\n")
cat("Survival model (Survived ~ height_2023)\n\n")
print(summary(model_surv))
sink()
# Summary
summary(model_fec1)
summary(model_surv)
# PNG (for presentations or web)
ggsave("Reproduction_vs_Height.png", plot_fec1, width = 6, height = 4, dpi = 300, bg = "white")
ggsave("Survival_vs_Height.png", plot_surv, width = 6, height = 4, dpi = 300, bg = "white")
library(tidyverse)
data <- tribble(~Population, ~SLA,
"Flagstaff", 2, "Flagstaff", 1, "Flagstaff", 2,
"Sedona", 5, "Sedona", 6, "Sedona", 7,
"CampV", 10, "CampV", 11, "CampV", 10)
pop <- group_by(data, Population)
SLAtable <- summarise(pop, meanSLA = mean(SLA)); SLAtable
#ANOVA
model1 <- aov(SLA ~ Population, data=data)
summary(model1)
#ANOVA run as a linear model
model2 <- lm(SLA ~ Population, data=data)
summary(model2)
#in this simple model,
#notice that the Intercept is the mean SLA of the
#reference group
#then population Flagstaff Coefficient
#is 10.333 - 8.667 = 1.67 (mean of the Flagstaff pop)
#Sedona population =  10.3333 - 4.3333
#6 = mean SLA of the Sedona population
data(iris)
#Is petal width related to petal length?
#model <- glm(y-value ~ x-values, family = specifylinkingfunctions, data = dataset)
iris_model <- glm(Petal.Length ~ Petal.Width, family = gaussian(), data = iris) #y data is continuous, use gaussian
summary(iris_model)
#for comparison run a linear regression for comparison
iris_modelR <- lm(Petal.Length ~ Petal.Width, data = iris) #y data is continuous, use gaussian
summary(iris_modelR)
library(car)
#glm
#iris_model <- glm(Petal.Length ~ Petal.Width, family = gaussian(), data = iris) #y data is continuous, use gaussian
Anova(iris_model)
#for comparison run a linear regression for comparison
#iris_modelR <- lm(Petal.Length ~ Petal.Width, data = iris) #y data is continuous, use gaussian
Anova(iris_modelR)
#Look at residuals
res_irismodel <- rstandard(iris_model)
plot(iris_model$fitted.values, res_irismodel, pch=20, ylab = "Standarized residuals", xlab = "fitted values")
iris_model <- glm(Petal.Length ~ Petal.Width, family = Gamma (), data = iris) #y data is continuous, use gaussian
summary(iris_model)
res_irismodel <- rstandard(iris_model)
plot(iris_model$fitted.values, res_irismodel, pch=20, ylab = "Standarized residuals", xlab = "fitted values")
iris_model <- glm(Petal.Length ~ Petal.Width, family = gaussian (link="log"), data = iris) #y data is continuous, use gaussian
summary(iris_model)
res_irismodel <- rstandard(iris_model)
plot(iris_model$fitted.values, res_irismodel, pch=20, ylab = "Standarized residuals", xlab = "fitted values")
iris_model <- glm(Petal.Length ~ Petal.Width, family = gaussian (link=power(0.25)), data = iris) #y data is continuous, use gaussian
summary(iris_model)
res_irismodel <- rstandard(iris_model)
plot(iris_model$fitted.values, res_irismodel, pch=20, ylab = "Standarized residuals", xlab = "fitted values")
