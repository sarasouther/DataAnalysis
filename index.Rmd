---
title: "Applied Statistics for the Natural Sciences"
author: "Sara Souther"
site: bookdown::bookdown_site
output_dir: "docs"
github-repo: sarasouther/DataAnalysis

output:
  bookdown::gitbook:
    css: style.css
    config:
      toc:
        before: |
          <li><a href="./">Applied Statistics for the Natural Sciences</a></li>
        after: |
          <li><a href="https://github.com/sarasouther/DataAnalysis" target="blank">Published with bookdown</a></li>
      edit:
        link: https://github.com/sarasouther/DataAnalysis/edit/main/%s
        text: "Edit this page"
      download: ["epub"]

  bookdown::epub_book:
    toc: true
---

```{r setup-global, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)
options(na.action = "na.exclude")

library(magrittr)
`%>%` <- magrittr::`%>%`

library(tidyverse)
library(conflicted)

conflict_prefer("select", "dplyr")
conflict_prefer("filter", "dplyr")
conflict_prefer("rename", "dplyr")
conflict_prefer("lag", "dplyr")

conflict_prefer("mosaic", "vcd")
conflict_prefer("auc", "pROC")

# prevent GAM formula conflict if brms is loaded
conflict_prefer("s", "mgcv")

if (requireNamespace("lmerTest", quietly = TRUE)) {
  conflict_prefer("lmer", "lmerTest")
}
if (requireNamespace("effectsize", quietly = TRUE)) {
  conflict_prefer("oddsratio", "effectsize")
}
if (requireNamespace("car", quietly = TRUE)) {
  conflict_prefer("vif", "car")
}

conflict_prefer("qqnorm", "stats")
conflict_prefer("qqline", "stats")

# FIX: your last line was wrong
conflict_prefer("order", "base")
```

# Introduction 

**Welcome to our statistical exploration of the natural world!**

My goal is for you to develop an intuitive understanding of statistical analysis—how to choose the right test, understand its assumptions, visualize and interpret results, and communicate findings clearly in a report. By the end of this course, I hope you’ll feel confident tackling any analytical situation you encounter.

Let’s get one thing out of the way early: we are not statisticians—whew! We are ecologists and social scientists. Our goal is not to master the theoretical mathematics behind statistics, but rather to apply statistical tools appropriately and thoughtfully. For this reason, we won’t spend much time on the underlying equations or proofs, but instead focus on practical application, critical interpretation, and making our data tell a clear story. For this reason, I will not spend much space describing the mathematical understanding of statistics! 

## Learning Objectives

By the end of this course, you will be able to:

- Select appropriate statistical tests based on the type of data (categorical, continuous, ordinal), the structure of your study design, and the research question being asked (e.g., comparing groups, testing relationships, evaluating change over time).
- Properly run statistical analyses using R, including data cleaning, assumption checking, and the implementation of common tests such as t-tests, ANOVA, chi-squared tests, correlation, linear regression, and basic non-parametric alternatives.
- Report and interpret statistical results in clear, publication-ready language. This includes summarizing findings with appropriate measures of central tendency and variation (mean, median, standard error), reporting test statistics and p-values, and interpreting both statistical and biological/social significance.
- Visualize data effectively using plots and figures that aid interpretation and communicate key findings to scientific and non-scientific audiences.
- Understand the assumptions behind common statistical methods and recognize when those assumptions are violated, along with strategies for addressing or adjusting for these issues.
- Develop confidence and critical thinking in applying statistical tools to real-world ecological and social science data, with a focus on transparency, reproducibility, and responsible data use.

## Using R in This Course

In this course, we use R as a practical tool for ecological and social science data analysis. The focus is not on mathematical theory, but on learning how to choose appropriate statistical tests, check assumptions, visualize data, and interpret results clearly and responsibly. By working with real datasets in R, you will build confidence in reproducible, transparent analysis and develop the skills needed to tackle the kinds of statistical questions you will encounter in research and professional practice.

To get started, we will go over a few R-best practices for organizing and running code in our first class lecture!

### What you need to use R

You need two programs:

- R (does the calculations)
- RStudio (helps you write and organize code)

Think of R as the engine, and RStudio as the dashboard.

Install R:

- Go to: https://www.r-project.org
- Click Download R from CRAN
- Choose any mirror (it truly does not matter)
- Download the version for your operating system (Mac, Windows, or Linux)
- Install using the default options

Install RStudio:

- Go to: https://posit.co/download/rstudio-desktop/
- Download RStudio Desktop (Free)
- Install using the default options
- RStudio will automatically find R once both are installed

When you open RStudio, you’ll see four panes:

- Console is where R runs code
- Source is where you write and save code
- Environment shows what data you have loaded
- Plots/Files/Help is where figures and help appear

You can move the order in which these panes appear.

### Create an R file

**What is an R file?** An R file is a script or a plain text file that contains R code.
R files allow you to write, save, and rerun analyses step by step, which is essential for reproducible science.

Instead of typing commands one-by-one into the Console (where they disappear), an R file lets you:

- Keep a permanent record of your work
- Add comments explaining what you’re doing
- Edit and rerun code easily
- Share your analysis with others

Think of an R file as your lab notebook, written in code.

How to open (create) an R file in RStudio:

1.	Open RStudio
2.	Go to File → New File
3.	Choose R Script

A new tab will open with a blank file. This is a standard R script, usually saved with the extension .R. 

Save it right away:

- File → Save As
- Give it a clear, descriptive name (e.g., data_exploration.R)

**Hint**: Create a folder for this course (you could organize by subfolders for each chapter) and store all of your data and R files in this folder.

### Using working directories and opening files

RStudio allows you to open files and perform other actions using drop down menus. However, it is far more efficient to set working directories and import files using script within your R file. When you are asked to revisit work for a big project, using working directories allows you to jump right back into the project, because the pertinent data files are linked (this is super great when you have to do revisions, for instance). 

Datasets are created in **Excel** and saved as **.csv files** that are readable by R.

### R Packages

R comes with built-in functions, but most ecological work uses packages—collections of tools made by other scientists. Using libraries takes two steps. The first time you use a new package, you will install that package, and then load the package. You will need to load packages every time that you use R.

### Other information about R code

Anything after a # is ignored by R. It is good practice to use hashtags to add information to your code.

Use comments to explain:

- what the code does
- why you wrote it
- anything future-you will forget

You will encounter issues with your R code. When you do this, your best friends are AI language models, like ChatGPT and Claude. Explain the error, providing the error code, and your code, and the AI assistant will help you. I cannot overstate how jealous I am of all young scientists - debugging used to take hours as you combed over the R documentation looking for hints as to why your code is breaking. 

### Getting started with R

Some of you may be R experts, but for those who are new or need a refresher, check out this R code and import the associated csv file.
[Formatted R script](https://drive.google.com/uc?export=download&id=1gyvW90wo6O77TZFYDcivpAwEzK0Lzvzd)
[csv file to import](https://drive.google.com/uc?export=download&id=1jxVjCc3FV7ny-J7gEZ7w3uY9EY1-AW91)
If you need a refresher on working directories and libraries, follow [this link](https://youtu.be/sHvm2Hv9JPk)

## How to use this online manual

Within this manual, we have created chapters for key topics in the application of statistics to the natural world. Chapters contain broad explanations, R code, ecological examples, and assignments, and they are designed to be worked through with RStudio open beside your browser. So within each chapter: Copy the code. Run it. Change the numbers. Break it. Fix it. The learning is in the doing, not the reading.

### How this manual fits into the course

**This manual** contains the core concepts, R code, ecological examples, and detailed explanations. It is the reference you return to throughout the semester and beyond. Every chapter builds on previous chapters, so if something in a later chapter feels unfamiliar, look back---the foundation is here.

**Recorded lectures** provide the narrative arc and motivation for each chapter. They hit the key ideas, walk through the reasoning, and connect concepts to the bigger picture. Watch the lecture first, then work through the corresponding chapter at your own pace.

**Canvas** is where you submit assignments, take quizzes, check grades, and find course announcements. Assignment prompts appear at the end of each chapter in this book, but you will submit your work through Canvas.

**GitHub** hosts the source code for this entire book. Every `.Rmd` file that produces these chapters is visible in the repository. You are welcome to explore it, clone it, or use it as a reference for your own projects. If you spot a typo or error, you can even submit a pull request---that is how open-source resources improve over time.

### Tips for getting the most out of this book

**Run every code chunk yourself.** Do not just read the output printed in the book. The act of running code, seeing it work (or fail), and tweaking it is where the learning happens.

**Experiment freely.** Change the sample size. Swap the probability. Add noise. See what breaks. You cannot damage anything by running code in your own R session, and every "mistake" teaches you something about how R and statistics work.

**Read with RStudio open.** The book and RStudio should be side by side. If you are reading on a laptop, split the screen. If you have a second monitor, even better.

**Use the search function.** This book is a website, and your browser's search (Ctrl+F or Cmd+F) works on every page. If you need to find where we introduced a concept, search for it.

**Come back to earlier chapters.** Statistical concepts build on each other. If something in Chapter 8 feels unclear, the answer is often in Chapter 3 or 4. The chapters are designed to be revisited, not just read once.

**Use the reference tables.** Several chapters include reference tables (such as the data type → distribution → model table in Chapter 4). You do not need to memorize these. Bookmark them and return to them as needed.

### A note on R code in this book

All code in this book is written in R and is designed to run in a standard R or RStudio environment. We primarily use base R to keep dependencies minimal, with occasional use of common packages like `ggplot2` or `knitr` when they add clarity.

If a code chunk requires a package you have not installed, R will tell you. You can install any missing package with:

```{r install-example, eval=FALSE}
install.packages("package_name")
```

If you encounter an error you cannot resolve, copy the error message and search for it---chances are good that someone else has had the same problem and the answer is on Stack Overflow or the RStudio Community forums. Learning to troubleshoot R errors is itself a valuable skill.


## Course structure

This course has been designed to be 'flipped'. Watch the lecture before you come to class. Then, treat class like a workshop to work through quizzes, assignments, and most importantly *your* work for your thesis. Whether you are developing the methods for your proposal or conducting your final analysis, this course is meant to support you as you actually perform statistics. 

